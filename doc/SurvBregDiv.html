<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>SurvBregDiv: Transfer Learning for Time-to-Event Modelling via Bregman Divergence</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">SurvBregDiv: Transfer Learning for
Time-to-Event Modelling via Bregman Divergence</h1>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>Accurate prognostic modeling is a central goal in survival analysis.
The rapid expansion of large-scale biobank initiatives—with rich
genetic, molecular, imaging, and electronic health record data—has
created new opportunities to improve predictive performance in clinical
and epidemiologic research. However, these datasets often exhibit
limited effective sample sizes, high dimensionality, low signal-to-noise
ratios, and additional practical constraints including privacy
considerations and restricted data access.</p>
<p>Integrating external information offers a principled strategy for
improving model efficiency. Yet, classical data-integration methods
typically rely on the assumption that multiple datasets arise from a
common data-generating mechanism. In modern biomedical applications,
this assumption is rarely satisfied. Misspecification due to population
heterogeneity can induce substantial bias, motivating the development of
transfer-learning approaches that explicitly accommodate between-source
discrepancies.</p>
<p>While Bregman divergence has been successfully applied to borrowing
information in binary-outcome settings, extending such ideas to censored
time-to-event outcomes is nontrivial due to right censoring and the
limited nature of available external survival information (e.g.,
predicted risk scores, fitted regression coefficients, or hazard ratios
without access to a baseline hazard).</p>
<p>Beyond full-cohort survival studies, many biomedical investigations
rely on the nested case–control (NCC) design to alleviate the burden of
labor-intensive measurements, high-cost data acquisition, and
destructive or finite biospecimen assays. Under an NCC design, only a
small number of matched controls are sampled at each failure time,
producing survival data that are analyzed through conditional logistic
regression applied to matched risk sets. Despite its practical
relevance, no existing methodology or software supports transfer
learning or external information borrowing under NCC designs.</p>
<p>The <code>SurvBregDiv</code> package addresses these challenges by
providing a unified transfer-learning framework for both full-cohort Cox
data and nested case–control designs. The methods integrate external
information in a privacy-preserving manner and are applicable to both
low-dimensional settings and high-dimensional variable selection with
ridge, lasso, and elastic net penalties.</p>
<div id="key-features" class="section level3">
<h3>Key Features</h3>
<ul>
<li><p><strong>Transfer learning via KL/Bregman shrinkage</strong><br />
Integrates external information through Bregman divergence–based
penalization, enabling adaptive borrowing from heterogeneous data
sources.</p></li>
<li><p><strong>Privacy-preserving external information
use</strong><br />
Operates on summary-level external inputs—such as fitted coefficients or
risk scores—without requiring individual-level external data
access.</p></li>
<li><p><strong>Heterogeneity-aware borrowing</strong><br />
Accommodates population differences through tuning-parameter–controlled
shrinkage, selectively borrowing strength only when sources are
compatible.</p></li>
<li><p><strong>High-dimensional modeling with
regularization</strong><br />
Supports penalized KL-integrated models, including ridge, lasso, and
elastic net penalties for variable selection and shrinkage.</p></li>
<li><p><strong>Flexible external information formats</strong><br />
Allows external inputs in the form of coefficients, risk scores, or
partially overlapping covariate sets.</p></li>
<li><p><strong>Built-in cross-validation for tuning</strong><br />
Provides cross-validation criteria tailored for survival outcomes,
including C-index, predicted deviance, and V&amp;VH loss.</p></li>
</ul>
<p>This vignette introduces the core functionalities of
<code>SurvBregDiv</code> and illustrates workflows for both low- and
high-dimensional applications.</p>
</div>
</div>
<div id="installation" class="section level2">
<h2>Installation</h2>
<p>You can install from CRAN:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;SurvBregDiv&quot;</span>)</span></code></pre></div>
<p>Or install the development version of <code>SurvBregDiv</code> from
GitHub:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">require</span>(devtools)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">require</span>(remotes)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;UM-KevinHe/SurvBregDiv&quot;</span>, <span class="at">ref =</span> <span class="st">&quot;main&quot;</span>)</span></code></pre></div>
</div>
<div id="quick-start" class="section level2">
<h2>Quick Start</h2>
<p>This section provides a brief overview of the main functions using
example datasets included in the package.</p>
<p>First, load the package:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">library</span>(SurvBregDiv)</span></code></pre></div>
<div id="full-cohort-cox-model-with-bregman-divergence-integration" class="section level3">
<h3>Full-Cohort Cox Model with Bregman Divergence Integration</h3>
<div id="low-dimensional-integration" class="section level4">
<h4>Low-Dimensional Integration</h4>
<p>The low-dimensional Bregman-divergence–integrated Cox model is
intended for settings where the number of predictors is modest. External
information—either in the form of external Cox coefficients
(<code>beta</code>) or pre-computed external risk scores
(<code>RS</code>)—is incorporated through a Bregman-divergence
penalization mechanism.</p>
<p>The tuning parameter <code>eta</code> controls the strength of
information borrowing:</p>
<ul>
<li><code>eta = 0</code> reduces to the standard Cox model (no external
borrowing), and<br />
</li>
<li>larger values of <code>eta</code> increasingly shrink the fitted
coefficients toward the external information.</li>
</ul>
<p>Two specific divergence choices are supported:</p>
<ul>
<li><strong>Kullback–Leibler (KL) divergence</strong>, implemented via
<code>coxkl()</code>, and<br />
</li>
<li><strong>squared Mahalanobis distance</strong>, implemented via
<code>cox_MDTL()</code>.</li>
</ul>
<p>For both formulations, the optimal <code>eta</code> can be selected
through cross-validation using <code>cv.coxkl()</code> or
<code>cv.cox_MDTL()</code>, respectively.</p>
<div id="low-dimensional-example-dataset" class="section level5">
<h5>Low-dimensional Example Dataset:</h5>
<p>We illustrate the workflow using the built-in low-dimensional
simulated dataset <code>ExampleData_lowdim</code>, which consists of a
training set (100 samples) and a test set (2000 samples) with 6
predictors. We first extract the training components:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">data</span>(ExampleData_lowdim)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>train  <span class="ot">&lt;-</span> ExampleData_lowdim<span class="sc">$</span>train</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>test   <span class="ot">&lt;-</span> ExampleData_lowdim<span class="sc">$</span>test</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>z      <span class="ot">&lt;-</span> train<span class="sc">$</span>z</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>delta  <span class="ot">&lt;-</span> train<span class="sc">$</span>status</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>time   <span class="ot">&lt;-</span> train<span class="sc">$</span>time</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>strat  <span class="ot">&lt;-</span> train<span class="sc">$</span>stratum</span></code></pre></div>
<p>and externally derived coefficients beta_external:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>beta_ext <span class="ot">&lt;-</span> ExampleData_lowdim<span class="sc">$</span>beta_external_fair</span></code></pre></div>
<p>We generate a sequence of tuning parameter <code>eta</code> values
via the internal utility <code>generate_eta()</code> and fit the
integrated model across this grid:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>eta_list <span class="ot">&lt;-</span> <span class="fu">generate_eta</span>(<span class="at">method =</span> <span class="st">&quot;exponential&quot;</span>, <span class="at">n =</span> <span class="dv">50</span>, <span class="at">max_eta =</span> <span class="dv">10</span>)</span></code></pre></div>
</div>
<div id="model-fitting" class="section level5">
<h5>Model Fitting:</h5>
<p>For the KL divergence–based integrated model, we use the function
<code>coxkl()</code>:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>coxkl_est <span class="ot">&lt;-</span> <span class="fu">coxkl</span>(</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>  <span class="at">z =</span> z,</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  <span class="at">delta =</span> delta,</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>  <span class="at">time =</span> time,</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>  <span class="at">stratum =</span> strat,</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>  <span class="at">beta =</span> beta_ext,</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>  <span class="at">etas =</span> eta_list</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>)</span></code></pre></div>
<p>For the squared Mahalanobis distance–based integrated model, we use
<code>cox_MDTL()</code>:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>cox_MDTL_est <span class="ot">&lt;-</span> <span class="fu">cox_MDTL</span>(</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>  <span class="at">z =</span> z,</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>  <span class="at">delta =</span> delta,</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>  <span class="at">time =</span> time,</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>  <span class="at">stratum =</span> strat,</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>  <span class="at">beta =</span> beta_ext,</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>  <span class="at">vcov =</span> <span class="cn">NULL</span>,</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>  <span class="at">etas =</span> eta_list</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>)</span></code></pre></div>
<p>Note that the squared Mahalanobis distance formulation requires a
user-specified weighting matrix via the argument <code>vcov</code>. In
standard Mahalanobis distance settings, is taken to be the inverse
covariance matrix of the coefficients. If <code>vcov = NULL</code>, the
function defaults to the identity matrix.</p>
<p>Users may instead supply an external risk score vector:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>RS_ext <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(z) <span class="sc">%*%</span> <span class="fu">as.matrix</span>(beta_ext)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>coxkl_est.RS <span class="ot">&lt;-</span> <span class="fu">coxkl</span>(</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>  <span class="at">z =</span> z,</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>  <span class="at">delta =</span> delta,</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>  <span class="at">time =</span> time,</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>  <span class="at">stratum =</span> strat,</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>  <span class="at">RS =</span> RS_ext,</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>  <span class="at">etas =</span> eta_list</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>)</span></code></pre></div>
<p>For datasets containing tied event times, users may apply the
<code>coxkl_ties()</code> function, which extends integrated Cox model
to handle ties. The following example illustrates the use of the Breslow
method for tie handling:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>time_ties <span class="ot">&lt;-</span> <span class="fu">round</span>(time, <span class="dv">2</span>)   <span class="co"># Rounding time introduces ties for demonstration</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>coxkl_ties_est <span class="ot">&lt;-</span> <span class="fu">coxkl_ties</span>(</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>  <span class="at">z =</span> z,</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>  <span class="at">delta =</span> delta,</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>  <span class="at">time =</span> time_ties,</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>  <span class="at">stratum =</span> strat,</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>  <span class="at">beta =</span> beta_ext,</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>  <span class="at">etas =</span> eta_list,</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>  <span class="at">ties =</span> <span class="st">&quot;breslow&quot;</span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="hyperparameter-tuning-via-cross-validation" class="section level5">
<h5>Hyperparameter Tuning via Cross-Validation:</h5>
<p>The function <code>cv.coxkl</code> and <code>cv.cox_MDTL</code>
performs K-fold (default 5) cross-validation to choose the integration
parameter. It supports four criteria:</p>
<ul>
<li><code>&quot;V&amp;VH&quot;</code> — V&amp;VH loss<br />
</li>
<li><code>&quot;LinPred&quot;</code> — predicted partial deviance<br />
</li>
<li><code>&quot;CIndex_pooled&quot;</code> — pooled comparable pairs<br />
</li>
<li><code>&quot;CIndex_foldaverage&quot;</code> — per-fold stratified C-index</li>
</ul>
<p>Below is an example using the default <code>&quot;V&amp;VH&quot;</code>
criterion:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>cv.coxkl_est <span class="ot">&lt;-</span> <span class="fu">cv.coxkl</span>(</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>  <span class="at">z =</span> z,</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  <span class="at">delta =</span> delta,</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  <span class="at">time =</span> time,</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>  <span class="at">stratum =</span> strat,</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>  <span class="at">beta =</span> beta_ext,</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>  <span class="at">etas =</span> eta_list,</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>  <span class="at">nfolds =</span> <span class="dv">5</span>,</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>  <span class="at">criteria =</span> <span class="st">&quot;V&amp;VH&quot;</span>,</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">1</span>)</span></code></pre></div>
</div>
<div id="visualization" class="section level5">
<h5>Visualization:</h5>
<p>Objects of model fittings (i.e. from either <code>coxkl</code> or
<code>cox_MDTL</code>) from can be visualized using the S3 plotting
method <code>plot()</code>.<br />
This function displays how model performance changes across the
<code>eta</code>–sequence used during fitting.</p>
<p>Two types of performance criteria are supported:</p>
<ul>
<li><p><code>&quot;loss&quot;</code><br />
(default; −2 × partial log-likelihood, normalized by sample
size)</p></li>
<li><p><code>&quot;CIndex&quot;</code><br />
(stratified concordance index)</p></li>
</ul>
<p>Users may directly call the <code>plot()</code> method to visualize
the model’s fitted performance on the training data without providing
additional test data. If a test set is supplied, performance metrics are
computed using the test set instead:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  cox_MDTL_est,</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  <span class="at">test_z       =</span> test<span class="sc">$</span>z,</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>  <span class="at">test_time    =</span> test<span class="sc">$</span>time,</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>  <span class="at">test_delta   =</span> test<span class="sc">$</span>status,</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>  <span class="at">test_stratum =</span> test<span class="sc">$</span>stratum,</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>  <span class="at">criteria     =</span> <span class="st">&quot;loss&quot;</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>) </span></code></pre></div>
<p><img role="img" aria-label="Plot generated in survkl vignette" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA0gAAAHgCAMAAACo6b1DAAABLFBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrYbnnc6AAA6OgA6Ojo6OmY6ZmY6ZpA6ZrY6kNtNTU1NTW5NTY5Nbm5Nbo5NbqtNjshmAABmOgBmOjpmZjpmZmZmZpBmkJBmkLZmtttmtv9uTU1ubk1ubo5ujqtujshuq+R1cLOOTU2Obk2Obm6Oq6uOq8iOyOSOyP+QOgCQZjqQZmaQZpCQkGaQttuQ2/+rbk2rjm6ryOSr5P+2ZgC2Zjq2kDq2kGa2tra229u22/+2///Ijk3Ijm7Iq27IyKvI5P/I///bkDrbkGbbtmbbtpDbtrbb27bb29vb2//b///kq27kyI7kyKvk5Mjk////tmb/yI7/25D/27b/29v/5Kv/5Mj/5OT//7b//8j//9v//+T////bNbBQAAAACXBIWXMAABJ0AAASdAHeZh94AAAXZElEQVR4nO3dC3sTV3rAccGGYm+2mxwTG9JN26BwsUkC7LbBTsh2S+TWsKTdIlMjEqnYmu//HTpXze1IHol3pPcd/r/n2cWakczx+Pw9F41JLwDw3nqbHgDQBYQECCAkQAAhAQIICRBASIAAQgIEEBIggJAAAYQECCAkQAAhAQIICRBASIAAQgIEEBIggJAAAYQECCAkQAAhAQIICRBASIAAQgIEEBIggJAAAYSkwtvtqz+Vl1z82ydLf5b5r3nTu778oPxEhvruVvWTWEdIKtRn5ypTf/5rWg1phU9OSGgFIVlHSCoQknWEpEIyO5/2br/8ba/3+2fBxeNeKJqfv/xxu9f73bP4WRc/9nofPXvR+zSavJ++3O599CQIfv6H8Jm/+edXc14ThE+78qV4SJcMNRte/rTIbKiEhHZks/PjaFL2rv40m51vt+MlV26HT0oWXvlDEtLfh2uuvQp+7CWuB97XhJ8z8oV8SAuHmg0vf1q4MB8qIeES+43UXpbNzt71V9Eu5HZ2vPTuVu+TcF/z53gmvuhd+S745fNeElJUUfRnuCzc7fSuPPG+Jlz/ZXDxtOcJaWtrq8HHqw01G175aflQCQmLvWdI6ez7NJudL9IAosO58Ef/7fipyeqonPS5Qbqu/pp0fbhaPKRFQy0ML39acaiEhMXeM6R4LsZTMp6dF4+T+Riuv/Yq+l/0cTp5kweRX//rX8Pd1G3fa97dSh68kA9p0VBnwys+rThUQkIrstkZ/8wuzs5e5upPb8o/8tOQokO92G3fa7IJ28LFhkVDLYSUP604VEJCK+bMzvC8Y25I19MXhqf3v/unf88P7Uqvya5Vtx9S6a+d/X3FpxWHSkhoxdzZmR4vRbKf8sWQopOfV0HpHKn0mvXtkUp/rS+k0lAJCa2Yf7x0u/Cc0jlSPFOz6RvuD277XrPoHKnFofpCKg2VkNCKObMz/DCJJ9obpVM1nIj1kN70ipfP8tcsumrX4lAXhRQPlZDQCt/svBbfAdC79ixI34h5EV1Tnr2PVDi0u/hzr5dfgSi9Jr5YHt0R0WpItb927qFdOlRCQivqs/NtcuPCm+R2gV70iwrlOxuSmfomWX3tz3NeE36ylu5sWDhU38WG4lAJCa2oz87gr9vxD/rkBrbv4mcl99oVz5GC4OdwD/WbL9O9guc1wcvftnOv3cKh+kIqDpWQsHFPi2f1UIKQzEjfEypfZ4YShGRGeDYfna0/LdwcBDUIyY6Xydk6OySNCMmQ6BfjrqS/JAddCAkQQEiAAEICBBASIICQAAGEBAggJEAAIQECCAkQQEiAAEICBBASIICQAAGEBAggJEAAIQECCAkQQEiAAEICBBASIICQAAGEBAggJEAAIQECCAkQQEiAAEICBBASIICQAAFKQuopGQewGiUTmJBgm5IJTEiwTckEJiTYpmQCExJsUzKBCQm2KZnAhATblExgQoJtSiYwIcE2JROYkGCbkglMSLBNyQQmJNimZAITEmxTMoEJCbYpmcCEBNuUTGBCgm1KJjAhwTYlE5iQYJuSCUxIsE3JBCYk2KZkAhMSbFMygQkJtimZwIQE25RMYEKCbUomMCHBNiUTmJBgm5IJTEiwTckEJiTYpmQCExJsUzKBCQm2KZnAhATblExgQoJtSiYwIcE2JROYkGCbkglMSLBNyQQmJNimZAITEmxTMoEJCbYpmcCEBNuUTGBCgm1KJjAhwTYlE5iQYJuSCUxIsE3JBCYk2KZkAhMSbFMygQkJtimZwIQE25RM4EtC2gqtaSTAKkyEtLVFSdDNQkhbW5QE5QyEtLVFSdBOf0hbW5QE9SyGVCyKj/m47Y8bISQ+5uPFHzdCSHzMx4s/bkR/SIWS1jceYDkGQgroCOpZCCmgI2hnIqSAjqCcjZCC/f399QwEWEnjkKZHfefunsxdVF1/fnAz/WjytXM7357lDyqfJh4GIcG0piGdH7jIjedzFtXWD1wa0mm8wu3Ga8b9+MHOD9VhEBJMaxrSwO2dBJNDt3fmX1RZPx24NKQwnXDN9DheMz2sf5pkGIQE0xqGNO7H+5rzg3xfUlpUWf/6gctCGqTRDNwj76dJh0FIMK1hSMM0i6G7711UXj907t5psiTcBz2K14yix6PKwnwYhATTGoY0KObgWVReP9z9Pm8m3fmM++GeiT0SOqpZSOUc6os8670hzc6RbhY+eS+2eACEBN3aDml29S45V5oex1ft7hWvNRAS7Fs6pOwCd2mRZ/0ov2oXZhMFFK0ZP0iuhVffSCIk2Nb6Him68hD5JjlHSqviHAnd0n5I8bXwOyfxmkF60W9QOkkKCAnWtXLVrvLM2WNPb9kwCAmmNX4f6X7pz+qi+vpqSNHOiJDQVe3c2RDkIaVpjfvRGg7t0FENQ5oeRlfaSjfJlRbV12chjdzOw/A8qR8nNHJcbEAnNb1pdVK4uzvZu5QWlR9EZod2yTtHaWHpJbz8ADEbBiHBtMa/jzQ5in6RKK4hDam4qPIgKJ4jnX7l3GcP0wf/G/0+0h1+Hwkdw2/IAgIICRBASIAAQgIEEBIggJAAAYQECCAkQAAhAQIICRBASIAAQgIEEBIggJAAAYQECCAkQAAhAQIICRBASIAAQgIEEBIggJAAAYQECCAkQAAhAQIICRBgIqT9xLoGAyyNkAABFkLa36ckKEdIgABCAgRYCIlzJKhHSIAAEyHxPhK0IyRAACEBAggJEEBIgABCAgQQEiCAkAABhAQIICRAACEBAggJEEBIgABCAgQQEiCAkAABRkKiJOhGSIAAQgIEEBIggJAAAYQECCAkQAAhAQIICRBASICAxiFNj/rO3T2Zu6i6/vzgZvrR5Gvndr49S592HD7ts4e1YRASTGsa0vmBi9x4PmdRbf3ApSGdxivcbrxmkjzN3asOg5BgWtOQBm7vJJgcur0z/6LK+unApSGN+9Ga6XG8ZnrodsMH/+F2fqgMg5BgWsOQxv14X3N+kBdQWlRZ//qBy0IapG0N3KMgGKW7rGG2u5oNg5BgWsOQspk/dPe9i8rrh+Gx22myJNwHPYrXjMLHswf1YRASTGsY0qCQg29Ref1w9/vsmdPDdB827u+dnR8Uz7FKw1g8Dv4DSVCuWUilHDyLPOt9IUX/O/3KubCz4hBiC/9+QoJyngn866sg+Ot276Nn+aLVQ5pdvYvOlcK1R8lVu/v5524QEv8RWWhXm8DvHl/9KXgTTe0rT2YLC6FkB2elRZ71o/yq3b2z6Kqdu/F8FF34jh8sd9WOkKBdbQK/6F17FTztXQ8/uD5b+B57pOjKQ+SbcM0o2xUNlrtqR0jQrjqBLx6HO6J3t3q3g7fb4a4p9T4hxdfC75wk50i1p2XD4BwJplUn8Ltb8ZFdXFMe0pJX7SrPnD2eHfjlR4DZMAgJpnlDehod3pVCyt4/Kr2PVFhUX18NaRCume24Rm65PRLvI0G5+qFd73Z4ZPdpEO6WwpoyS97ZEOQhpWklR3X5JbziZbuAkGBdbQLHF+zCfVFSUya5Sa50r11pUX19FtLI7TwMz5P6cTrjfnSD+NJX7QJCgnL1CRy9hfQkOsb7pLh0Uri7O71mUFxUfhCZHdodJ1ftksJG/fjBTvVOIUKCbY1/H2kSvZV6N64hu/hWWFR5EBTPkaJ7GWa/gTSJfm3pTunXmuJhEBJM4zdkAQHNbhFqfxiEBNOa3SLU/jAICaY1u0Wo/WEQEkxrdotQ+8MgJJjW8Bah1odBSDCt4S1CrQ/j0quHlATNGt4i1PowCAmmNbxFqPVhEBJMa3qLUNvDICSYZuXOBkKCat4J/N9/+cvf1jwMQoJp9Ql88WPyz/p8sr5LDYQE62oT+OJxr/fRF1983lvnRTtCgnGeW4Suxner/sJVO6Ax3/tIyUe8jwQ05r2zofLROoZBSDDNSEj8e1zQzcihHSFBN88tQle+jP58uZ0VtZZhNPoHIikJWtUncPQ20scfR28krXMYhATTPBP458+j92M/+m6twyAkmOafwBfrvKshHgbnSDBt/gS++NM/crEBaGb+BFZ1+Zv3kaAbIQECCAkQQEiAAEICBBASIICQAAHFCXzxpy8K/qDqnywmJKhWnMDvbvVKVIVESdCsNIF//VvJ/6xxGIQE08z8u3aEBM0ICRBASIAAQgIEEBIgwEpI/EISVCMkQICRkPhHG6AbIQECCAkQYCQkzpGgGyEBAqyExPtIUI2QAAGEBAggJEAAIQECCAkQQEiAAEICBBASIICQAAGEBAiwEhL32kE1QgIENA5petR37u7J3EXV9ecHN9OPJl87t/PtWf66cX+v8CgZBr+PBNOahnR+4CI3ns9ZVFs/cGlIp/EKtztbMz10hISOaRrSwO2dBJNSAqVFlfXTgUtDGvejNdPj/JVDR0jomoYhjfvxvub8YOcH76LK+tcPXBbSIK1m4B5lr1shJM6RoFvDkIZpFkN337uovD7c59w7TZaEx3FJQKP0GeGCb5Y/RyIk6NYwpEElh+qi8vrh7vfZM6eH6T4su8IQnjutcLEh4H0kqNYspFoOlUWe9XNCGoWHdZWQkv+q2aVjICQo1nZIs6t3yblSfBJFSOicpUPKLnCXFnnWj/KrdvfOoqt28aXxQXQOxaEdOqf1PVJ05SESX2EYxrul1UKiJCjWfkjxtfA7J9GacT9+GiGhc1q5ald55uxxunOq3iIREBKsa/w+0v3Sn9VF9fXVkKKzo/cJiTeSoFk7dzYEeUhpWulRXfrKFQ7tCAmaNQxpeuh2K/falRbV12chjdzOw/A8qZ/vylYKiZvtoFrTm1Ynhbu7071LcVH5QWR2aHecHMsV2iEkdE7j30eaHIU13I0DyA7TCosqD4LiOdLpV8599rDwqQgJnWPlN2Q5R4JqhAQIMBNSklL7IwFWYSgk3pGFXoQECDAWEiVBJ0MhcbkBehESIMBOSLwlC8UICRBASIAAOyFxjgTFCAkQYCgk3pGFXqZCoiRoZSkkju2gFiEBAgyFxPVv6EVIgABCAgQYColzJOhFSIAASyFREtQiJECApZC42gC1CAkQQEiAAEshcY4EtSyGREpQx1RI7JOwgpUnzDIvtBUSuyQblvgOLfnNXP57v/KMWe6FhIRUg83abMsv8T1a8tu5ynefkDwIaeFkXrhhLtlqDTZs022/oZD2W9JsaLZCCpb74iyb80Uu+PqbzLKFf99lG3bOU9qawFos2iQ5oyEZLck7cN/CuV/lgi9/4ZbxrVzLNLTv8m9rhJDE1EZVXeAduv/rqS5d37Sxa/63ZcHaxd/PJV5oNSQNJZVGURtWfZzekZcXtjjPWuPbLt7l/k3Y9KkrPH3l16zwQmMhrX+XtF+JozqSOQ/LC8Qnr4jq11lbVt8Ulz1lqect99QVnp6/aslXrPBCsyG1WtLs05f+rvJfXHgkPME9ql//nEHP3y6XbrRLn7DMNG72rGWfusLT18daSPIl7Rc6Kf0VlQ+LD0QjKap8lXO//AVbZu5Xedk2a7BJ5bZ653ywIVVLKXzS6jKpPrzj9n8xi3u55GtaYSXel7mQgtr8XM5+cZey4INlO6kNqT7GJUJi3lvzAYSUz/R82lb+FCinQUhLvI8Ea+yFFNSm9JwnJf+3YirpJy/9LeW/0leOZwz4MBgMyd9GVs17n9k0udgweyy5DWBZZ0JasZom9ZT+ZsEvGh1iMSS5lPxX7QgGS/swQ6rsf2afVPzrwofCZkjvm1JANpD1gYVEQGiH1ZCap1R6Hwloh92Qgstaoh2sj+mQguKvVewX3kcSHRtwOeshASoomcCEBNuUTGBCgm1KJjAhwTYlE5iQYJuSCUxIsK3xBJ4e9Z27ezJ3UXX9+cHN9KPJ187tfHuWPHgdPSh/mngYhATTmk7g8wMXufF8zqLa+oFLQzqNV7jdeM1x8mDnh+owCAmmNZ3AA7d3EkwO3d6Zf1Fl/XTg0pDG/WjN9DheM3I7D4PoacUg42EQEkxrOIHH/Xjqnx/k+5LSosr61w9cFtIgbWvgHgXTw/D/4qclfxaGQUgwreEEHqZZDN1976Ly+qFz906TJVk74c7oZhhQuica5J8mHQYhwbSGE3hQyMG3qLx+uPt99szpYboPG/dLR4WEhE5pNoE9OZQWedYvCql4hBhFFHmPrwHYuLZDml29GxSuUwzz/VpASOiCpUPKrreVFnnWj/KrdvfOoqt2+ZW6EZe/0TWt75GiKw+Rb/I1/Z3KNTtCgnXthxRfC79zMlszrO+PCAnWtXLVrvLM0uNjX0eEBOMav490v/RndVF9fTWk5Ir3dJDeK1QdBiHBtHbubAjykNK0xv14TfHaXWkYhATTGk7g6aHbrdxrV1pUX5+FlNxe97qf3vLg74iQYFzTCTwp3N2d7l2Ki8oPIrNDu/SG76ig9BZxN7sRLx8GIcG0xhN4chRO/7vx/iQNqbio8iAoniOdfuXcZw+TZYSEblIygQkJtimZwIQE25RMYEKCbUomMCHBNiUTmJBgm5IJTEiwTckEJiTYpmQCExJsUzKBCQm2KZnAhATblExgQoJtSiYwIcE2JROYkGCbkglMSLBNyQQmJNimZAITEmxTMoEJCbYpmcCEBNuUTGBCgm1KJjAhwTYlE5iQYJuSCUxIsE3JBCYk2KZkAvcAe4ozeGPtlG16kwDLK07gjaWzFNWHfqoHx+hWt8zgNH8dBZ3Z3uvH6FZGSOulenCMbnWEtF6qB8foVtfBkADdCAkQQEiAAEICBBASIICQAAGEBAggJEAAIQECCAkQQEiAAMUhTY/6zt09uWTRhrz+2rmd0kjOD1zsxvONDWrRULRsuumhy+TDU7Ltzg9uph8tP/f0hpRu3OK29SzakOPkG7/zQ75o3FcxGeYMRc2m84akZNsNXBrSCnNPb0gDt3cSTA7d3tmiRZsxcjsPg2gkhe06yr4Lm+cZippNlxn3Cz+FVGy76cBlw1hh7qkNadyPJ+n5Qb69PYs2I/yp+iiIR5L8GRsUPt6w+lDUbLpMuAnv5480bLvXD1wW0ipzT21Iw/SLGuYb3LNoM84P0j3RIB/J9FDLHPUNRc2mywyLP9o1bLuhc/dOZ1tp+bmnNqTsh1Rhr+9ZtGGFkM4Pdv8z/Jl2Z/On876haNt0pX25im033P1+tnVWmXtaQ5r9kBr3sx9dnkUbVt73p6fQmz9IqQ9F3aYbluajlm2XVrLS3COk91CcDqPw0OAs+L8jt/mjlPpQtG26yqmGlm3X8ZCyK2OeRZs1Kn7jh7PDgo2fhdSHom3TjcoXv7Rsu3pIzeeegZC07pFG/R3PochIzxXmfCjKNl121bNq09uu43skpbNh6D8QUfIzP+L9gaph083bRpvedl0MSf1Vu+M5B/Q6pmqsMBRVm27uKDa97bp41W52wb50Lb+2aFOmA7db+uE5O1rZ/FT1DUXRpgtq50Jqtt2o8mbRMnNPbUia72yIbxg5qy5JDws2fQ3XOxRFm87z/quWbZeF1Kk7G8Ktulu5ucmzaEOG9SGM+9El3MmDzQ/ONxQ9my4o3BiS0bLtspBWmXtqQwomhdtt0zscJ0puYc7u+k9uzkoHN0xvYFZwa0NxKMo2XaRwKqRr280OLVeYe3pDCiZH4cDvxps8u1W4sGiTRs4TUjCJfkXp3sYHFykMRdmmixSucuvadvk52vJzT3FIgB2EBAggJEAAIQECCAkQQEiAAEICBBASIICQAAGEBAggJEAAIQECCKm7Lv7Yu/Lk4sft3u9fbXoo3UdI3fXmydvtv/uXZ8HL3vVND6X7CKnL3m5fC3dGF4+vsUtqGyF12dvtaF908fjqT5seSecRUpcR0toQUpcR0toQUpcR0toQUpcR0toQUpcR0toQUpcR0toQUvcR0hoQUvcR0hoQUvcR0hoQ0gfgKSG1jpA+AE+vPNn0EDqPkAABhAQIICRAACEBAggJEEBIgABCAgQQEiCAkAABhAQIICRAACEBAggJEEBIgID/B9jrHIQelqRFAAAAAElFTkSuQmCC" alt="Plot generated in survkl vignette" /></p>
<p>The cross-validated performance curve from hyperparameter tuning
functions <code>cv.coxkl</code> or <code>cv.cox_MDTL</code> can be
visualized directly using <code>cv.plot()</code>:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">cv.plot</span>(cv.coxkl_est)</span></code></pre></div>
<p><img role="img" aria-label="Plot generated in survkl vignette" src="data:image/png;base64,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" alt="Plot generated in survkl vignette" /></p>
<ul>
<li>The solid purple curve displays the cross-validated loss across
different values of <code>eta</code>.</li>
<li>The green dotted horizontal line marks the internal baseline at
<code>eta</code> = 0, representing the model that does not incorporate
external information.</li>
<li>The vertical dashed orange line indicates the optimal
<code>eta</code> value, where the cross-validated loss is
minimized.</li>
</ul>
<p>A comparison between the purple curve and the green baseline shows
whether borrowing external information improves prediction performance.
Whenever the purple curve falls below the green line, using external
information (<code>eta</code> &gt; 0) yields better predictive accuracy
than relying solely on the internal model.</p>
</div>
</div>
<div id="high-dimensional-integration" class="section level4">
<h4>High-Dimensional Integration</h4>
<p>In high-dimensional regimes—such as when the number of predictors is
comparable to or exceeds the sample size—the <code>SurvBregDiv</code>
package extends Bregman-divergence–integrated Cox modeling with
regularization. Similar to the low-dimensional setting, both
<strong>Kullback–Leibler (KL) divergence</strong> and <strong>squared
Mahalanobis distance</strong> are supported as specific Bregman choices
for external information integration.</p>
<p>Two families of penalties are implemented:</p>
<ul>
<li><strong>Ridge penalty (L2)</strong>, via <code>coxkl_ridge</code>
and <code>cox_MDTL_ridge</code>, which shrinks coefficients toward zero
while yielding dense solutions.</li>
<li><strong>Elastic net penalty (mix of L1 and L2)</strong>, via
<code>coxkl_enet</code> and <code>cox_MDTL_enet</code>, where the
<strong>LASSO</strong> corresponds to the special case with mixing
parameter set to 1.</li>
</ul>
<p>These models combine:</p>
<ul>
<li>an <strong>integration penalty</strong>, controlled by
<code>eta</code>, to borrow information from external sources (risk
scores <code>RS</code> or coefficients <code>beta</code>), and<br />
</li>
<li>a <strong>regularization penalty</strong> (ridge or elastic net) to
stabilize estimation under high-dimensional designs.</li>
</ul>
<p>In what follows, we introduce the shared high-dimensional example
dataset and demonstrate the usage of the penalized KL divergence
model.</p>
<p><em>Note: The squared Mahalanobis distance counterparts follow an
identical workflow.</em></p>
<div id="high-dimensional-example-dataset" class="section level5">
<h5>High-dimensional Example Dataset:</h5>
<p>The built-in high-dimensional simulated dataset
<code>ExampleData_highdim</code> contains a training set (200 samples)
and a test set (2000 samples). The dataset includes 50 predictors
(<code>Z1</code>–<code>Z50</code>), of which 6 are signal variables and
the remaining 44 are AR(1) noise variables. Externally derived
coefficients are provided in <code>beta_external</code>:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">data</span>(ExampleData_highdim)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>train_hd  <span class="ot">&lt;-</span> ExampleData_highdim<span class="sc">$</span>train</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>test_hd   <span class="ot">&lt;-</span> ExampleData_highdim<span class="sc">$</span>test</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>z_hd      <span class="ot">&lt;-</span> train_hd<span class="sc">$</span>z</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>delta_hd  <span class="ot">&lt;-</span> train_hd<span class="sc">$</span>status</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>time_hd   <span class="ot">&lt;-</span> train_hd<span class="sc">$</span>time</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>strat_hd  <span class="ot">&lt;-</span> train_hd<span class="sc">$</span>stratum</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>beta_external_hd <span class="ot">&lt;-</span> ExampleData_highdim<span class="sc">$</span>beta_external</span></code></pre></div>
</div>
<div id="model-fitting-1" class="section level5">
<h5>Model Fitting:</h5>
<div id="ridge-penalized-integrated-cox-model" class="section level6">
<h6>Ridge-Penalized Integrated Cox Model</h6>
<p>The function <code>coxkl_ridge()</code> fits a KL-integrated Cox
model with a ridge (L2) penalty on all predictors. External information
is incorporated through a KL-based integration term weighted by
<code>eta</code> (a user-specified scalar), while regularization is
imposed through a sequence of tuning parameters <code>lambda</code>. If
<code>lambda</code> is not provided, the function automatically
generates a decreasing lambda path.</p>
<p>We begin by fitting a KL–ridge model for a fixed integration weight
<code>eta</code> using an automatically generated lambda sequence:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>model_ridge <span class="ot">&lt;-</span> <span class="fu">coxkl_ridge</span>(</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>  <span class="at">z        =</span> z_hd,</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>  <span class="at">delta    =</span> delta_hd,</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>  <span class="at">time     =</span> time_hd,</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>  <span class="at">stratum  =</span> strat_hd,</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>  <span class="at">beta     =</span> beta_external_hd,</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>  <span class="at">eta      =</span> <span class="dv">1</span>                 </span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>)</span></code></pre></div>
<p>The fitted object stores, for each value of <code>lambda</code>:</p>
<ul>
<li><code>model_ridge$lambda</code> — the sequence of lambda values (in
decreasing order),</li>
<li><code>model_ridge$beta</code> — estimated coefficients (one column
per lambda),</li>
<li><code>model_ridge$linear.predictors</code> — linear predictors for
all observations across the lambda path,</li>
<li><code>model_ridge$likelihood</code> — partial log-likelihood along
the lambda path,</li>
<li><code>model_ridge$data</code> — the data used for fitting.</li>
</ul>
</div>
<div id="elastic-net-lasso-penalized-integrated-cox-model" class="section level6">
<h6>Elastic-Net / LASSO-Penalized Integrated Cox Model</h6>
<p>The function <code>coxkl_enet()</code> fits a KL-integrated Cox model
with an elastic-net penalty, controlled by the mixing parameter
<code>alpha</code>. When <code>alpha = 1</code>, the penalty reduces to
<em>LASSO</em>, introducing coefficient sparsity in addition to KL-based
integration of external information.</p>
<p>External knowledge can be incorporated either through external
coefficients (<code>beta</code>) or through an externally computed risk
score (<code>RS</code>). The integration parameter <code>eta</code>
determines how strongly the model borrows from this external
information, while the penalty parameter <code>lambda</code> controls
sparsity. If <code>lambda</code> is not provided, the function
automatically generates a decreasing lambda sequence.</p>
<p>Below, we illustrate the workflow using the <em>LASSO</em> special
case (<code>alpha = 1</code>) with an automatically generated lambda
path:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>model_enet <span class="ot">&lt;-</span> <span class="fu">coxkl_enet</span>(</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>  <span class="at">z        =</span> z_hd,</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>  <span class="at">delta    =</span> delta_hd,</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>  <span class="at">time     =</span> time_hd,</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>  <span class="at">stratum  =</span> strat_hd,</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>  <span class="at">beta     =</span> beta_external_hd,   </span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>  <span class="at">eta      =</span> <span class="dv">1</span>,                 </span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>  <span class="at">alpha    =</span> <span class="dv">1</span>                  <span class="co"># LASSO penalty</span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>)</span></code></pre></div>
<p>The fitted object stores, for each lambda value:</p>
<ul>
<li><code>model_enet$lambda</code> — the lambda sequence (in decreasing
order),</li>
<li><code>model_enet$beta</code> — estimated coefficients (one column
per lambda),</li>
<li><code>model_enet$likelihood</code> — partial log-likelihood along
the lambda path,</li>
<li><code>model_enet$data</code> — the data used for fitting.</li>
</ul>
</div>
</div>
<div id="hyperparameter-tuning-via-cross-validation-1" class="section level5">
<h5>Hyperparameter Tuning via Cross-Validation</h5>
<p>For penalized integrated models, the functions
<code>cv.coxkl_ridge()</code> and <code>cv.coxkl_enet()</code> perform
K-fold cross-validation to tune the integration parameter
<code>eta</code>, while internally scanning over a <code>lambda</code>
path for each candidate <code>eta</code>. For each value of
<code>eta</code>, the cross-validation procedure:</p>
<ul>
<li>evaluates a sequence of ridge or elastic-net penalties
<code>lambda</code>,</li>
<li>computes the chosen cross-validation criterion on the held-out
folds,</li>
<li>selects the best <code>lambda</code> for that <code>eta</code>,</li>
<li>aggregates the performance across folds into summary tables.</li>
</ul>
<p>The following criteria are supported:</p>
<ul>
<li><code>&quot;V&amp;VH&quot;</code> — V&amp;VH loss (reported as
<code>Loss = -2 * score</code>),</li>
<li><code>&quot;LinPred&quot;</code> — predicted partial deviance,</li>
<li><code>&quot;CIndex_pooled&quot;</code> — pooled C-index across all folds,</li>
<li><code>&quot;CIndex_foldaverage&quot;</code> — fold-averaged C-index.</li>
</ul>
<p>Below we demonstrate tuning <code>eta</code> using 5-fold
cross-validation and the <code>&quot;V&amp;VH&quot;</code> criterion for the
LASSO-penalized integrated model (<code>alpha = 1</code>). (For ridge,
use <code>cv.coxkl_ridge()</code> analogously.)</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>eta_grid_hd <span class="ot">&lt;-</span> <span class="fu">generate_eta</span>(<span class="at">method =</span> <span class="st">&quot;exponential&quot;</span>,</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>                            <span class="at">n =</span> <span class="dv">50</span>,</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>                            <span class="at">max_eta =</span> <span class="dv">100</span>)</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>cv_enet_hd <span class="ot">&lt;-</span> <span class="fu">cv.coxkl_enet</span>(</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>  <span class="at">z =</span> z_hd,</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>  <span class="at">delta =</span> delta_hd,</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>  <span class="at">time =</span> time_hd,</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>  <span class="at">stratum =</span> strat_hd,</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>  <span class="at">beta =</span> beta_external_hd,</span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a>  <span class="at">etas =</span> eta_grid_hd,</span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="dv">1</span>, <span class="co"># LASSO</span></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a>  <span class="at">nfolds =</span> <span class="dv">5</span>,</span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a>  <span class="at">cv.criteria =</span> <span class="st">&quot;V&amp;VH&quot;</span>,</span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">1</span></span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a>)</span></code></pre></div>
<p>The best <code>lambda</code> for each <code>eta</code> (according to
the chosen criterion) is provided by:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>cv_enet_hd<span class="sc">$</span>integrated_stat.best_per_eta</span></code></pre></div>
<pre><code>##             eta       lambda     Loss
## 1    0.00000000 1.019360e-01 2.842157
## 2    0.09953651 9.773006e-02 2.840152
## 3    0.20888146 9.390799e-02 2.838419
## 4    0.32900138 2.575599e-02 2.829181
## 5    0.46095806 2.161908e-02 2.817568
## 6    0.60591790 1.818471e-02 2.806310
## 7    0.76516225 1.583720e-02 2.795556
## 8    0.94009872 1.487692e-02 2.786297
## 9    1.13227362 1.302389e-02 2.778563
## 10   1.34338567 1.139452e-02 2.772374
## 11   1.57530093 1.068340e-02 2.767340
## 12   1.83006939 9.336846e-03 2.763147
## 13   2.10994303 8.156289e-03 2.759722
## 14   2.41739573 7.636767e-03 2.756923
## 15   2.75514517 6.665955e-03 2.754581
## 16   3.12617683 1.168692e-03 2.752477
## 17   3.53377037 8.866867e-04 2.747700
## 18   3.98152865 1.553666e-04 2.743494
## 19   4.47340953 8.912293e-05 2.739607
## 20   5.01376093 8.931986e-05 2.736818
## 21   5.60735916 8.949908e-05 2.734883
## 22   6.25945124 8.966217e-05 2.733633
## 23   6.97580122 8.981060e-05 2.732915
## 24   7.76274115 8.994568e-05 2.732588
## 25   8.62722703 9.006861e-05 2.732567
## 26   9.57690034 9.018050e-05 2.732783
## 27  10.62015555 9.028233e-05 2.733161
## 28  11.76621431 9.037501e-05 2.733665
## 29  13.02520701 9.045937e-05 2.734254
## 30  14.40826229 9.053614e-05 2.734904
## 31  15.92760542 9.060603e-05 2.735591
## 32  17.59666636 9.066963e-05 2.736292
## 33  19.43019846 9.072753e-05 2.736987
## 34  21.44440891 9.078022e-05 2.737676
## 35  23.65710197 9.082819e-05 2.738336
## 36  26.08783632 9.087185e-05 2.739012
## 37  28.75809801 9.091159e-05 2.739655
## 38  31.69149033 9.094776e-05 2.740275
## 39  34.91394249 9.098069e-05 2.740907
## 40  38.45393876 9.101066e-05 2.741567
## 41  42.34277030 9.103794e-05 2.742080
## 42  46.61481175 9.106278e-05 2.742553
## 43  51.30782504 9.108538e-05 2.742993
## 44  56.46329322 9.110596e-05 2.743404
## 45  62.12678712 9.112469e-05 2.743741
## 46  68.34836818 9.114174e-05 2.744012
## 47  75.18303094 9.115726e-05 2.744249
## 48  82.69118918 9.117139e-05 2.744425
## 49  90.93920990 9.118424e-05 2.744550
## 50 100.00000000 9.119595e-05 2.744670</code></pre>
</div>
<div id="visualization-1" class="section level5">
<h5>Visualization:</h5>
<p>Objects from <code>coxkl_ridge</code> or <code>coxkl_enet</code> can
be visualized using the S3 plotting method <code>plot()</code>:</p>
<p>This plots (at given <code>eta</code>):</p>
<ul>
<li>Loss or C-index versus the penalty parameter
<code>lambda</code>,</li>
<li>x-axis on a reversed log10 scale (larger penalties on the left,
smaller penalties on the right),</li>
<li>y-axis labeled as loss or C-index,.</li>
<li>A vertical dashed orange line marks the optimal value of λ, where
the loss reaches its minimum on the evaluated grid.</li>
</ul>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>  model_enet,</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>  <span class="at">test_z       =</span> test_hd<span class="sc">$</span>z,</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>  <span class="at">test_time    =</span> test_hd<span class="sc">$</span>time,</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>  <span class="at">test_delta   =</span> test_hd<span class="sc">$</span>status,</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>  <span class="at">test_stratum =</span> test_hd<span class="sc">$</span>stratum,</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>  <span class="at">criteria     =</span> <span class="st">&quot;loss&quot;</span></span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>)</span></code></pre></div>
<p><img role="img" aria-label="Plot generated in survkl vignette" src="data:image/png;base64,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" alt="Plot generated in survkl vignette" /></p>
<p>As with low-dimensional models, the helper function
<code>cv.plot()</code> can be used to visualize performance versus
<code>eta</code>:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">cv.plot</span>(cv_enet_hd)</span></code></pre></div>
<p><img role="img" aria-label="Plot generated in survkl vignette" src="data:image/png;base64,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" alt="Plot generated in survkl vignette" />
The resulting plot displays:</p>
<ul>
<li>a purple curve showing the cross-validated performance across the
<code>eta</code> sequence (loss or C-index),</li>
<li>a green dotted horizontal line indicating the internal baseline at
<code>eta = 0</code>,</li>
<li>a green point marking the baseline performance,</li>
<li>and a vertical dashed orange line denoting the optimal
<code>eta</code>, where the cross-validated loss attains its
minimum.</li>
</ul>
</div>
<div id="stability-selection-for-high-dimensional-models" class="section level5">
<h5>Stability Selection for High-Dimensional Models</h5>
<p>Classical LASSO tuned via cross-validation performs well for
prediction, but it is often unstable for variable selection: small
perturbations of the data or changes in cross-validation splits may lead
to different selected subsets, particularly in high-dimensional or
correlated settings. Stability selection provides a complementary
approach that emphasizes reproducibility by repeatedly perturbing the
data and recording how frequently each variable is selected across
subsamples.</p>
<p>The functions <code>coxkl_enet.StabSelect()</code> and
<code>cox_MDTL_enet.StabSelect()</code> extend the cross-validated
elastic-net procedures (<code>cv.coxkl_enet()</code> and
<code>cv.cox_MDTL_enet()</code>) by repeatedly fitting the integrated
elastic-net model on multiple subsamples (controlled by the parameter
<code>B</code>). For each subsample, the model is fit using its own
cross-validated tuning parameters, and the selection status of each
variable along the regularization path is recorded. The function returns
the empirical selection frequency of each variable across resamples and
across the entire penalty path, providing a stability-oriented summary
of variable importance.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>coxkl.StabSelect <span class="ot">&lt;-</span> <span class="fu">coxkl_enet.StabSelect</span>(</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>  <span class="at">z =</span> z_hd,</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>  <span class="at">delta =</span> delta_hd,</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>  <span class="at">time =</span> time_hd,</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>  <span class="at">stratum =</span> strat_hd,</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>  <span class="at">beta =</span> beta_external_hd,</span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>  <span class="at">etas =</span> eta_list,</span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>  <span class="at">cv.criteria =</span> <span class="st">&quot;CIndex_pooled&quot;</span>,</span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a>  <span class="at">B =</span> <span class="dv">20</span></span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a>)</span></code></pre></div>
<p><code>ox_MDTL_enet.StabSelect</code> follows an identical workflow.
Objects from
<code>coxkkl_enet.StabSelect or</code>ccox_MDTL_enet.StabSelect can be
visualized using the S3 plotting method <code>plot()</code>:,
用户需要指定 a selection frequency threshold (between 0 and 1).
Variables whose selection frequency exceeds this threshold are
highlighted in the plot, while others are shown in a muted color. The
x-axis represents the penalty parameter <code>lambda</code> on a
reversed log10 scale, and the y-axis shows the selection frequency:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">plot</span>(coxkl.StabSelect, <span class="at">threshold =</span> <span class="fl">0.6</span>) </span></code></pre></div>
<pre><code>## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
## ℹ Please use `linewidth` instead.
## ℹ The deprecated feature was likely used in the SurvBregDiv package.
##   Please report the issue to the authors.
## This warning is displayed once per session.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<p><img role="img" aria-label="Plot generated in survkl vignette" src="data:image/png;base64,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" alt="Plot generated in survkl vignette" /></p>
</div>
<div id="bagging-for-high-dimensional-models" class="section level5">
<h5>Bagging for High-Dimensional Models</h5>
<p>Besides cross-validated LASSO and stability selection, we
additionally support an ensemble strategy that combines bootstrapping,
external-data integration, and model aggregation. Conceptually similar
to bootstrap aggregation (bagging).</p>
<p>For each bootstrap sample, the integrated model is refit with its own
cross-validated tuning parameters, and the resulting linear predictors
are aggregated across bootstrap replicates. Unlike stability selection,
the goal here is not variable selection, but prediction stabilization:
different bootstrap replicates may recruit different levels of external
borrowing, allowing weak or noisy external signals to be averaged out
rather than over-amplified by a single fit. As a result, this bagged
integration approach reduces variance and improves predictive robustness
compared to relying solely on a single cross-validated integrated LASSO
model.</p>
<p>The functions <code>coxkl_enet_bagging()</code> and
<code>cox_MDTL_enet_bagging()</code> implement this ensemble strategy.
The following example demonstrates how to apply
<code>coxkl_enet_bagging()</code> for bagged integration in
high-dimensional settings. The function inherits the arguments of
<code>cv.coxkl_enet()</code>, with an additional parameter
<code>B</code> that controls the number of subsamples used in the
ensemble.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>bagging.coxkl <span class="ot">&lt;-</span> <span class="fu">coxkl_enet_bagging</span>(</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>  <span class="at">z =</span> z_hd,</span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>  <span class="at">delta =</span> delta_hd,</span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>  <span class="at">time =</span> time_hd,</span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>  <span class="at">stratum =</span> strat_hd,</span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a>  <span class="at">beta =</span> beta_external_hd,</span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a>  <span class="at">etas =</span> eta_list,</span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a>  <span class="at">B =</span> <span class="dv">5</span>,</span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">1</span></span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a>)</span></code></pre></div>
<p>The returned object contains the bagged coefficient estimate (stored
in <code>bagging.coxkl$best_beta</code>) as well as the all
bootstrap-specific estimates (<code>bagging.coxkl$all_betas</code>). In
practice, <code>bagging.coxkl$best_beta</code> can be treated as the
final integrated elastic-net coefficient vector for downstream analysis;
for example, risk scores on a new design matrix <code>z_new</code> can
be computed via the linear predictor
<code>z_new %*% bagging.coxkl$best_beta</code>, while
<code>bagging.coxkl$all_betas</code> can be inspected to assess the
variability of the bootstrap ensemble.</p>
</div>
</div>
</div>
<div id="nested-case-control-ncc-design-with-bregman-divergence-integration" class="section level3">
<h3>Nested Case-Control (NCC) Design with Bregman Divergence
Integration</h3>
<p>In the NCC setting, event times are represented through matched
case–control sets and estimation proceeds via conditional logistic
regression. <code>SurvBregDiv</code> enables external information
borrowing within this framework through Bregman divergence, allowing
improved efficiency while respecting the matched-set structure. The
remainder of this section demonstrates the core usage and workflow.</p>
<div id="low-dimensional-integration-1" class="section level4">
<h4>Low-Dimensional Integration</h4>
<div id="example-dataset" class="section level5">
<h5>Example Dataset:</h5>
<p>The built-in simulated dataset for NCC designs,
<code>ExampleData_cc</code>, contains a training set (1000 samples) and
a test set (2500 samples). The data include a <code>stratum</code>
variable, where observations with the same stratum ID belong to the same
matched set. The training data contain 200 matched sets and the test
data contain 500 matched sets, each constructed under a 1:4 matching
scheme. The dataset further includes six predictors
(<code>Z1</code>–<code>Z6</code>). Externally derived coefficients are
provided in <code>beta_external</code>:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="fu">data</span>(ExampleData_cc)</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>train.cc  <span class="ot">&lt;-</span> ExampleData_cc<span class="sc">$</span>train</span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>test.cc   <span class="ot">&lt;-</span> ExampleData_cc<span class="sc">$</span>test</span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>z.cc      <span class="ot">&lt;-</span> train.cc<span class="sc">$</span>z</span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a>y.cc      <span class="ot">&lt;-</span> train.cc<span class="sc">$</span>y</span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a>set.cc    <span class="ot">&lt;-</span> train.cc<span class="sc">$</span>stratum</span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a>beta_ext.cc <span class="ot">&lt;-</span> ExampleData_cc<span class="sc">$</span>beta_external</span></code></pre></div>
</div>
<div id="model-fitting-and-hyperparameter-tuning" class="section level5">
<h5>Model Fitting and Hyperparameter Tuning</h5>
<p>The main fitting function for this setting is <code>clogitkl</code>.
Users must specify the tie-handling method via the <code>method</code>
argument. For 1:M matched case–control studies, <code>&quot;breslow&quot;</code>
and <code>&quot;exact&quot;</code> yield identical results, although
<code>&quot;exact&quot;</code> is theoretically preferable. For n:m matched
designs with <span class="math inline">\(n &gt; 1\)</span>, the two
methods can differ.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>eta_list <span class="ot">&lt;-</span> <span class="fu">generate_eta</span>(<span class="at">method =</span> <span class="st">&quot;exponential&quot;</span>, <span class="at">n =</span> <span class="dv">50</span>, <span class="at">max_eta =</span> <span class="dv">5</span>)</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>clogitkl.fit_breslow <span class="ot">&lt;-</span> <span class="fu">clogitkl</span>(<span class="at">y =</span> y.cc, <span class="at">z =</span> z.cc, <span class="at">stratum =</span> set.cc, </span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a>                                 <span class="at">eta =</span> eta_list, <span class="at">beta =</span> beta_ext.cc,</span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a>                                 <span class="at">method =</span> <span class="st">&quot;breslow&quot;</span>)</span></code></pre></div>
<p>The object returned by <code>clogitkl</code> can be visualized using
the S3 <code>plot()</code> method. Its usage is consistent with the
full-cohort integrated Cox model introduced earlier:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>  clogitkl.fit_breslow,</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>  <span class="at">test_z       =</span> test.cc<span class="sc">$</span>z,</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>  <span class="at">test_delta   =</span> test.cc<span class="sc">$</span>y,</span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>  <span class="at">test_stratum =</span> test.cc<span class="sc">$</span>stratum,</span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>  <span class="at">criteria     =</span> <span class="st">&quot;loss&quot;</span></span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a>)</span></code></pre></div>
<p><img role="img" aria-label="Plot generated in survkl vignette" src="data:image/png;base64,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" alt="Plot generated in survkl vignette" /></p>
<p>Similarly, cross-validation for tuning <code>eta</code> can be
performed via <code>cv.clogitkl()</code>, which shares the same
interface and functionality as its full-cohort counterparts:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>cv.clogitkl.fit_breslow <span class="ot">&lt;-</span> <span class="fu">cv.clogitkl</span>(</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>  <span class="at">y        =</span> y.cc,</span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>  <span class="at">z        =</span> z.cc,</span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>  <span class="at">stratum  =</span> set.cc,</span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a>  <span class="at">beta     =</span> beta_ext.cc,</span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a>  <span class="at">etas     =</span> eta_list,</span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a>  <span class="at">method   =</span> <span class="st">&quot;exact&quot;</span>,</span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a>  <span class="at">nfolds   =</span> <span class="dv">5</span>,</span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a>  <span class="at">criteria =</span> <span class="st">&quot;loss&quot;</span></span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a>)</span></code></pre></div>
<p>The cross-validated performance curve can be visualized using
<code>cv.plot()</code>:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="fu">cv.plot</span>(cv.clogitkl.fit_breslow)</span></code></pre></div>
<p><img role="img" aria-label="Plot generated in survkl vignette" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA0gAAAHgCAMAAACo6b1DAAABNVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrYbnnc6AAA6OgA6Ojo6OmY6ZmY6ZpA6ZrY6kNtNTU1NTW5NTY5Nbm5Nbo5NbqtNjshmAABmOgBmOjpmZjpmZmZmZpBmkJBmkLZmtttmtv9uTU1ubk1ubm5ubo5ujqtujshuq+R1cLOOTU2Obk2Obm6Oq6uOq8iOq+SOyOSOyP+QOgCQZjqQZmaQZpCQkGaQttuQ2/+rbk2rbm6rjm6ryOSr5P+2ZgC2Zjq2kDq2kGa2tra229u22/+2///Ijk3Ijm7Iq27IyKvI5P/I///ZXwLbkDrbkGbbtmbbtpDbtrbb27bb29vb2//b///kq27kyI7kyKvk////tmb/yI7/25D/27b/29v/5Kv/5Mj/5OT//7b//8j//9v//+T////lS9tDAAAACXBIWXMAABJ0AAASdAHeZh94AAAXZklEQVR4nO3dDXvb1nmAYdi1Z6npmkCOHGfN1phZbFnuNtvtFmtOnKyzqUyJ62yd6Q86kWaJ+P8/YfjmCxIgwcOXOOeAz31drSUSNBD5PAJwCJJBBGBtge0NAPqAkAAFhAQoICRAASEBCggJUEBIgAJCAhQQEqCAkNb3bvfys+otF//x4cp/S/Nj3gbXVt+onMq2vb85+5dgFiGtb36wmgz95sfohmTwtxHScoS0Ptsh7cSa7iOkjhDS+iyHtLOzoCRC6gghrS8brE+CWy9+HQS/fRpdPAxiyXD9+Y+7QfCbp+lSF98GwZWnz4OPkrH80Yvd4MqjKPrp7+Ilf/X7lw2PieLFLn2+eOjv7CwqqdW2FdszXSxRbhshtUBI6ysG6wfJGA0uPysH67vd9JZLt+KFshsv/S4L6W/je66+jL4NMtei2sfEf2fis0Uh7ewsLKnVthXbM10svnG6bYTUAiEtdLdedaFisAbXXia7kFvF4dP7m8GH8b7mu3RgPg8ufRX9/GmQhZRUlPwZ3xbvdoJLj2ofE9//eXTxJKgNKU+nZUgLt63Ynupi020jpOUIaaGVQsoH40fFYH2eB5AczsV7glvpotndSTn5slF+3/xj8vvju9cPadG2ie2ZLia3jZCWI6SFVgopHZrpCE0H68XDbHjG9199mfwv+Tofy9k3iV/++9/i3dStuse8v5l981whpEXbVm6PXExuGyEtR0jrKwZr+itcDtagcPnZ2+oeIA8pOdRL3ap7TDF+NSYbFm2bCGm6mNw2QlqOkNbXMFjj05DGkK7lD4zP9n/zD/85PbSrPKaYul5/+nvxtpUrkIvJbSOk5QhpfY2DNT98ShS/9GVIycnPy6hyjlR5TLs9UpsnZBdvW11IlW0jpOUIaX3Nh0+3xDKVc6R04BajOd493Kp7zOJzJL1tqwupsm2EtBwhra9hsMZfZvEke6N85Mbjcj6kt4GcTZs+ZvGsnd62LQop3TZCWo6Q1lc3WK+mFwQEV59G+fMyz5Mp5vJ5JHFod/FdEExnICqPSSfLkysidEOaW0/joV2+bYS0HCGtb36wvssuXHibXT0QJK9bqF7ZkA3ct9ndV79reEz8ly29skFj2+omG+S2EdJyhLS++cEa/WU3/b2fXc/2VbpUdq2dPEeKop/iPdSvPs93EjWPiV78eum1dgrbVheS3DZCWo6QuvVEnuSjPwipG/lzQtVpZ/QHIXUjPrlPTt6fiIuD0CeE1JEX2ck7O6SeIqSuJK+Tu5S/Zg69Q0iAAkICFBASoICQAAWEBCggJEABIQEKCAlQQEiAAkICFBASoICQAAWEBCggJEBBtyEFdIt+IiRAASEBCggJUEBIgAJCAhQQEqCAkAAFhAQoICRAASEBCggJUEBIgAJCAhQQEqCAkAAFhAQoICRAASEBCggJUEBI0o8//mh7E+AnQpIICYYISSIkGCIkiZBgiJAkQoIhQpIICYYISSIkGCIkiZBgiJAkQoIhQpIICYYISSIkGCIkiZBgiJAABYQEKCAkQAEhAQoICVBASIACQgIUEBKggJAABYQEKCAkQAEhAQoISeKiVRgiJImQYIiQJEKCIUKSCAmGCEkiJBgiJImQYIiQJEKCIUKSCAmGCEkiJBgiJImQYIiQJEKCIUKSCAmGCAlQQEiAAkICFBASoICQAAWEBCggJEABIQEKCAlQQEiAAkICFBASoICQJC5ahSFCkggJhghJIiQYIiSJkGCIkCRCgiFCkggJhghJIiQYIiSJkGCIkCRCgqH2I3vyeBCGt09mbj0//KS4/zi+/+P72Tev/xCGe3MLExL6qvXIPj8ME9d/qN48DPOQzrL7wzvJN8fZ13vfzK6NkNBPrUf2MLxxEp0dhTfeiBsnwzAPaXIU7p9Ek+/TeMbhXrxniheezY6Q0FNtR/bpII3i/FDuZV7fC4uQxnk0o/j7OKoHUbpw9qdYm+MhAYbajuxRHswoPBC3hXdeZbcX7aTOD/M90VAsnK2NkNBPbUf2MA9lXJwTxUb7Xxffl+3MPIiQsB1ajuzJUX5IdzqonCQVISU3v/oiDOO0pqrHgXFFASGhp/RCepzN1Il90EjsvSJCQp+tHlL1GC4PaZxMfL+JJsdiynu8+vT3TqzdBgFOUdojjYtdUfm8UjQe7M3M2S0NaWeHkuAntUO72ftH8/ujZSHt7FASPLXOrJ34vjziK744rutocUg7O5QEX7V/Humg8mdhXDyPlHczTi99mAzD/Zrp8BVDkknxNV/b+rqVta5siKZ7qGH550H6/9UDwHJthMTX3n3dStuQsmvpZq+1m4Z0OkiuDM9n7UYNHRESX3v4dSutn9g5E1d/l1ML4pxpPMgu+H5QXigelhfiTdfm+GQDF63CUPtnSM+SZ1xvp3uaupDi++OUvjyJsieVTELKS7rbepPUERIMufUK2bQjQoJ/3AopunvXZkeEBFOEJBESDLkV0t27dksiJBgiJImQYMitkDi0g6ccCykiJHjJwZA4tIN/HAvJ8kkSIcEQIUmEBEOOhWR7tgEw41pIlmcbADMuhkRJ8I5rIdl+ShYwQkiAAtdC4tAOXnIuJGYb4CMnQ6Ik+Ma5kDhJgo8ICVDgXEgc2sFH7oXEbAM8REgSF63CkJsh2SqJkGDIvZBszjYQEgwRkkRIMOReSBzawUMOhmRxtoGQYIiQJEKCIUdD4hwJfnEwJIuzDYQEQ4QkERIMORgSh3bwj4sh2ZttICQYIiRAgashURK84mJIvLYP3iEkQIGLIXFoB+84GRIlwTduhsS8HTxDSIACd0OiJHjEzZCYt4NnCAlQ4GZIHNrBM46GZGm2gYtWYYiQJEKCIVdDslMSIcGQqyHZOUkiJBhyNCRL03aEBEOEJBESDDkaEod28IurIdkpiZBgyNmQrEzbERIMEZJESDDkdEidl0RIMORsSFbm7QgJhggJUOBsSFwADp+4GxIlwSMOh8QbN8AfhAQocDwkSoIfakb2Ly+j6C+7wZWnG1jbqudIlAQ/zI3s9w8vP4veBrFLj/TXRkjop7mR/Ty4+jJ6ElyLv7imvzYO7dBPsyP74mG8I3p/M7gVvduNd03aa1vtlIyS4IvZkf3+Znpkl9ZkPSTm7eCL2pCeJId3hAS0Nn9oF9yKj+w+iuLdUlyT9tocD4mLVmFobmSnE3bxviirSXttq4fUaUmEBEPzIzt5CulRcoz34QbWtvpkQ6clERIMtR/Zk8eDMLx9MnPr+eEnxf3H8f0f36+5R6yNkNBPrUf2+WGYuP5D9eZhmOdylt0f3pm7R66NQzv0U+tLhIbhjZPo7Ci88UbcOBmGeS6To3D/JJp8H+59M3NPZW2rXtrHHgl+aHuJ0Okg3RedH+ahpF7fC4tcxvm+apR9L+6prG3la2QJCV5oe4lQHkj854G4LbzzKrs93iE9qCxd3lNdGyGhn9peIjTMQxmLPEb7Xxffnx9WTp7EPdW1ERL6qeUlQpOj/JDudFA5SSpySW5+9UUYxgHN3CNWlVh1+7o9SSIkGGp5iVCLkB5ns3YHM/eIVRmE1PEEOCHBUMtLhERI1QnwPJdxMvH9Jpoch+VkhMqhHSHBDy0vEVq2RxoXu6Lps0dq50hctwr3tbxEaPmh3dz9OiFRErzQdmTXzdqJ78sjvumhn1JIvJQCPqgd2f/z5z//deam4vkj+TxSYlw8j5Tvkcah8h6JkOCD+ZF98W06vRZ8WHk1Uu2VDdE0l2H558HMPZW1ERL6aW5kXzwMgiufffZpUH1dX3Yt3ey1dtNcTgfJleHqs3YRJ0nwQs0lQpfTq1V/nnlh35m4+rucWhC5jAfp/XvllUKKkw2UBNfVPY+UfTX7UvOz5BnX2+n+qC6k+P44pS+nr1ciJGyR2isbZr5SXJvhoR0hwXHuh8RJEjzQ/tBOZW1G79lPSHBezSVClz5P/nyxWxSluTbTkCgJbpsf2cnTSB98kDyRtIG1mX2KTGchcdEqDNWM7J8+TZ6PvfLVJtZmHFI3JRESDNWP7Av1s6N8bcaHdt2UREgw1DyyL/709+5MNhAS3NY8sp2Z/u7wqSRCgiEvQursJImQYMiPkLqatyMkGPInpC5KIiRMrTTkPAmpo10SIaG02i9vj0LqoCRCQubu3RXnij0JqaMZcELaZndrtH6wHNkXf/pM+J39TzWfIiRsRF08Jh1VQnp/M6hwKCRelQQzNaNmSTzlUDOfbPjlrxX/u95/Qt3ajEPiEnCYmEbRLh5j5iPbaG1rrI6QsKoNxyN5FRIloY2u4pH8CYldEhbrPB7Jr5AoCXMW59PVmPEnpI5+s8BVM//4Nnc/NQgJfij3ME71U/InJJ5K2mau9lPyKCROkrbOgnxcGwk+hURJ22FRPs7++3sVEiX1yOy/5MJ8upx/M+NXSJsuiYtWO1PW4ePup4ZfIW36x0tIXelJPlOEJBHSpvUsnym/Qtr0FDghbUw/85nyLKQNnyQRkrrGgHoUUcK3kDZbEiGtpfIv0/M90CzvQtroReCEtI5iT7NdBeW8DGlj/yqEtIbtDKjgX0ibLImQTGx3QTn/QtrkPxMhrYaASoQkEVJL9QVtbUWRjyFt8rkkQqolftzsgxp4GBKXrnas2N2Q0AI+hkRJnaKgNrwMiZK6wFzcKvwMiZI2qbYgftyL+RkS/7RaWl3Vw496OULaas3zCPx4V+NnSLyjkA4KUuNpSJwkrYuCdPkaEiUZI6BN8DYkSjIwnxA/QyX+hkRJy01/QOyFNszfkBgPS+X7HBLqACFJ/bpolZOhDvkb0iamwPsSEgl1zuOQNlCS/yGRkCU+h6Q/3+BdSAtfKcS1PR3yOyTtnZJvIRW5sBeyzvOQlEvyLKT5gkjIll6EpDZ8/AmJhBxDSJIPIZGQk3wPSffYzsmQFl2eQEWu8D4k1ZJcDCkPhr2Q2/wPSTMlB0MiIT/0ISS9khwLiYb80Z+Q+jXMSMgzhOSK8j+ACQUf9SKkPpRUN6dge5vQXj9CirwfepwOea4nIUVe75VoyH/9CcnPkmioJwipc8U2MqfQJz0KyZOSamYVbG8S1tenkCIfRiaTCv3Uq5CicpxuejVmaKi/2o/syeNBGN4+mbn1/PCT4v7j+P6P7y9auIOQ3Cqp6UlWRzYPelqP7PPDMHH9h+rNwzAP6Sy7P7yzYOEuQnKppJrTIWYVeqr1yB6GN06is6Pwxhtx42QY5iFNjsL9k2jyfbj3TdPCUTchRWuMWN2LVmcTIqAeazuyTwfp7uX8MA0l9/peWIQ0znc/o+T72oXTtXVySmY+dNcKadE7+pj/rfBD25E9yoMZhQfitvDOq+z2eIf0YPHC2do6m9swG8HrhJStbS4hGtoObUf2MA9lXJwTxUb7Xxffnx/K86G6hbO1dThJOB3I7QfzGiHNF8T7ym2TliN7cpQfpZ0Oquc9eSvJza++CMM4rcaFg4TCJrdlsFtYIaQF76RAPltIL6TH2azdgTMhGZTUPqR8NoOEkFk9pOqcdh7SOJn4fhNNjpNZu8aFOz20y8khvnScLwhp2cd/cxy33ZT2SOMwn1dInldqXNhGSDOjvrytdtHmkIpW2AmhltqhnbjfsZBqLm+T41+WUAlJ3lFbEAmhtM6snfi+PIhLv3Bi1m5GUwmVpmRIC/ZBrQ4TsVXaP490UPmzMC6eR8p3QuPkaoamhW2GFDVFIcUhLbzf5tbDaWtd2RBNdzrD8s8D61c2NMpKMAmJPRAWazuys2vp5i+fK0I6HSQXe2ezdo0L2w5pKs9i+T7K8nbCF61H9pm4oLucWhCnQeNBev/eg9mFK2tzJSShOqfQcAewWPuRfZY843o73cXUhRTfH6f05cncwpW1ORgSoKBvr5AFrCAkQAEhAQoICVBASIACQgIUEBKggJAABYQEKCAkybEPY4Y/CEkiJBgiJImQYIiQJEKCIUKSCAmGCEkiJBgiJImQYIiQJEKCIUKSCAmGCEkiJBgiJImQYIiQJEKCIUICFBASoICQAAWEBCggJEABIQEKCAlQQEiAAkICFBASoICQAAWEBCggJImLVmGIkCRCgiFCkggJhghJIiQYIiSJkGCIkCRCgiFCkggJhghJIiQYIiSJkGCIkCRCgiFCkggJhghJIiQYIiRAASEBCggJUEBIgAJCAhQQEqCAkAAFhAQoICRAASEBCggJUEBIgAJCkrhoFYYISSIkGCIkiZBgiJAkQoIhQpIICYYISSIkGCIkiZBgiJAkQoIhQpIICYYISSIkGCIkiZBgiJAkQoIhQgIUEBKggJAABYQEKGg/siePB2F4+2Tm1vPDT4ovwtT1H5Lvzv4Qhnv//GZubYSEfmo9svNQsk6mhmEe0ulAhPQq+3p/ZmFCQl+1HtnD8MZJdHYU3pC7mckwLEIaF19EaVTxwpPj6sIRIaG32o7s00G6qzk/3PtmeuPre2EZ0jB8UN4+zAuSt2VrIyT0U9uRPcqDGYUH4rbwzqv89snRtLDJUR6Q3EtlayMk9FPbkT2saWO0/3X5/fnh/n/F+6cvk8mIMqrTwcyxHSGhp1qO7MY2ipCKuYakt4aFg4TCJgPu0QppHB/mvYn+73GYLFdM5Q1DQsJ2WD2k6gT4uDx3Kto5SHdPcVWT47nZckJCT2ntkabfJ/ePssO8f+IcCVtCO6R8j/U6nXhgsgHbYp1Zu7rvK+3UTH8D/WEQUvH8kXweSbRS/9TRcGZhSkKvGIRUe2WDCGcog8prOx3MLLycA8d+9jfB/hY4sAn2t2C1TWi7bFzI/vy1dpXnke68ic7upfePw7378XnSYG6HtHxzPPvx9XQLHNgE+1uwmZCiM3H1t9jVlIdy+UTd9fR1FsfZN7PXrLbYHM9+fD3dAgc2wf4WbCik6OxxnMbtNI26kLKXIN3J03n1RRh+fH+F7Sg2x7MfX0+3wIFNsL8FmwoJQCNCAhQQEqCAkAAFhAQoICRAASEBCggJUEBIgAJCAhQQEqCAkAAFLoVU/zb9XSs/FsCO18m1v3Z/CMn7BNR8AkLH5t6noFPVz4RowaGQGt6mv2vD2dfHdyp/AcrKr4hUNGr4BIRuTeZe+tapymdCtOFQSLVv09818bEANmQviYx/CPZ+nZwO0k24Z/X3SZqzzYEw93Yjy7gTUtOL2TslPxbAguKtL+Kd84Nly27KsHifAKuHBskewWZIc5//sIw7IdW9TX/32zD9WAAbzg/z0Tv/tjHWNsWK+DfK3Jsidrv+VX+duxNS0xt+dUl+LIBV9kOye64fn6ha3QD5mRDtOBNS80dYdMyFkOwe3yZeDewdXGbv12t1HMjPhGiHkGa5ENLI8jYMw3Dva3urT3+PWB0Hlc+EaMXFkOxOgDsQ0tjq9Hf8b/Hv/zgI9/7F2vrzT2KwGFLlMyFacTGkbd8jjQd7Fg+rcq/tHduN0vk62+MgNW49dUhIs6yHNLK8P8q1H0PK8jd7sz0O8m1pe3jkTEhOzNq5sP5jNzqyN5DzKytcuMplhR+COyE1vU1/1+yGNBlavjan/DiEbQ6p+ePEG7kTkhNXNkS2QxravUIqkp9banfPbPXQbjjzISvLuRNS09v0d81qSCPb//Xic0st/0Kz/TzS9DMhWnEnpMrb9FtkM6Ti4n2rF/yN8wvQLc8c2p1sqHwmRBsOhSTfpt8imyGNQwdCyj4OwfrrwizP2lU+E6IFl0ICvEVIgAJCAhQQEqCAkAAFhAQoICRAASEBCggJUEBIgAJC6peLPwaXHl18uxv89qXtTdkuhNQvbx+92/2bf30avQiu2d6U7UJIffNu92q8M7p4eJVdUpcIqW/e7Sb7oouHl5/Z3pKtQkh9Q0hWEFLfEJIVhNQ3hGQFIfUNIVlBSH1DSFYQUt8QkhWE1E+E1DFC6idC6hgh9RMhdYyQeuoJIXWKkHrqyaVHtjdhqxASoICQAAWEBCggJEABIQEKCAlQQEiAAkICFBASoICQAAWEBCggJEABIQEKCAlQQEiAgv8HPBhcMrO5/UkAAAAASUVORK5CYII=" alt="Plot generated in survkl vignette" />
As before, the plot displays a purple curve tracing the cross-validated
performance across the <code>eta</code> grid, a green dotted horizontal
line representing the internal baseline at <code>eta = 0</code> (with a
green point marking its value), and a vertical dashed orange line
indicating the optimal <code>eta</code> at which the cross-validated
loss is minimized.</p>
</div>
</div>
<div id="high-dimensional-integration-1" class="section level4">
<h4>High-Dimensional Integration</h4>
<div id="example-dataset-1" class="section level5">
<h5>Example Dataset:</h5>
<p>The built-in simulated dataset for NCC designs,
<code>ExampleData_cc_highdim</code>, contains a training set with 50
matched sets and a test set with 500 matched sets, each constructed
under a 1:5 matching scheme. The dataset includes 10 predictors
(<code>Z1</code>–<code>Z20</code>). Externally derived coefficients are
provided in <code>beta_external</code>:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="fu">data</span>(ExampleData_cc_highdim)</span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>train.cc_hd  <span class="ot">&lt;-</span> ExampleData_cc_highdim<span class="sc">$</span>train</span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>test.cc_hd   <span class="ot">&lt;-</span> ExampleData_cc_highdim<span class="sc">$</span>test</span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>z.cc_hd      <span class="ot">&lt;-</span> train.cc_hd<span class="sc">$</span>z</span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a>y.cc_hd      <span class="ot">&lt;-</span> train.cc_hd<span class="sc">$</span>y</span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a>set.cc_hd    <span class="ot">&lt;-</span> train.cc_hd<span class="sc">$</span>stratum</span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a>beta_ext.cc_hd <span class="ot">&lt;-</span> ExampleData_cc_highdim<span class="sc">$</span>beta_external</span></code></pre></div>
</div>
<div id="model-fitting-and-hyperparameter-tuning-1" class="section level5">
<h5>Model Fitting and Hyperparameter Tuning</h5>
<p>For high-dimensional NCC data, we demonstrate usage with
<code>clogitkl_enet()</code>, which fits KL-integrated conditional
logistic regression models with elastic-net penalties. The interface and
workflow are analogous to those for the full-cohort integrated Cox
functions.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>clogitkl_enet_fit <span class="ot">&lt;-</span> <span class="fu">clogitkl_enet</span>(</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>  <span class="at">y       =</span> y.cc_hd,</span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>  <span class="at">z       =</span> z.cc_hd,</span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>  <span class="at">stratum =</span> set.cc_hd,</span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>  <span class="at">beta    =</span> beta_ext.cc_hd,</span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>  <span class="at">eta     =</span> <span class="dv">0</span></span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Warning: alpha is not provided. Setting alpha = 1 (lasso penalty).</code></pre>
<p>The fitted object can be visualized using the S3 <code>plot()</code>
method:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a>  clogitkl_enet_fit,</span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a>  <span class="at">test_z       =</span> test.cc_hd<span class="sc">$</span>z,</span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a>  <span class="at">test_delta   =</span> test.cc_hd<span class="sc">$</span>y,</span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a>  <span class="at">test_stratum =</span> test.cc_hd<span class="sc">$</span>stratum,</span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a>  <span class="at">criteria     =</span> <span class="st">&quot;loss&quot;</span></span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a>)</span></code></pre></div>
<p><img role="img" aria-label="Plot generated in survkl vignette" src="data:image/png;base64,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" alt="Plot generated in survkl vignette" /></p>
<p>Cross-validation for tuning <code>eta</code> can be performed via
<code>cv.clogitkl_enet()</code>:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a>eta_list <span class="ot">&lt;-</span> <span class="fu">generate_eta</span>(<span class="at">method =</span> <span class="st">&quot;exponential&quot;</span>, <span class="at">n =</span> <span class="dv">50</span>, <span class="at">max_eta =</span> <span class="dv">5</span>)</span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>cv.clogitkl_enet_fit <span class="ot">&lt;-</span> <span class="fu">cv.clogitkl_enet</span>(</span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a>  <span class="at">y        =</span> y.cc_hd,</span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a>  <span class="at">z        =</span> z.cc_hd,</span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a>  <span class="at">stratum  =</span> set.cc_hd,</span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a>  <span class="at">beta     =</span> beta_ext.cc_hd,</span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a>  <span class="at">etas     =</span> eta_list,</span>
<span id="cb35-9"><a href="#cb35-9" tabindex="-1"></a>  <span class="at">alpha    =</span> <span class="dv">1</span>,</span>
<span id="cb35-10"><a href="#cb35-10" tabindex="-1"></a>  <span class="at">nfolds   =</span> <span class="dv">5</span>,</span>
<span id="cb35-11"><a href="#cb35-11" tabindex="-1"></a>  <span class="at">criteria =</span> <span class="st">&quot;loss&quot;</span></span>
<span id="cb35-12"><a href="#cb35-12" tabindex="-1"></a>)</span></code></pre></div>
<p>The cross-validated performance curve can be visualized using
<code>cv.plot()</code>:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="fu">cv.plot</span>(cv.clogitkl_enet_fit)</span></code></pre></div>
<p><img role="img" aria-label="Plot generated in survkl vignette" src="data:image/png;base64,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" alt="Plot generated in survkl vignette" /></p>
<p>As before, the plot displays a purple curve tracing the
cross-validated performance across the <code>eta</code> grid, a green
dotted horizontal line representing the internal baseline at
<code>eta = 0</code> (with a green point marking its value), and a
vertical dashed orange line indicating the optimal <code>eta</code> at
which the cross-validated loss is minimized.</p>
</div>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
