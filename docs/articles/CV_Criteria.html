<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Cross-validation Criteria â€¢ SurvBregDiv</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Cross-validation Criteria">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-54921687-5"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-54921687-5');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="inverse" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SurvBregDiv</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/SurvBregDiv.html">Get started</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-appendix" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Appendix</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-appendix">
<li><a class="dropdown-item" href="../articles/CV_Criteria.html">CV Criteria</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/UM-KevinHe/SurvBregDiv" aria-label="GitHub repository"><span class="fa fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Cross-validation Criteria</h1>
            
      

      <div class="d-none name"><code>CV_Criteria.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="cross-validation-criterion-for-cox-model">Cross-validation Criterion for Cox Model<a class="anchor" aria-label="anchor" href="#cross-validation-criterion-for-cox-model"></a>
</h2>
<p>Cross-validation is used to select the tuning parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î·</mi><mo>,</mo><mi>Î»</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\eta, \lambda)</annotation></semantics></math>
for the integrated model.<br>
For time-to-event outcomes, we consider two broad classes of evaluation
criteria:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Discrimination-based measures</strong>, represented by
Harrellâ€™s concordance index (C-index) <span class="citation">(Harrell et
al. 1982)</span><br>
</li>
<li>
<strong>Partial likelihoodâ€“based criteria</strong> that assess
goodness of fit</li>
</ol>
<ul>
<li>
<p>The <strong>Harrellâ€™s C-index</strong> evaluates a modelâ€™s
discriminative ability to rank individuals by risk.<br>
A <strong>stratified C-index</strong> is implemented to align with the
stratified Cox model, under which baseline hazards differ across strata
and risk comparisons are valid only within strata.<br>
The detailed formula is given in Appendix @ref(cindex_appendix).<br>
A higher C-index indicates better ability to distinguish high-risk from
low-risk individuals.</p>
<p>In the cross-validation setting, two C-index calculation schemes are
implemented:</p>
<ul>
<li>
<p><strong><code>"CIndex_pooled"</code> (default)</strong></p>
<p>For each validation fold
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi>â€¦</mi><mo>,</mo><mi>ğ’¦</mi></mrow><annotation encoding="application/x-tex">i = 1, 2, \dots, \mathcal{K}</annotation></semantics></math>),
let<br><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>D</mi><mrow><mi>i</mi><mi>s</mi></mrow></msub><annotation encoding="application/x-tex">D_{is}</annotation></semantics></math>
denote the number of comparable pairs and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>N</mi><mrow><mi>i</mi><mi>s</mi></mrow></msub><annotation encoding="application/x-tex">N_{is}</annotation></semantics></math>
the number of concordant pairs within stratum
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>.<br>
The pooled C-index aggregates information across all folds and all
strata:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>C</mi><mo accent="true">Ì‚</mo></mover><mtext mathvariant="normal">pooled</mtext></msub><mo>=</mo><mfrac><mrow><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>ğ’¦</mi></munderover><munderover><mo>âˆ‘</mo><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><mi>S</mi></munderover><msub><mi>N</mi><mrow><mi>i</mi><mi>s</mi></mrow></msub></mrow><mrow><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>ğ’¦</mi></munderover><munderover><mo>âˆ‘</mo><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><mi>S</mi></munderover><msub><mi>D</mi><mrow><mi>i</mi><mi>s</mi></mrow></msub></mrow></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">
\widehat{C}_{\text{pooled}}
=
\frac{
  \sum_{i = 1}^{\mathcal{K}} \sum_{s = 1}^{S} N_{is}
}{
  \sum_{i = 1}^{\mathcal{K}} \sum_{s = 1}^{S} D_{is}
}.
</annotation></semantics></math></p>
<p>This approach is typically more stable across folds and performs well
even in settings with limited events.</p>
</li>
<li>
<p><strong><code>"CIndex_foldavg"</code></strong></p>
<p>In this approach, the C-index is first computed within each
validation fold and then averaged across folds:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>C</mi><mo accent="true">Ì‚</mo></mover><mtext mathvariant="normal">foldavg</mtext></msub><mo>=</mo><mfrac><mn>1</mn><mi>ğ’¦</mi></mfrac><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>ğ’¦</mi></munderover><mfrac><mrow><munderover><mo>âˆ‘</mo><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><mi>S</mi></munderover><msub><mi>N</mi><mrow><mi>i</mi><mi>s</mi></mrow></msub></mrow><mrow><munderover><mo>âˆ‘</mo><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><mi>S</mi></munderover><msub><mi>D</mi><mrow><mi>i</mi><mi>s</mi></mrow></msub></mrow></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">
\widehat{C}_{\text{foldavg}}
=
\frac{1}{\mathcal{K}}
\sum_{i = 1}^{\mathcal{K}}
\frac{
  \sum_{s = 1}^{S} N_{is}
}{
  \sum_{s = 1}^{S} D_{is}
}.
</annotation></semantics></math></p>
<p>Because concordance in a stratified Cox model is only defined within
strata, each fold may contain a different distribution of strata.<br>
When the strata composition varies across folds, the number of
comparable pairs can differ substantially from fold to fold, which may
introduce instability or bias in the fold-averaged C-index even when
each fold has the same total sample size.</p>
</li>
</ul>
</li>
<li>
<p>Two partial-likelihoodâ€“based criteria are included for
cross-validation: the Van Houwelingen (V&amp;VH) likelihood method <span class="citation">(Verweij and Van Houwelingen 1993)</span> and a
linear-predictorâ€“based predictive deviance criterion (LinPred).</p>
<ul>
<li>
<p><strong><code>"LinPred"</code></strong></p>
<p>The LinPred criterion evaluates out-of-sample performance via
cross-validated partial likelihood.<br>
In each fold, the model is fit on the training subset and the estimated
coefficients are applied to the held-out subset to obtain predicted
linear predictors.<br>
These cross-validated predictors are then combined and used to evaluate
the partial likelihood.<br>
This procedure yields an out-of-sample analogue of the Cox partial
likelihood deviance and can therefore be interpreted as a predictive
deviance, equivalent to a cross-entropyâ€“based measure of goodness of fit
<span class="citation">(Simon et al. 2011)</span>.</p>
</li>
<li>
<p><strong><code>"V&amp;VH"</code></strong></p>
<p>The V&amp;VH criterion averages, across folds, the difference between
the log-partial likelihood evaluated on each fold-specific training set
and that of the full dataset.<br>
While this approach preserves the full risk-set structure, it is
computationally more demanding and may be sensitive to high-leverage
observations.</p>
</li>
</ul>
</li>
</ul>
<hr>
</div>
<div class="section level2">
<h2 id="cross-validation-criterion-for-nested-casecontrol-studies">Cross-validation Criterion for (Nested) Caseâ€“Control Studies<a class="anchor" aria-label="anchor" href="#cross-validation-criterion-for-nested-casecontrol-studies"></a>
</h2>
<p>Predictive performance under matched study designs is evaluated
conditionally within matched sets, reflecting the structure induced by
matching rather than a marginal population-based sampling scheme. We
consider three complementary aspects of predictive accuracy:
discrimination, calibration, and goodness-of-fit. All evaluation metrics
are computed on an independent test set composed of matched sets.</p>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>â€¦</mi><mo>,</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">s = 1,\ldots,S</annotation></semantics></math>
index matched sets, and let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>â„³</mi><mi>s</mi></msub><annotation encoding="application/x-tex">\mathcal{M}_s</annotation></semantics></math>
denote the subjects in set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>.
For subject
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>âˆˆ</mo><msub><mi>â„³</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">i \in \mathcal{M}_s</annotation></semantics></math>,
we denote the binary outcome by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Y</mi><mi>i</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>âˆˆ</mo><mo stretchy="false" form="prefix">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">Y_i^{(s)} \in \{0,1\}</annotation></semantics></math>
and the model-based risk score by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>r</mi><mo accent="true">Ì‚</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>ğ™</mi><mi>i</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat r(\mathbf{Z}_i^{(s)})</annotation></semantics></math>,
where larger values indicate higher predicted risk. When
probability-based metrics are required, the risk score is transformed
into a predicted probability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mover><mi>p</mi><mo accent="true">Ì‚</mo></mover><mi>i</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">\hat p_i^{(s)}</annotation></semantics></math>
using an appropriate link function consistent with the fitted model.</p>
<p><strong>Predictive Deviance (<code>"loss"</code>)</strong></p>
<p>Goodness-of-fit assesses how well the fitted working model agrees
with the distribution of the held-out test data at the likelihood level,
conditional on the matched caseâ€“control design. Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>â€¦</mi><mo>,</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">s = 1,\ldots,S</annotation></semantics></math>
index matched sets, and let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>â„“</mo><mi>s</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>ğ›ƒ</mi><mo accent="true">Ì‚</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\ell_s(\widehat{\boldsymbol{\beta}})</annotation></semantics></math>
denote the conditional log-likelihood contribution of matched set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>
under the coefficient vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>ğ›ƒ</mi><mo accent="true">Ì‚</mo></mover><annotation encoding="application/x-tex">\widehat{\boldsymbol{\beta}}</annotation></semantics></math>.
Summing across matched sets yields the total conditional
log-likelihood</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â„“</mo><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>ğ›ƒ</mi><mo accent="true">Ì‚</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><mi>S</mi></munderover><msub><mo>â„“</mo><mi>s</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>ğ›ƒ</mi><mo accent="true">Ì‚</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
\ell(\widehat{\boldsymbol{\beta}})
=
\sum_{s=1}^S \ell_s(\widehat{\boldsymbol{\beta}}).
</annotation></semantics></math></p>
<p>We report a predictive deviance <span class="citation">(<strong>reid2014regularization?</strong>)</span>
defined as</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">D</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">v</mi></mrow><mo>=</mo><mi>âˆ’</mi><mfrac><mn>2</mn><mi>n</mi></mfrac><mspace width="0.167em"></mspace><mo>â„“</mo><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>ğ›ƒ</mi><mo accent="true">Ì‚</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
\mathrm{Dev}
=
-\frac{2}{n}\,\ell(\widehat{\boldsymbol{\beta}}),
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
denotes the total number of subjects in the test data. Smaller values
indicate better agreement between the fitted model and the observed
outcomes on held-out matched sets.</p>
<p><strong>Matched-set AUC (<code>"AUC"</code> or
<code>"CIndex"</code>)</strong></p>
<p>In matched caseâ€“control studies, each case is paired with one or more
controls according to predefined matching criteria, and model
discrimination is evaluated through comparisons restricted within
matched sets. We use matched-set AUC to evaluate the discrimination
ability <span class="citation">(Hanley and McNeil 1982)</span>. Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>â€¦</mi><mo>,</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">s = 1,\ldots,S</annotation></semantics></math>
index matched sets, and let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>â„³</mi><mi>s</mi></msub><annotation encoding="application/x-tex">\mathcal{M}_s</annotation></semantics></math>
denote the subjects in set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>,
which contains one case
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">Y_i=1</annotation></semantics></math>)
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
matched controls
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mi>j</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">Y_j=0</annotation></semantics></math>).
For each subject, we compute a risk score
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>r</mi><mo accent="true">Ì‚</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ™</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat r(\mathbf{Z}_i)</annotation></semantics></math>
from the fitted model.</p>
<p>Discrimination is assessed by the probability that the case in a
matched set receives a higher risk score than its matched controls.
Specifically, the matched-set AUC is defined as</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi mathvariant="normal">A</mi><mi mathvariant="normal">U</mi><mi mathvariant="normal">C</mi></mrow><mi>s</mi></msub><mo>=</mo><mi>P</mi><mspace width="-0.167em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>r</mi><mo accent="true">Ì‚</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ™</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>&gt;</mo><mover><mi>r</mi><mo accent="true">Ì‚</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ™</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">|</mo><mspace width="0.167em"></mspace><mi>i</mi><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> is the case in </mtext><mspace width="0.333em"></mspace></mrow><msub><mi>â„³</mi><mi>s</mi></msub><mo>,</mo><mspace width="0.222em"></mspace><mi>j</mi><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> is a control in </mtext><mspace width="0.333em"></mspace></mrow><msub><mi>â„³</mi><mi>s</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
\mathrm{AUC}_s
=
P\!\left(
\hat r(\mathbf{Z}_i) &gt; \hat r(\mathbf{Z}_j)
\,\big|\,
i \text{ is the case in } \mathcal{M}_s,\ 
j \text{ is a control in } \mathcal{M}_s
\right),
</annotation></semantics></math></p>
<p>which can be estimated using a rank-based U-statistic based on all
comparable caseâ€“control pairs within
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>â„³</mi><mi>s</mi></msub><annotation encoding="application/x-tex">\mathcal{M}_s</annotation></semantics></math>.</p>
<p>To summarize discrimination across all matched sets, we aggregate
set-specific AUCs using a weighted average,</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">A</mi><mi mathvariant="normal">U</mi><mi mathvariant="normal">C</mi></mrow><mo>=</mo><mfrac><mrow><munderover><mo>âˆ‘</mo><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><mi>S</mi></munderover><msub><mi>w</mi><mi>s</mi></msub><mspace width="0.167em"></mspace><msub><mover><mrow><mi mathvariant="normal">A</mi><mi mathvariant="normal">U</mi><mi mathvariant="normal">C</mi></mrow><mo accent="true">Ì‚</mo></mover><mi>s</mi></msub></mrow><mrow><munderover><mo>âˆ‘</mo><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><mi>S</mi></munderover><msub><mi>w</mi><mi>s</mi></msub></mrow></mfrac><mo>,</mo></mrow><annotation encoding="application/x-tex">
\mathrm{AUC}
=
\frac{\sum_{s=1}^S w_s \, \widehat{\mathrm{AUC}}_s}{\sum_{s=1}^S w_s},
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mi>s</mi></msub><annotation encoding="application/x-tex">w_s</annotation></semantics></math>
is proportional to the number of comparable pairs in set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>.
This criterion evaluates the modelâ€™s ability to correctly rank cases
above their matched controls and is fully determined by the matched
caseâ€“control structure, without reliance on prospective follow-up times,
censoring indicators, or estimation of a baseline hazard.</p>
<p>Nested caseâ€“control (NCC) studies arise as a special case of matched
caseâ€“control designs, where controls are sampled from the risk set at
each observed event time in an underlying cohort. Although the matching
mechanism is time-dependent in NCC studies, discrimination can be
evaluated using the same matched-set AUC defined above. In particular,
the resulting AUC is numerically equivalent to the concordance index
(<code>"CIndex"</code>) evaluated on the sampled risk sets, since each
matched set corresponds to a valid risk set at the event time and the
associated caseâ€“control comparisons coincide with concordance
comparisons in the Cox model.</p>
<p><strong>Brier Score (<code>"Brier"</code>)</strong></p>
<p>Calibration evaluates the agreement between predicted risks and
observed outcomes at the individual level. Under matched caseâ€“control
designs, where the outcome is binary and comparisons are conditioned on
matched sets, calibration can be assessed using the Brier score <span class="citation">(Glenn et al. 1950)</span>. Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Y</mi><mi>i</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>âˆˆ</mo><mo stretchy="false" form="prefix">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">Y_i^{(s)} \in \{0,1\}</annotation></semantics></math>
denote the caseâ€“control status of subject
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
in matched set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>,
and let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mover><mi>p</mi><mo accent="true">Ì‚</mo></mover><mi>i</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">\hat p_i^{(s)}</annotation></semantics></math>
denote the model-based predicted probability of being a case, obtained
by transforming the risk score
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>r</mi><mo accent="true">Ì‚</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>ğ™</mi><mi>i</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat r(\mathbf{Z}_i^{(s)})</annotation></semantics></math>
through an appropriate link function.</p>
<p>The Brier score is defined as the mean squared error between
predicted probabilities and observed outcomes,</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">B</mi><mi mathvariant="normal">S</mi></mrow><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>âˆ‘</mo><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><mi>S</mi></munderover><munder><mo>âˆ‘</mo><mrow><mi>i</mi><mo>âˆˆ</mo><msub><mi>â„³</mi><mi>s</mi></msub></mrow></munder><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>Y</mi><mi>i</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>âˆ’</mo><msubsup><mover><mi>p</mi><mo accent="true">Ì‚</mo></mover><mi>i</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>,</mo></mrow><annotation encoding="application/x-tex">
\mathrm{BS}
=
\frac{1}{n}
\sum_{s=1}^S
\sum_{i \in \mathcal{M}_s}
\left(
Y_i^{(s)} - \hat p_i^{(s)}
\right)^2,
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
denotes the total number of subjects in the test data. Smaller values of
the Brier score indicate better calibration and overall predictive
accuracy.</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="reference">Reference<a class="anchor" aria-label="anchor" href="#reference"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-glenn1950verification" class="csl-entry">
Glenn, W Brier et al. 1950. <span>â€œVerification of Forecasts Expressed
in Terms of Probability.â€</span> <em>Monthly Weather Review</em> 78 (1):
1â€“3.
</div>
<div id="ref-hanley1982meaning" class="csl-entry">
Hanley, James A, and Barbara J McNeil. 1982. <span>â€œThe Meaning and Use
of the Area Under a Receiver Operating Characteristic (ROC)
Curve.â€</span> <em>Radiology</em> 143 (1): 29â€“36.
</div>
<div id="ref-harrell1982evaluating" class="csl-entry">
Harrell, Frank E, Robert M Califf, David B Pryor, Kerry L Lee, and
Robert A Rosati. 1982. <span>â€œEvaluating the Yield of Medical
Tests.â€</span> <em>JAMA</em> 247 (18): 2543â€“46.
</div>
<div id="ref-simon2011regularization" class="csl-entry">
Simon, Noah, Jerome H Friedman, Trevor Hastie, and Rob Tibshirani. 2011.
<span>â€œRegularization Paths for Coxâ€™s Proportional Hazards Model via
Coordinate Descent.â€</span> <em>Journal of Statistical Software</em> 39:
1â€“13.
</div>
<div id="ref-verweij1993cross" class="csl-entry">
Verweij, Pierre JM, and Hans C Van Houwelingen. 1993.
<span>â€œCross-Validation in Survival Analysis.â€</span> <em>Statistics in
Medicine</em> 12 (24): 2305â€“14.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Yubo Shao.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
