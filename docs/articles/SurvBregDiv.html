<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>SurvBregDiv: Bregman Divergence Data Integration for Time-to-Event Modelling ‚Ä¢ SurvBregDiv</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="SurvBregDiv: Bregman Divergence Data Integration for Time-to-Event Modelling">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-54921687-5"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-54921687-5');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="inverse" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SurvBregDiv</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/SurvBregDiv.html">Get started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-appendix" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Appendix</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-appendix">
<li><a class="dropdown-item" href="../articles/CV_Criteria.html">CV Criteria</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/UM-KevinHe/SurvBregDiv" aria-label="GitHub repository"><span class="fa fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>SurvBregDiv: Bregman Divergence Data Integration for Time-to-Event Modelling</h1>
            
      

      <div class="d-none name"><code>SurvBregDiv.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="sec-intro">1. Introduction<a class="anchor" aria-label="anchor" href="#sec-intro"></a>
</h2>
<p>Accurate prognostic modeling is a central goal in survival analysis.
The rapid expansion of large-scale biobank initiatives‚Äîwith rich
genetic, molecular, imaging, and electronic health record data‚Äîhas
created new opportunities to improve predictive performance in clinical
and epidemiologic research. However, these datasets often exhibit
limited effective sample sizes, high dimensionality, low signal-to-noise
ratios, and additional practical constraints including privacy
considerations and restricted data access.</p>
<p>Integrating external information offers a principled strategy for
improving model efficiency. Yet, classical data-integration methods
typically rely on the assumption that multiple datasets arise from a
common data-generating mechanism. In modern biomedical applications,
this assumption is rarely satisfied. Misspecification due to population
heterogeneity can induce substantial bias, motivating the development of
transfer-learning approaches that explicitly accommodate between-source
discrepancies.</p>
<p>While Bregman divergence has been successfully applied to borrowing
information in binary-outcome settings, extending such ideas to censored
time-to-event outcomes is nontrivial due to right censoring and the
limited nature of available external survival information (e.g.,
predicted risk scores, fitted regression coefficients, or hazard ratios
without access to a baseline hazard).</p>
<p>Beyond full-cohort survival studies, many biomedical investigations
rely on the nested case‚Äìcontrol (NCC) design to alleviate the burden of
labor-intensive measurements, high-cost data acquisition, and
destructive or finite biospecimen assays. Under an NCC design, only a
small number of matched controls are sampled at each failure time,
producing survival data that are analyzed through conditional logistic
regression applied to matched risk sets. Despite its practical
relevance, no existing methodology or software supports transfer
learning or external information borrowing under NCC designs.</p>
<p>The <code>SurvBregDiv</code> package addresses these challenges by
providing a unified Bregman Divergence transfer-learning framework for
both full-cohort Cox data and nested case‚Äìcontrol designs. The methods
integrate external information in a privacy-preserving manner and are
applicable to both low-dimensional settings and high-dimensional
variable selection with ridge, lasso, and elastic net penalties.</p>
<div class="section level3">
<h3 id="key-features">Key Features<a class="anchor" aria-label="anchor" href="#key-features"></a>
</h3>
<ul>
<li><p><strong>Transfer learning via Bregman Divergence</strong><br>
Integrates external information through Bregman divergence‚Äìbased
penalization, enabling adaptive borrowing from heterogeneous data
sources.</p></li>
<li><p><strong>Flexible external information formats</strong><br>
Supports incorporation of external information provided either as
individual-level data or as summary-level inputs, such as regression
coefficients, risk scores, or information defined on partially
overlapping covariate sets.</p></li>
<li><p><strong>Privacy-preserving external information
use</strong><br>
Allow summary-level external inputs‚Äîsuch as fitted coefficients or risk
scores‚Äîwithout requiring individual-level external data access.</p></li>
<li><p><strong>Heterogeneity-aware borrowing</strong><br>
Accommodates population differences through tuning-parameter‚Äìcontrolled
shrinkage, selectively borrowing strength only when sources are
compatible.</p></li>
<li><p><strong>High-dimensional modeling with
regularization</strong><br>
Supports penalized KL-integrated models, including ridge, lasso, and
elastic net penalties for variable selection and shrinkage.</p></li>
</ul>
<p>This vignette introduces the core functionalities of
<code>SurvBregDiv</code> and illustrates workflows for both low- and
high-dimensional applications.</p>
</div>
</div>
<div class="section level2">
<h2 id="usage-tutorial">2. Usage Tutorial<a class="anchor" aria-label="anchor" href="#usage-tutorial"></a>
</h2>
<p>In this tutorial, we provide a practical guide to using our
integration software, including model fitting, hyperparameter tuning,
visualization, and etc.</p>
<p>The software supports coefficient estimation for low-dimensional
settings and variable selection for high-dimensional settings. We use
the example datasets included in the software to illustrate how each
approach can be applied.</p>
<ul>
<li><p>For Cox proportional hazards model data integration, please refer
to Section <a href="#sec_cox">Cox Proportional Hazards Model Data
Integration</a> for details;</p></li>
<li><p>For (nested) case-control designs, see Section <a href="#sec_cc">(Nested) Case-Control Data Integration</a> for
details.</p></li>
</ul>
<div class="section level3">
<h3 id="installation">2.1 Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<p>You can install the software from CRAN:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"SurvBregDiv"</span><span class="op">)</span></span></code></pre></div>
<p>Or install the development version of <code>SurvBregDiv</code> from
GitHub:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://remotes.r-lib.org" class="external-link">remotes</a></span><span class="op">)</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"UM-KevinHe/SurvBregDiv"</span>, ref <span class="op">=</span> <span class="st">"main"</span><span class="op">)</span></span></code></pre></div>
<p>Additional options refer to <code><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">help(install.packages)</a></code>.</p>
<p>We load the package by:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://um-kevinhe.github.io/SurvBregDiv/">SurvBregDiv</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="sec_cox">2.2 Cox Proportional hazards model<a class="anchor" aria-label="anchor" href="#sec_cox"></a>
</h3>
<p>Depending on the type of external data available, the framework
supports three broad methodological settings, each implemented through a
corresponding set of functions:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Individual-level external data available.</strong> When
individual-level external data are accessible (e.g., for time-to-event
outcomes, the user has covariates, survival outcomes, and follow-up
times from an external cohort), the software provides the function such
as <code><a href="../reference/cox_indi.html">cox_indi()</a></code> and related downstream utilities. These
functions implement data integration through a weighted
pseudo-likelihood framework <span class="citation">(Wang and Zidek 2005;
Gao and Carroll 2017)</span>. Details can be found in <a href="#sec_indi">Individual-Level External Data
Integration</a>.</p></li>
<li><p><strong>Only summary-level regression estimates
available.</strong> If, due to practical or regulatory constraints, the
external source can provide only summary-level estimated regression
coefficients
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>ùõÉ</mi><mo accent="true">ÃÉ</mo></mover><annotation encoding="application/x-tex">\widetilde{\boldsymbol{\beta}}</annotation></semantics></math>,
the user can perform data integration via the Kullback‚ÄìLeibler
divergence. Details can be found in Section <a href="#sec_coxkl">Kullback‚ÄìLeibler Divergence Data
Integration</a>.</p></li>
<li><p><strong>Regression estimates plus curvature information
available.</strong> If, in addition to estimated external regression
coefficients, the user can also provide a positive semidefinite matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùêÄ</mi><annotation encoding="application/x-tex">\mathbf{A}</annotation></semantics></math>
summarizing the curvature of the external objective function (e.g., an
information matrix, a variance‚Äìcovariance matrix, or variance
information only), the user can perform data integration via the
quadratic Mahalanobis distance. Details can be found in Section <a href="#sec_coxmaha">Mahalanobis Distance Data Integration</a>.</p></li>
</ol>
<div class="section level4">
<h4 id="sec_indi">2.2.1 Individual-Level External Data Integration<a class="anchor" aria-label="anchor" href="#sec_indi"></a>
</h4>
<p>When individual-level data are available for both the internal and
external cohorts, the function <code><a href="../reference/cox_indi.html">cox_indi()</a></code> fits a Cox
proportional hazards model that integrates information from both
datasets via a weighted pseudo-likelihood approach. To use this
integration approach, the user must provide at least the covariate
matrices, event indicators, and event time for both internal and
external cohort.</p>
<p>We provide a toy example to illustrate the use of the software based
on the built-in dataset <code>ExampleData_indi</code>. This dataset
contains example time-to-event data from both internal and external
sources, including the covariate matrices, stratum information, event
indicators, and event times.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ExampleData_indi</span><span class="op">)</span></span>
<span></span>
<span><span class="va">z_int</span>       <span class="op">&lt;-</span> <span class="va">ExampleData_indi</span><span class="op">$</span><span class="va">internal</span><span class="op">$</span><span class="va">z</span></span>
<span><span class="va">delta_int</span>   <span class="op">&lt;-</span> <span class="va">ExampleData_indi</span><span class="op">$</span><span class="va">internal</span><span class="op">$</span><span class="va">status</span></span>
<span><span class="va">time_int</span>    <span class="op">&lt;-</span> <span class="va">ExampleData_indi</span><span class="op">$</span><span class="va">internal</span><span class="op">$</span><span class="va">time</span></span>
<span><span class="va">stratum_int</span> <span class="op">&lt;-</span> <span class="va">ExampleData_indi</span><span class="op">$</span><span class="va">internal</span><span class="op">$</span><span class="va">stratum</span></span>
<span></span>
<span><span class="va">z_ext</span>       <span class="op">&lt;-</span> <span class="va">ExampleData_indi</span><span class="op">$</span><span class="va">external</span><span class="op">$</span><span class="va">z</span></span>
<span><span class="va">delta_ext</span>   <span class="op">&lt;-</span> <span class="va">ExampleData_indi</span><span class="op">$</span><span class="va">external</span><span class="op">$</span><span class="va">status</span></span>
<span><span class="va">time_ext</span>    <span class="op">&lt;-</span> <span class="va">ExampleData_indi</span><span class="op">$</span><span class="va">external</span><span class="op">$</span><span class="va">time</span></span>
<span><span class="va">stratum_ext</span> <span class="op">&lt;-</span> <span class="va">ExampleData_indi</span><span class="op">$</span><span class="va">external</span><span class="op">$</span><span class="va">stratum</span></span></code></pre></div>
<p>The function <code><a href="../reference/cox_indi.html">cox_indi()</a></code> fits a sequence of weighted
stratified Cox models that integrate the internal and external datasets
through a list of integration weights
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>,
which governs the degree of information borrowing (via function argument
<code>etas</code>):</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
= 0 corresponds to the standard Cox model with no external contribution,
and<br>
</li>
<li>larger values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
increasingly pull the estimated coefficients toward the external
information.</li>
</ul>
<p>The user should rely on prior knowledge or problem-specific
considerations to determine an appropriate range of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>‚Äôs.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eta_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_eta.html">generate_eta</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"exponential"</span>, n <span class="op">=</span> <span class="fl">50</span>, max_eta <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit.cox_indi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cox_indi.html">cox_indi</a></span><span class="op">(</span></span>
<span>  z_int <span class="op">=</span> <span class="va">z_int</span>,</span>
<span>  delta_int <span class="op">=</span> <span class="va">delta_int</span>,</span>
<span>  time_int <span class="op">=</span> <span class="va">time_int</span>,</span>
<span>  stratum_int <span class="op">=</span> <span class="va">stratum_int</span>,</span>
<span>  z_ext <span class="op">=</span> <span class="va">z_ext</span>,</span>
<span>  delta_ext <span class="op">=</span> <span class="va">delta_ext</span>,</span>
<span>  time_ext <span class="op">=</span> <span class="va">time_ext</span>,</span>
<span>  stratum_ext <span class="op">=</span> <span class="va">stratum_ext</span>,</span>
<span>  etas <span class="op">=</span> <span class="va">eta_list</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>For hyperparameter tuning of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>,
we aim to select the value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
that yields the best predictive performance. We adopt cross-validation
and consider four criteria: two based on Harrell‚Äôs C-index <span class="citation">(Harrell et al. 1982)</span>‚Äî<code>CIndex_pooled</code>
and <code>CIndex_foldaverage</code>‚Äîand two loss-based
criteria‚Äî<code>LinPred</code> and <code>V&amp;VH</code>. For details,
please refer to Page: <em>Appendix: CV Criteria</em>.</p>
<p>We provide an example illustrating the use of the cross-validation
function <code><a href="../reference/cv.cox_indi.html">cv.cox_indi()</a></code> under the <code>V&amp;VH</code>
criterion.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cvfit.cox_indi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv.cox_indi.html">cv.cox_indi</a></span><span class="op">(</span></span>
<span>  z_int <span class="op">=</span> <span class="va">z_int</span>,</span>
<span>  delta_int <span class="op">=</span> <span class="va">delta_int</span>,</span>
<span>  time_int <span class="op">=</span> <span class="va">time_int</span>,</span>
<span>  stratum_int <span class="op">=</span> <span class="va">stratum_int</span>,</span>
<span>  z_ext <span class="op">=</span> <span class="va">z_ext</span>,</span>
<span>  delta_ext <span class="op">=</span> <span class="va">delta_ext</span>,</span>
<span>  time_ext <span class="op">=</span> <span class="va">time_ext</span>,</span>
<span>  stratum_ext <span class="op">=</span> <span class="va">stratum_ext</span>,</span>
<span>  etas <span class="op">=</span> <span class="va">eta_list</span>,</span>
<span>  nfolds <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  criteria <span class="op">=</span> <span class="st">"V&amp;VH"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="sec_coxkl">2.2.2 Kullback‚ÄìLeibler Divergence Data Integration<a class="anchor" aria-label="anchor" href="#sec_coxkl"></a>
</h4>
<p>Due to practical or regulatory constraints, only summary-level
information may be available from the external source, typically in the
form of estimated regression coefficients
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>ùõÉ</mi><mo accent="true">ÃÉ</mo></mover><annotation encoding="application/x-tex">\widetilde{\boldsymbol{\beta}}</annotation></semantics></math>
or an external risk score
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Z</mi><mi>‚ä§</mi></msup><mover><mi>ùõÉ</mi><mo accent="true">ÃÉ</mo></mover></mrow><annotation encoding="application/x-tex">Z^{\top}\widetilde{\boldsymbol{\beta}}</annotation></semantics></math>.
In such cases, data integration can be carried out through a
Kullback‚ÄìLeibler divergence formulation. The minimal input required for
this approach is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>ùõÉ</mi><mo accent="true">ÃÉ</mo></mover><annotation encoding="application/x-tex">\widetilde{\boldsymbol{\beta}}</annotation></semantics></math>,
corresponding to the coefficient estimates obtained from the external
model, or the external risk score.</p>
<p>We present the usage of the functions for <a href="#sec_coxkl_low">low-dimensional</a> and <a href="#sec_coxkl_high">high-dimensional</a> settings separately.</p>
<div class="section level5">
<h5 id="sec_coxkl_low">Low-Dimensional Integration<a class="anchor" aria-label="anchor" href="#sec_coxkl_low"></a>
</h5>
<p>We begin with <strong>low-dimensional</strong> settings, where the
number of predictors is modest. Similarly, we provide a built-in
low-dimensional simulated dataset <code>ExampleData_lowdim</code>, which
consists of a training set (100 samples) and a test set (2000 samples)
with six predictors. We first extract the training components:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ExampleData_lowdim</span><span class="op">)</span></span>
<span></span>
<span><span class="va">train</span>  <span class="op">&lt;-</span> <span class="va">ExampleData_lowdim</span><span class="op">$</span><span class="va">train</span></span>
<span><span class="va">test</span>   <span class="op">&lt;-</span> <span class="va">ExampleData_lowdim</span><span class="op">$</span><span class="va">test</span></span>
<span></span>
<span><span class="va">z</span>      <span class="op">&lt;-</span> <span class="va">train</span><span class="op">$</span><span class="va">z</span></span>
<span><span class="va">delta</span>  <span class="op">&lt;-</span> <span class="va">train</span><span class="op">$</span><span class="va">status</span></span>
<span><span class="va">time</span>   <span class="op">&lt;-</span> <span class="va">train</span><span class="op">$</span><span class="va">time</span></span>
<span><span class="va">strat</span>  <span class="op">&lt;-</span> <span class="va">train</span><span class="op">$</span><span class="va">stratum</span></span></code></pre></div>
<p>The corresponding built-in external regression coefficients
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>ùõÉ</mi><mo accent="true">ÃÉ</mo></mover><annotation encoding="application/x-tex">\widetilde{\boldsymbol{\beta}}</annotation></semantics></math>
can be obtained as follows:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">beta_ext</span> <span class="op">&lt;-</span> <span class="va">ExampleData_lowdim</span><span class="op">$</span><span class="va">beta_external_fair</span></span></code></pre></div>
<p>To fit the KL divergence‚Äìbased integrated model, we first generate a
suitable range of integration weights
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
using the function <code><a href="../reference/generate_eta.html">generate_eta()</a></code>. The user should rely on
prior knowledge or problem-specific considerations to determine an
appropriate range. We then use the function <code><a href="../reference/coxkl.html">coxkl()</a></code> to fit
the model. The external regression coefficient
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>ùõÉ</mi><mo accent="true">ÃÉ</mo></mover><annotation encoding="application/x-tex">\widetilde{\boldsymbol{\beta}}</annotation></semantics></math>
is supplied to the function through the argument
<code>beta =</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eta_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_eta.html">generate_eta</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"exponential"</span>, n <span class="op">=</span> <span class="fl">50</span>, max_eta <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit.coxkl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/coxkl.html">coxkl</a></span><span class="op">(</span></span>
<span>  z <span class="op">=</span> <span class="va">z</span>,</span>
<span>  delta <span class="op">=</span> <span class="va">delta</span>,</span>
<span>  time <span class="op">=</span> <span class="va">time</span>,</span>
<span>  stratum <span class="op">=</span> <span class="va">strat</span>,</span>
<span>  beta <span class="op">=</span> <span class="va">beta_ext</span>,</span>
<span>  etas <span class="op">=</span> <span class="va">eta_list</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Alternatively, instead of providing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>ùõÉ</mi><mo accent="true">ÃÉ</mo></mover><annotation encoding="application/x-tex">\widetilde{\boldsymbol{\beta}}</annotation></semantics></math>,
users may supply an external risk score vector via the argument
<code>RS =</code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">RS_ext</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">beta_ext</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit.coxkl.RS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/coxkl.html">coxkl</a></span><span class="op">(</span></span>
<span>  z <span class="op">=</span> <span class="va">z</span>,</span>
<span>  delta <span class="op">=</span> <span class="va">delta</span>,</span>
<span>  time <span class="op">=</span> <span class="va">time</span>,</span>
<span>  stratum <span class="op">=</span> <span class="va">strat</span>,</span>
<span>  RS <span class="op">=</span> <span class="va">RS_ext</span>,</span>
<span>  etas <span class="op">=</span> <span class="va">eta_list</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The function <code><a href="../reference/cv.coxkl.html">cv.coxkl()</a></code> performs
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>-fold
cross-validation (default
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>=</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">K = 5</annotation></semantics></math>)
to select the integration parameter in the KL-integrated Cox model. We
consider four criteria: two based on Harrell‚Äôs C-index <span class="citation">(Harrell et al. 1982)</span>‚Äî<code>CIndex_pooled</code>
and <code>CIndex_foldaverage</code>‚Äîand two loss-based
criteria‚Äî<code>LinPred</code> and <code>V&amp;VH</code>. For details,
please refer to Page: <em>Appendix: CV Criteria</em>. Below is an
example using the default <code>"V&amp;VH"</code> criterion:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cvfit.coxkl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv.coxkl.html">cv.coxkl</a></span><span class="op">(</span></span>
<span>  z <span class="op">=</span> <span class="va">z</span>,</span>
<span>  delta <span class="op">=</span> <span class="va">delta</span>,</span>
<span>  time <span class="op">=</span> <span class="va">time</span>,</span>
<span>  stratum <span class="op">=</span> <span class="va">strat</span>,</span>
<span>  beta <span class="op">=</span> <span class="va">beta_ext</span>,</span>
<span>  etas <span class="op">=</span> <span class="va">eta_list</span>,</span>
<span>  nfolds <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  criteria <span class="op">=</span> <span class="st">"V&amp;VH"</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>The cross-validated performance curve from hyperparameter tuning
functions <code><a href="../reference/cv.coxkl.html">cv.coxkl()</a></code> can be visualized directly using
<code><a href="../reference/cv.plot.html">cv.plot()</a></code>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cv.plot.html">cv.plot</a></span><span class="op">(</span><span class="va">cvfit.coxkl</span><span class="op">)</span></span></code></pre></div>
<p><img src="SurvBregDiv_files/figure-html/unnamed-chunk-13-1.png" class="r-plt" alt="Plot generated in survkl vignette" width="700"></p>
<ul>
<li>The solid purple curve displays the cross-validated loss across
different values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>.</li>
<li>The green dotted horizontal line marks the internal baseline at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
= 0, representing the model that does not incorporate external
information.</li>
<li>The vertical dashed orange line indicates the optimal
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
value, where the cross-validated loss is minimized.</li>
</ul>
<p>A comparison between the purple curve and the green baseline shows
whether borrowing external information improves prediction performance.
Whenever the purple curve falls below the green line, using external
information
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
&gt; 0) yields better predictive accuracy than relying solely on the
internal model.</p>
<p>For datasets containing <strong>tied</strong> event times, users can
apply the <code><a href="../reference/coxkl_ties.html">coxkl_ties()</a></code> and <code><a href="../reference/cv.coxkl_ties.html">cv.coxkl_ties()</a></code>
function, which extends the KL integrated Cox model to explicitly
accommodate ties. The function allows users to choose between the
‚Äúbreslow‚Äù <span class="citation">(Breslow 1974)</span> and ‚Äúexact‚Äù <span class="citation">(Cox 1972)</span> methods for tie handling. The Breslow
method provides a computationally efficient approximation and is
generally suitable when the number of tied events is moderate, whereas
the exact method yields more accurate inference in the presence of
extensive ties at the cost of increased computational burden. The
following example demonstrates the use of the Breslow method.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">time_ties</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">time</span>, <span class="fl">2</span><span class="op">)</span>   <span class="co"># Rounding time introduces ties for demonstration</span></span>
<span></span>
<span><span class="va">fit.coxkl.ties</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/coxkl_ties.html">coxkl_ties</a></span><span class="op">(</span></span>
<span>  z <span class="op">=</span> <span class="va">z</span>,</span>
<span>  delta <span class="op">=</span> <span class="va">delta</span>,</span>
<span>  time <span class="op">=</span> <span class="va">time_ties</span>,</span>
<span>  stratum <span class="op">=</span> <span class="va">strat</span>,</span>
<span>  beta <span class="op">=</span> <span class="va">beta_ext</span>,</span>
<span>  etas <span class="op">=</span> <span class="va">eta_list</span>,</span>
<span>  ties <span class="op">=</span> <span class="st">"breslow"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="sec_coxkl_high">High-Dimensional Integration<a class="anchor" aria-label="anchor" href="#sec_coxkl_high"></a>
</h5>
<p>In high-dimensional regimes‚Äîsuch as when the number of predictors is
comparable to or exceeds the sample size‚Äîthe <code>SurvBregDiv</code>
package extends KL divergence‚Äìintegrated Cox modeling with
regularization.</p>
<p>Two families of penalties are implemented:</p>
<ul>
<li>
<strong>Ridge penalty
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mo>‚Ñì</mo><mn>2</mn></msub><annotation encoding="application/x-tex">\ell_2</annotation></semantics></math>)</strong>,
via <code><a href="../reference/coxkl_ridge.html">coxkl_ridge()</a></code> and related downstream functions, which
shrinks coefficients toward zero while yielding dense solutions.</li>
<li>
<strong>LASSO penalty
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mo>‚Ñì</mo><mn>1</mn></msub><annotation encoding="application/x-tex">\ell_1</annotation></semantics></math>)</strong>
and <strong>Elastic net penalty (a mixture of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mo>‚Ñì</mo><mn>1</mn></msub><annotation encoding="application/x-tex">\ell_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mo>‚Ñì</mo><mn>2</mn></msub><annotation encoding="application/x-tex">\ell_2</annotation></semantics></math>)</strong>,
via <code><a href="../reference/coxkl_enet.html">coxkl_enet()</a></code> and related downstream functions, to
enable sparse variable selection.</li>
</ul>
<p>In addition to the integration weight
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>,
which determines the extent of information borrowed from external
sources, the high-dimensional functions involve a <strong>regularization
parameter</strong>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œª</mi><mo>‚â•</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\lambda \ge 0</annotation></semantics></math>
that governs the strength of regularization. The parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ±</mi><mo>‚àà</mo><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\alpha \in [0,1]</annotation></semantics></math>
is a mixing coefficient that controls the relative contribution of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mo>‚Ñì</mo><mn>1</mn></msub><annotation encoding="application/x-tex">\ell_1</annotation></semantics></math>
(LASSO) and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mo>‚Ñì</mo><mn>2</mn></msub><annotation encoding="application/x-tex">\ell_2</annotation></semantics></math>
(Ridge) components.</p>
<p>The built-in high-dimensional simulated dataset
<code>ExampleData_highdim</code> contains a training set (200 samples)
and a test set (2000 samples). The dataset includes 50 predictors
(<code>Z1</code>‚Äì<code>Z50</code>), of which 6 are signal variables and
the remaining 44 are AR(1) noise variables. Externally derived
coefficients are provided in <code>beta_external</code>:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ExampleData_highdim</span><span class="op">)</span></span>
<span></span>
<span><span class="va">train_hd</span>  <span class="op">&lt;-</span> <span class="va">ExampleData_highdim</span><span class="op">$</span><span class="va">train</span></span>
<span><span class="va">test_hd</span>   <span class="op">&lt;-</span> <span class="va">ExampleData_highdim</span><span class="op">$</span><span class="va">test</span></span>
<span></span>
<span><span class="va">z_hd</span>      <span class="op">&lt;-</span> <span class="va">train_hd</span><span class="op">$</span><span class="va">z</span></span>
<span><span class="va">delta_hd</span>  <span class="op">&lt;-</span> <span class="va">train_hd</span><span class="op">$</span><span class="va">status</span></span>
<span><span class="va">time_hd</span>   <span class="op">&lt;-</span> <span class="va">train_hd</span><span class="op">$</span><span class="va">time</span></span>
<span><span class="va">strat_hd</span>  <span class="op">&lt;-</span> <span class="va">train_hd</span><span class="op">$</span><span class="va">stratum</span></span>
<span></span>
<span><span class="va">beta_external_hd</span> <span class="op">&lt;-</span> <span class="va">ExampleData_highdim</span><span class="op">$</span><span class="va">beta_external</span></span></code></pre></div>
<p>The function <code><a href="../reference/coxkl_ridge.html">coxkl_ridge()</a></code> fits a KL-integrated Cox
model with a Ridge (L2) penalty on all predictors. External information
is incorporated through a KL-based integration term weighted by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
(a user-specified scalar), while regularization is imposed through a
sequence of tuning parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œª</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>.
If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œª</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
is not provided, the function automatically generates a decreasing
lambda path.</p>
<p>We begin by fitting a KL‚Äìridge model for a fixed integration weight
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
using an automatically generated lambda sequence:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.coxkl_ridge</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/coxkl_ridge.html">coxkl_ridge</a></span><span class="op">(</span></span>
<span>  z        <span class="op">=</span> <span class="va">z_hd</span>,</span>
<span>  delta    <span class="op">=</span> <span class="va">delta_hd</span>,</span>
<span>  time     <span class="op">=</span> <span class="va">time_hd</span>,</span>
<span>  stratum  <span class="op">=</span> <span class="va">strat_hd</span>,</span>
<span>  beta     <span class="op">=</span> <span class="va">beta_external_hd</span>,</span>
<span>  eta      <span class="op">=</span> <span class="fl">1</span>                 </span>
<span><span class="op">)</span></span></code></pre></div>
<p>The fitted object stores, for each value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œª</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>:</p>
<ul>
<li>
<code>$lambda</code> ‚Äî the sequence of lambda values (in decreasing
order),</li>
<li>
<code>$beta</code> ‚Äî estimated coefficients (one column per
lambda),</li>
<li>
<code>$linear.predictors</code> ‚Äî linear predictors for all
observations across the lambda path,</li>
<li>
<code>$likelihood</code> ‚Äî partial log-likelihood along the lambda
path,</li>
<li>
<code>$data</code> ‚Äî the data used for fitting.</li>
</ul>
<p>The function <code><a href="../reference/coxkl_enet.html">coxkl_enet()</a></code> fits a KL-integrated Cox model
with an elastic-net penalty, controlled by the mixing parameter
<code>alpha</code>. When <code>alpha = 1</code>, the penalty reduces to
<em>LASSO</em>, introducing coefficient sparsity in addition to KL-based
integration of external information. Similar, the penalty parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œª</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
controls sparsity. If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œª</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
is not provided, the function automatically generates a decreasing
lambda sequence.</p>
<p>Below, we illustrate the workflow using the <em>LASSO</em> special
case (<code>alpha = 1</code>) with an automatically generated lambda
path:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.coxkl_LASSO</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/coxkl_enet.html">coxkl_enet</a></span><span class="op">(</span></span>
<span>  z        <span class="op">=</span> <span class="va">z_hd</span>,</span>
<span>  delta    <span class="op">=</span> <span class="va">delta_hd</span>,</span>
<span>  time     <span class="op">=</span> <span class="va">time_hd</span>,</span>
<span>  stratum  <span class="op">=</span> <span class="va">strat_hd</span>,</span>
<span>  beta     <span class="op">=</span> <span class="va">beta_external_hd</span>,   </span>
<span>  eta      <span class="op">=</span> <span class="fl">1</span>,                 </span>
<span>  alpha    <span class="op">=</span> <span class="fl">1</span>                  <span class="co"># LASSO penalty</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The fitted object stores, for each lambda value:</p>
<ul>
<li>
<code>$lambda</code> ‚Äî the lambda sequence (in decreasing
order),</li>
<li>
<code>$beta</code> ‚Äî estimated coefficients (one column per
lambda),</li>
<li>
<code>$likelihood</code> ‚Äî partial log-likelihood along the lambda
path,</li>
<li>
<code>$data</code> ‚Äî the data used for fitting.</li>
</ul>
<p>Objects from <code><a href="../reference/coxkl_ridge.html">coxkl_ridge()</a></code> or <code><a href="../reference/coxkl_enet.html">coxkl_enet()</a></code>
functions can be visualized using the S3 plotting method
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>:</p>
<p>This plots (at given
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>):</p>
<ul>
<li>Loss or C-index versus the penalty parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œª</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>,</li>
<li>x-axis on a reversed log10 scale (larger penalties on the left,
smaller penalties on the right),</li>
<li>y-axis labeled as loss or C-index,.</li>
<li>A vertical dashed orange line marks the optimal value of Œª, where
the loss reaches its minimum on the evaluated grid.</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">fit.coxkl_LASSO</span>,</span>
<span>  test_z       <span class="op">=</span> <span class="va">test_hd</span><span class="op">$</span><span class="va">z</span>,</span>
<span>  test_time    <span class="op">=</span> <span class="va">test_hd</span><span class="op">$</span><span class="va">time</span>,</span>
<span>  test_delta   <span class="op">=</span> <span class="va">test_hd</span><span class="op">$</span><span class="va">status</span>,</span>
<span>  test_stratum <span class="op">=</span> <span class="va">test_hd</span><span class="op">$</span><span class="va">stratum</span>,</span>
<span>  criteria     <span class="op">=</span> <span class="st">"loss"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="SurvBregDiv_files/figure-html/unnamed-chunk-18-1.png" class="r-plt" alt="Plot generated in survkl vignette" width="700"></p>
<p>For penalized KL-integrated models, the functions
<code><a href="../reference/cv.coxkl_ridge.html">cv.coxkl_ridge()</a></code> and <code><a href="../reference/cv.coxkl_enet.html">cv.coxkl_enet()</a></code> perform
K-fold cross-validation to tune the integration parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>,
while internally scanning over a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œª</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
path for each candidate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>.
For each value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>,
the cross-validation procedure:</p>
<ul>
<li>evaluates a sequence of ridge or elastic-net penalties
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œª</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>,</li>
<li>computes the chosen cross-validation criterion on the held-out
folds,</li>
<li>selects the best
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œª</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
for that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>,</li>
<li>aggregates the performance across folds into summary tables.</li>
</ul>
<p>The supported criteria also include two based on Harrell‚Äôs C-index
<span class="citation">(Harrell et al.
1982)</span>‚Äî<code>CIndex_pooled</code> and
<code>CIndex_foldaverage</code>‚Äîand two loss-based
criteria‚Äî<code>LinPred</code> and <code>V&amp;VH</code>. For details,
please refer to Page: <em>Appendix: CV Criteria</em>.</p>
<p>Below we demonstrate tuning
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
using 5-fold cross-validation and the <code>V&amp;VH</code> criterion
for the LASSO-penalized integrated model (<code>alpha = 1</code>). The
range of integration weights
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
can be generated by using the function <code><a href="../reference/generate_eta.html">generate_eta()</a></code>. The
user should rely on prior knowledge or problem-specific considerations
to determine an appropriate range. (For ridge, use
<code><a href="../reference/cv.coxkl_ridge.html">cv.coxkl_ridge()</a></code> analogously.)</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eta_grid_hd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_eta.html">generate_eta</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"exponential"</span>, n <span class="op">=</span> <span class="fl">50</span>, max_eta <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cvfit.coxkl_LASSO</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv.coxkl_enet.html">cv.coxkl_enet</a></span><span class="op">(</span></span>
<span>  z <span class="op">=</span> <span class="va">z_hd</span>,</span>
<span>  delta <span class="op">=</span> <span class="va">delta_hd</span>,</span>
<span>  time <span class="op">=</span> <span class="va">time_hd</span>,</span>
<span>  stratum <span class="op">=</span> <span class="va">strat_hd</span>,</span>
<span>  beta <span class="op">=</span> <span class="va">beta_external_hd</span>,</span>
<span>  etas <span class="op">=</span> <span class="va">eta_grid_hd</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">1</span>, <span class="co"># LASSO</span></span>
<span>  nfolds <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  cv.criteria <span class="op">=</span> <span class="st">"V&amp;VH"</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The best
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œª</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
for each
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
(according to the chosen criterion) is provided by:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cvfit.coxkl_LASSO</span><span class="op">$</span><span class="va">integrated_stat.best_per_eta</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          eta     lambda     Loss</span></span>
<span><span class="co">## 1 0.00000000 0.10193604 2.842157</span></span>
<span><span class="co">## 2 0.09953651 0.09773006 2.840152</span></span>
<span><span class="co">## 3 0.20888146 0.09390799 2.838419</span></span>
<span><span class="co">## 4 0.32900138 0.02575599 2.829181</span></span>
<span><span class="co">## 5 0.46095806 0.02161908 2.817568</span></span>
<span><span class="co">## 6 0.60591790 0.01818471 2.806310</span></span></code></pre>
<p>The helper function <code><a href="../reference/cv.plot.html">cv.plot()</a></code> can be used to visualize
performance versus
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cv.plot.html">cv.plot</a></span><span class="op">(</span><span class="va">cvfit.coxkl_LASSO</span><span class="op">)</span></span></code></pre></div>
<p><img src="SurvBregDiv_files/figure-html/unnamed-chunk-21-1.png" class="r-plt" alt="Plot generated in survkl vignette" width="700"></p>
<p>The resulting plot displays:</p>
<ul>
<li>a purple curve showing the cross-validated performance across the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
sequence (loss or C-index),</li>
<li>a green dotted horizontal line indicating the internal baseline at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
= 0,</li>
<li>a green point marking the baseline performance,</li>
<li>and a vertical dashed orange line denoting the optimal
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>,
where the cross-validated loss attains its minimum.</li>
</ul>
</div>
<div class="section level5">
<h5 id="sec_var_importance">Variable Importance and Stability Selection<a class="anchor" aria-label="anchor" href="#sec_var_importance"></a>
</h5>
<p>For high-dimensional integrated models, users are often interested in
identifying predictors that are selected in a stable and reproducible
manner under regularization. The function
<code><a href="../reference/variable_importance.html">variable_importance()</a></code> assesses variable importance using a
bootstrap-based refitting strategy applied to the integrated LASSO or
elastic-net models fitted by <code>cv.coxkl_enet</code>. Specifically,
the model is repeatedly refit on bootstrap resamples of the data, and a
predictor is recorded as selected if its estimated coefficient is
nonzero in the cross-validated optimal model. The resulting importance
score for each variable is defined as its selection frequency across
bootstrap replications.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">imp.coxkl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/variable_importance.html">variable_importance</a></span><span class="op">(</span></span>
<span>  z <span class="op">=</span> <span class="va">z_hd</span>,</span>
<span>  delta <span class="op">=</span> <span class="va">delta_hd</span>,</span>
<span>  time <span class="op">=</span> <span class="va">time_hd</span>,</span>
<span>  stratum <span class="op">=</span> <span class="va">strat_hd</span>,</span>
<span>  beta <span class="op">=</span> <span class="va">beta_external_hd</span>,</span>
<span>  etas <span class="op">=</span> <span class="va">eta_grid_hd</span>,  </span>
<span>  B <span class="op">=</span> <span class="fl">50</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>After computing variable importance based on bootstrap selection
frequencies, users can further call the generic <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>
method to visualize the relative importance of predictors. The
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method displays selection frequencies ordered from
highest to lowest, allowing users to easily identify variables that are
most consistently selected across bootstrap replications. Optional
arguments such as a selection-frequency threshold and the number of top
variables to display can be used to focus the visualization on the most
stable predictors.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">imp.coxkl</span>, threshold <span class="op">=</span> <span class="fl">0.6</span>, top <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></code></pre></div>
<p><img src="SurvBregDiv_files/figure-html/unnamed-chunk-23-1.png" class="r-plt" alt="Plot generated in survkl vignette" width="700"></p>
<p>Classical LASSO tuned via cross-validation performs well for
prediction, but it is often unstable for variable selection: small
perturbations of the data or changes in cross-validation splits may lead
to different selected subsets, particularly in high-dimensional or
correlated settings. <em>Stability selection</em> provides a
complementary approach that emphasizes reproducibility by repeatedly
perturbing the data and recording how frequently each variable is
selected across subsamples.</p>
<p>The functions <code><a href="../reference/coxkl_enet.StabSelect.html">coxkl_enet.StabSelect()</a></code> extend the
cross-validated elastic-net procedures (<code><a href="../reference/cv.coxkl_enet.html">cv.coxkl_enet()</a></code>) by
repeatedly fitting the integrated elastic-net model on multiple
subsamples (controlled by the parameter <code>B</code>). For each
subsample, the model is fit using its own cross-validated tuning
parameters, and the selection status of each variable along the
regularization path is recorded. The function returns the empirical
selection frequency of each variable across resamples and across the
entire penalty path, providing a stability-oriented summary of variable
importance.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coxkl.StabSelect</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/coxkl_enet.StabSelect.html">coxkl_enet.StabSelect</a></span><span class="op">(</span></span>
<span>  z <span class="op">=</span> <span class="va">z_hd</span>,</span>
<span>  delta <span class="op">=</span> <span class="va">delta_hd</span>,</span>
<span>  time <span class="op">=</span> <span class="va">time_hd</span>,</span>
<span>  stratum <span class="op">=</span> <span class="va">strat_hd</span>,</span>
<span>  beta <span class="op">=</span> <span class="va">beta_external_hd</span>,</span>
<span>  etas <span class="op">=</span> <span class="va">eta_list</span>,</span>
<span>  cv.criteria <span class="op">=</span> <span class="st">"CIndex_pooled"</span>,</span>
<span>  B <span class="op">=</span> <span class="fl">50</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Objects returned by <code>coxkl_enet.StabSelect</code> can be
visualized using the S3 plotting method <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>. Users must
specify a selection frequency threshold between 0 and 1: variables whose
selection frequency exceeds this threshold are highlighted in the plot,
while the remaining variables are displayed in a muted color. The x-axis
corresponds to the penalty parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œª</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
on a reversed log10 scale, and the y-axis shows the selection
frequency.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">coxkl.StabSelect</span>, threshold <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> </span></code></pre></div>
<p><img src="SurvBregDiv_files/figure-html/unnamed-chunk-25-1.png" class="r-plt" alt="Plot generated in survkl vignette" width="700"></p>
</div>
<div class="section level5">
<h5 id="sec_bagging">Bagging for High-Dimensional Models<a class="anchor" aria-label="anchor" href="#sec_bagging"></a>
</h5>
<p>Besides cross-validated LASSO and stability selection, we
additionally support an ensemble strategy that combines bootstrapping,
external-data integration, and model aggregation. Conceptually similar
to bootstrap aggregation (bagging).</p>
<p>For each bootstrap sample, the integrated model is refit with its own
cross-validated tuning parameters, and the resulting linear predictors
are aggregated across bootstrap replicates. Unlike stability selection,
the goal here is not variable selection, but prediction stabilization:
different bootstrap replicates may recruit different levels of external
borrowing, allowing weak or noisy external signals to be averaged out
rather than over-amplified by a single fit. As a result, this bagged
integration approach reduces variance and improves predictive robustness
compared to relying solely on a single cross-validated integrated LASSO
model.</p>
<p>The functions <code><a href="../reference/coxkl_enet_bagging.html">coxkl_enet_bagging()</a></code> implement this
ensemble strategy. The following example demonstrates how to apply
<code><a href="../reference/coxkl_enet_bagging.html">coxkl_enet_bagging()</a></code> for bagged integration in
high-dimensional settings. The function inherits the arguments of
<code><a href="../reference/cv.coxkl_enet.html">cv.coxkl_enet()</a></code>, with an additional parameter
<code>B</code> that controls the number of subsamples used in the
ensemble.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bagging.coxkl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/coxkl_enet_bagging.html">coxkl_enet_bagging</a></span><span class="op">(</span></span>
<span>  z <span class="op">=</span> <span class="va">z_hd</span>,</span>
<span>  delta <span class="op">=</span> <span class="va">delta_hd</span>,</span>
<span>  time <span class="op">=</span> <span class="va">time_hd</span>,</span>
<span>  stratum <span class="op">=</span> <span class="va">strat_hd</span>,</span>
<span>  beta <span class="op">=</span> <span class="va">beta_external_hd</span>,</span>
<span>  etas <span class="op">=</span> <span class="va">eta_list</span>,</span>
<span>  B <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The returned object contains the bagged coefficient estimate (stored
in <code>bagging.coxkl$best_beta</code>) as well as the all
bootstrap-specific estimates (<code>bagging.coxkl$all_betas</code>). In
practice, <code>bagging.coxkl$best_beta</code> can be treated as the
final integrated elastic-net coefficient vector for downstream analysis;
for example, risk scores on a new design matrix <code>z_new</code> can
be computed via the linear predictor
<code>z_new %*% bagging.coxkl$best_beta</code>, while
<code>bagging.coxkl$all_betas</code> can be inspected to assess the
variability of the bootstrap ensemble.</p>
</div>
<div class="section level5">
<h5 id="sec_multisource">Multi-Source Integration<a class="anchor" aria-label="anchor" href="#sec_multisource"></a>
</h5>
<p>In many applications, multiple sources of external information may be
available, each providing a distinct set of external coefficient
estimates derived from different studies, populations, or modeling
strategies. Instead of relying on a single external source, it can be
beneficial to integrate information from multiple sources to obtain a
more robust and less source-specific estimate.</p>
<p>The function <code><a href="../reference/coxkl_enet.multi.html">coxkl_enet.multi()</a></code> fits KL-integrated Cox
elastic-net models using multiple external coefficient vectors. The
model is fitted on the full dataset once for each element in beta_list,
and the resulting coefficient estimates are combined across sources
(e.g., by averaging) to obtain a single integrated estimate.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">beta_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="va">ExampleData_highdim</span><span class="op">$</span><span class="va">beta_external</span>,</span>
<span>  <span class="va">ExampleData_highdim</span><span class="op">$</span><span class="va">beta_external.multi1</span>,</span>
<span>  <span class="va">ExampleData_highdim</span><span class="op">$</span><span class="va">beta_external.multi2</span>,</span>
<span>  <span class="va">ExampleData_highdim</span><span class="op">$</span><span class="va">beta_external.multi3</span>,</span>
<span>  <span class="va">ExampleData_highdim</span><span class="op">$</span><span class="va">beta_external.multi4</span>,</span>
<span>  <span class="va">ExampleData_highdim</span><span class="op">$</span><span class="va">beta_external.multi5</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">multi.out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/coxkl_enet.multi.html">coxkl_enet.multi</a></span><span class="op">(</span></span>
<span>  z <span class="op">=</span> <span class="va">z_hd</span>,</span>
<span>  delta <span class="op">=</span> <span class="va">delta_hd</span>,</span>
<span>  time <span class="op">=</span> <span class="va">time_hd</span>,</span>
<span>  stratum <span class="op">=</span> <span class="va">strat_hd</span>,</span>
<span>  beta_list <span class="op">=</span> <span class="va">beta_list</span>,</span>
<span>  etas <span class="op">=</span> <span class="va">eta_list</span>,</span>
<span>  combine <span class="op">=</span> <span class="st">"mean"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The output is an object contains the combined coefficient estimate as
well as the individual coefficient vectors obtained from each external
source. In particular, <code>best_beta</code> stores the aggregated
coefficient vector, while <code>all_betas</code> contains the
coefficient estimates from each fitted model.</p>
</div>
</div>
<div class="section level4">
<h4 id="sec_coxmaha">2.2.3 Mahalanobis Distance Data Integration<a class="anchor" aria-label="anchor" href="#sec_coxmaha"></a>
</h4>
<p>Due to practical or regulatory constraints, only summary-level
information may be available from the external source. Compared with <a href="#sec_coxkl">Kullback‚ÄìLeibler Divergence Data Integration</a>, the
Mahalanobis distance approach is applicable when the user can also
provide a positive semidefinite matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùêÄ</mi><annotation encoding="application/x-tex">\mathbf{A}</annotation></semantics></math>
summarizing the curvature of the external objective function (e.g., an
information matrix, a variance‚Äìcovariance matrix, or variance
information only). The minimal input required for this approach is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>ùõÉ</mi><mo accent="true">ÃÉ</mo></mover><annotation encoding="application/x-tex">\widetilde{\boldsymbol{\beta}}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùêÄ</mi><annotation encoding="application/x-tex">\mathbf{A}</annotation></semantics></math>.
If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùêÄ</mi><annotation encoding="application/x-tex">\mathbf{A}</annotation></semantics></math>
is not supplied, the function defaults to using the identity matrix,
which reduces the Mahalanobis distance penalty to the squared Euclidean
distance.</p>
<p>We present the usage of the functions for <a href="#sec_coxMD_low">low-dimensional</a> and <a href="#sec_coxMD_high">high-dimensional</a> settings separately.</p>
<div class="section level5">
<h5 id="sec_coxMD_low">Low-Dimensional Integration<a class="anchor" aria-label="anchor" href="#sec_coxMD_low"></a>
</h5>
<p>We begin with <strong>low-dimensional</strong> settings, where the
number of predictors is modest. The description of the built-in
low-dimensional simulated dataset <code>ExampleData_lowdim</code>, as
well as the example external
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>ùõÉ</mi><mo accent="true">ÃÉ</mo></mover><annotation encoding="application/x-tex">\widetilde{\boldsymbol{\beta}}</annotation></semantics></math>,
is the same as in the <a href="#sec_coxkl_low">KL divergence
section</a>.</p>
<p>To fit the Mahalanobis distance‚Äìbased integrated model, we first
generate a suitable range of integration weights
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
using the function <code><a href="../reference/generate_eta.html">generate_eta()</a></code>. The user should rely on
prior knowledge or problem-specific considerations to determine an
appropriate range. We then use the function <code><a href="../reference/cox_MDTL.html">cox_MDTL()</a></code> to
fit the model. The external regression coefficient
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>ùõÉ</mi><mo accent="true">ÃÉ</mo></mover><annotation encoding="application/x-tex">\widetilde{\boldsymbol{\beta}}</annotation></semantics></math>
is supplied to the function through the argument <code>beta =</code>,
and the external curvature matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùêÄ</mi><annotation encoding="application/x-tex">\mathbf{A}</annotation></semantics></math>
through the argument <code>vcov =</code>. Below, we illustrate the usage
when no external
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùêÄ</mi><annotation encoding="application/x-tex">\mathbf{A}</annotation></semantics></math>
matrix is provided by setting <code>vcov = NULL</code>.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eta_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_eta.html">generate_eta</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"exponential"</span>, n <span class="op">=</span> <span class="fl">50</span>, max_eta <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit.cox_MDTL</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cox_MDTL.html">cox_MDTL</a></span><span class="op">(</span></span>
<span>  z <span class="op">=</span> <span class="va">z</span>,</span>
<span>  delta <span class="op">=</span> <span class="va">delta</span>,</span>
<span>  time <span class="op">=</span> <span class="va">time</span>,</span>
<span>  stratum <span class="op">=</span> <span class="va">strat</span>,</span>
<span>  beta <span class="op">=</span> <span class="va">beta_ext</span>,</span>
<span>  vcov <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  etas <span class="op">=</span> <span class="va">eta_list</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Users may directly call the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method to visualize
the model‚Äôs fitted performance on the training data without providing
additional test data. If a test set is supplied, performance metrics are
computed using the test set instead:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">fit.cox_MDTL</span>,</span>
<span>  test_z       <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">z</span>,</span>
<span>  test_time    <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">time</span>,</span>
<span>  test_delta   <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">status</span>,</span>
<span>  test_stratum <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">stratum</span>,</span>
<span>  criteria     <span class="op">=</span> <span class="st">"loss"</span></span>
<span><span class="op">)</span> </span></code></pre></div>
<p><img src="SurvBregDiv_files/figure-html/unnamed-chunk-29-1.png" class="r-plt" alt="Plot generated in survkl vignette" width="700"></p>
<p>The function <code><a href="../reference/cv.cox_MDTL.html">cv.cox_MDTL()</a></code> performs
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>-fold
cross-validation (default
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>=</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">K = 5</annotation></semantics></math>)
to select the integration parameter in the KL-integrated Cox model. We
consider four criteria: two based on Harrell‚Äôs C-index <span class="citation">(Harrell et al. 1982)</span>‚Äî<code>CIndex_pooled</code>
and <code>CIndex_foldaverage</code>‚Äîand two loss-based
criteria‚Äî<code>LinPred</code> and <code>V&amp;VH</code>. For details,
please refer to Page: <em>Appendix: CV Criteria</em>. Below is an
example using the default <code>"V&amp;VH"</code> criterion:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cvfit.cox_MDTL</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv.cox_MDTL.html">cv.cox_MDTL</a></span><span class="op">(</span></span>
<span>  z <span class="op">=</span> <span class="va">z</span>,</span>
<span>  delta <span class="op">=</span> <span class="va">delta</span>,</span>
<span>  time <span class="op">=</span> <span class="va">time</span>,</span>
<span>  stratum <span class="op">=</span> <span class="va">strat</span>,</span>
<span>  beta <span class="op">=</span> <span class="va">beta_ext</span>,</span>
<span>  etas <span class="op">=</span> <span class="va">eta_list</span>,</span>
<span>  vcov <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nfolds <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  criteria <span class="op">=</span> <span class="st">"V&amp;VH"</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>The cross-validated performance curve from hyperparameter tuning
functions <code><a href="../reference/cv.cox_MDTL.html">cv.cox_MDTL()</a></code> can be visualized directly using
<code><a href="../reference/cv.plot.html">cv.plot()</a></code>:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cv.plot.html">cv.plot</a></span><span class="op">(</span><span class="va">cvfit.cox_MDTL</span><span class="op">)</span></span></code></pre></div>
<p><img src="SurvBregDiv_files/figure-html/unnamed-chunk-31-1.png" class="r-plt" alt="Plot generated in survkl vignette" width="700"></p>
</div>
<div class="section level5">
<h5 id="sec_coxMD_high">High-Dimensional Integration<a class="anchor" aria-label="anchor" href="#sec_coxMD_high"></a>
</h5>
<p>In high-dimensional regimes‚Äîsuch as when the number of predictors is
comparable to or exceeds the sample size‚Äîthe <code>SurvBregDiv</code>
package extends Mahalanobis Distance‚Äìintegrated Cox modeling with
regularization. The families of penalties, the tuning parameters, the
built-in high-dimensional dataset <code>ExampleData_highdim</code>, and
the workflow for fitting and tuning penalized KL-integrated models are
the same as described in the <a href="#sec_coxkl_high">KL divergence
section</a>. The only difference is that users should use the functions
<code><a href="../reference/cox_MDTL_ridge.html">cox_MDTL_ridge()</a></code> and <code><a href="../reference/cox_MDTL_enet.html">cox_MDTL_enet()</a></code> for
fitting, and <code><a href="../reference/cv.cox_MDTL_ridge.html">cv.cox_MDTL_ridge()</a></code> and
<code><a href="../reference/cv.cox_MDTL_enet.html">cv.cox_MDTL_enet()</a></code> for cross-validation.</p>
<p>For example, we fit a Mahalanobis Distance-integrated Ridge model for
a fixed integration weight
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
using an automatically generated lambda sequence:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.cox_MDTL_ridge</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cox_MDTL_ridge.html">cox_MDTL_ridge</a></span><span class="op">(</span></span>
<span>  z        <span class="op">=</span> <span class="va">z_hd</span>,</span>
<span>  delta    <span class="op">=</span> <span class="va">delta_hd</span>,</span>
<span>  time     <span class="op">=</span> <span class="va">time_hd</span>,</span>
<span>  stratum  <span class="op">=</span> <span class="va">strat_hd</span>,</span>
<span>  beta     <span class="op">=</span> <span class="va">beta_external_hd</span>,</span>
<span>  vcov     <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  eta      <span class="op">=</span> <span class="fl">1</span>                 </span>
<span><span class="op">)</span></span></code></pre></div>
<p>The fitted object stores, for each value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œª</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>:</p>
<ul>
<li>
<code>$lambda</code> ‚Äî the sequence of lambda values (in decreasing
order),</li>
<li>
<code>$beta</code> ‚Äî estimated coefficients (one column per
lambda),</li>
<li>
<code>$linear.predictors</code> ‚Äî linear predictors for all
observations across the lambda path,</li>
<li>
<code>$likelihood</code> ‚Äî partial log-likelihood along the lambda
path,</li>
<li>
<code>$data</code> ‚Äî the data used for fitting.</li>
</ul>
<p>The function <code><a href="../reference/cox_MDTL_enet.html">cox_MDTL_enet()</a></code> fits a KL-integrated Cox
model with an elastic-net penalty, controlled by the mixing parameter
<code>alpha</code>. When <code>alpha = 1</code>, the penalty reduces to
<em>LASSO</em>, introducing coefficient sparsity in addition to KL-based
integration of external information. Similar, the penalty parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œª</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
controls sparsity. If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œª</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
is not provided, the function automatically generates a decreasing
lambda sequence.</p>
<p>Below, we illustrate the workflow using the <em>LASSO</em> special
case (<code>alpha = 1</code>) with an automatically generated lambda
path:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.cox_MDTL_LASSO</span> <span class="op">&lt;-</span><span class="fu"><a href="../reference/cox_MDTL_enet.html">cox_MDTL_enet</a></span><span class="op">(</span></span>
<span>  z        <span class="op">=</span> <span class="va">z_hd</span>,</span>
<span>  delta    <span class="op">=</span> <span class="va">delta_hd</span>,</span>
<span>  time     <span class="op">=</span> <span class="va">time_hd</span>,</span>
<span>  stratum  <span class="op">=</span> <span class="va">strat_hd</span>,</span>
<span>  beta     <span class="op">=</span> <span class="va">beta_external_hd</span>,   </span>
<span>  vcov     <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  eta      <span class="op">=</span> <span class="fl">1</span>,                 </span>
<span>  alpha    <span class="op">=</span> <span class="fl">1</span>                  <span class="co"># LASSO penalty</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The fitted object stores, for each lambda value:</p>
<ul>
<li>
<code>$lambda</code> ‚Äî the lambda sequence (in decreasing
order),</li>
<li>
<code>$beta</code> ‚Äî estimated coefficients (one column per
lambda),</li>
<li>
<code>$likelihood</code> ‚Äî partial log-likelihood along the lambda
path,</li>
<li>
<code>$data</code> ‚Äî the data used for fitting.</li>
</ul>
<p>Objects from <code><a href="../reference/cox_MDTL_ridge.html">cox_MDTL_ridge()</a></code> or
<code><a href="../reference/cox_MDTL_enet.html">cox_MDTL_enet()</a></code> functions can be visualized using the S3
plotting method <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>:</p>
<p>This plots (at given
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>):</p>
<ul>
<li>Loss or C-index versus the penalty parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œª</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>,</li>
<li>x-axis on a reversed log10 scale (larger penalties on the left,
smaller penalties on the right),</li>
<li>y-axis labeled as loss or C-index,.</li>
<li>A vertical dashed orange line marks the optimal value of Œª, where
the loss reaches its minimum on the evaluated grid.</li>
</ul>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">fit.cox_MDTL_LASSO</span>,</span>
<span>  test_z       <span class="op">=</span> <span class="va">test_hd</span><span class="op">$</span><span class="va">z</span>,</span>
<span>  test_time    <span class="op">=</span> <span class="va">test_hd</span><span class="op">$</span><span class="va">time</span>,</span>
<span>  test_delta   <span class="op">=</span> <span class="va">test_hd</span><span class="op">$</span><span class="va">status</span>,</span>
<span>  test_stratum <span class="op">=</span> <span class="va">test_hd</span><span class="op">$</span><span class="va">stratum</span>,</span>
<span>  criteria     <span class="op">=</span> <span class="st">"loss"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="SurvBregDiv_files/figure-html/unnamed-chunk-34-1.png" class="r-plt" alt="Plot generated in survkl vignette" width="700"></p>
<p>For penalized KL-integrated models, the functions
<code><a href="../reference/cv.cox_MDTL_ridge.html">cv.cox_MDTL_ridge()</a></code> and <code><a href="../reference/cv.cox_MDTL_enet.html">cv.cox_MDTL_enet()</a></code>
perform K-fold cross-validation to tune the integration parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>,
while internally scanning over a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œª</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
path for each candidate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>.
For each value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>,
the cross-validation procedure:</p>
<ul>
<li>evaluates a sequence of ridge or elastic-net penalties
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œª</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>,</li>
<li>computes the chosen cross-validation criterion on the held-out
folds,</li>
<li>selects the best
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œª</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
for that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>,</li>
<li>aggregates the performance across folds into summary tables.</li>
</ul>
<p>The supported criteria also include two based on Harrell‚Äôs C-index
<span class="citation">(Harrell et al.
1982)</span>‚Äî<code>CIndex_pooled</code> and
<code>CIndex_foldaverage</code>‚Äîand two loss-based
criteria‚Äî<code>LinPred</code> and <code>V&amp;VH</code>. For details,
please refer to Page: <em>Appendix: CV Criteria</em>.</p>
<p>Below we demonstrate tuning
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
using 5-fold cross-validation and the <code>V&amp;VH</code> criterion
for the LASSO-penalized integrated model (<code>alpha = 1</code>). The
range of integration weights
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
can be generated by using the function <code><a href="../reference/generate_eta.html">generate_eta()</a></code>. The
user should rely on prior knowledge or problem-specific considerations
to determine an appropriate range. (For ridge, use
<code><a href="../reference/cv.cox_MDTL_ridge.html">cv.cox_MDTL_ridge()</a></code> analogously.)</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eta_grid_hd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_eta.html">generate_eta</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"exponential"</span>, n <span class="op">=</span> <span class="fl">50</span>, max_eta <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cvfit.cox_MDTL_LASSO</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv.cox_MDTL_enet.html">cv.cox_MDTL_enet</a></span><span class="op">(</span></span>
<span>  z <span class="op">=</span> <span class="va">z_hd</span>,</span>
<span>  delta <span class="op">=</span> <span class="va">delta_hd</span>,</span>
<span>  time <span class="op">=</span> <span class="va">time_hd</span>,</span>
<span>  stratum <span class="op">=</span> <span class="va">strat_hd</span>,</span>
<span>  beta <span class="op">=</span> <span class="va">beta_external_hd</span>,</span>
<span>  vcov <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  etas <span class="op">=</span> <span class="va">eta_grid_hd</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">1</span>, <span class="co"># LASSO</span></span>
<span>  nfolds <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  cv.criteria <span class="op">=</span> <span class="st">"V&amp;VH"</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The helper function <code><a href="../reference/cv.plot.html">cv.plot()</a></code> can be used to visualize
performance versus
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>:</p>
<p>For variable importance and stability selection, the functions
<code><a href="../reference/variable_importance.html">variable_importance()</a></code> and
<code><a href="../reference/cox_MDTL_enet.StabSelect.html">cox_MDTL_enet.StabSelect()</a></code> can be applied to the
Mahalanobis distance‚Äìintegrated elastic-net models fitted by
<code><a href="../reference/cv.cox_MDTL_enet.html">cv.cox_MDTL_enet()</a></code>, using the same interface and workflow
as described in the sections on <a href="#sec_var_importance">variable
importance and stability selection</a> and <a href="#sec_bagging">Bagging</a> in the KL divergence section.</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="sec_cc">2.3 (Nested) Case-Control Design<a class="anchor" aria-label="anchor" href="#sec_cc"></a>
</h3>
<p>In the NCC setting, event times are represented through matched
case‚Äìcontrol sets, and estimation proceeds via conditional logistic
regression. <code>SurvBregDiv</code> enables external information
borrowing within this framework through Bregman divergence, allowing
improved efficiency while respecting the matched-set structure. The
remainder of this section demonstrates the core usage and workflow.
Standard matched case‚Äìcontrol or matched cohort studies can be viewed as
special cases of the NCC design.</p>
<p>We adopt the KL-divergence approach for data integration and present
the usage of the functions for <a href="#sec_low_cc">low-dimensional</a>
and <a href="#sec_high_cc">high-dimensional</a> settings separately.</p>
<div class="section level4">
<h4 id="sec_low_cc">2.3.1 Low-Dimensional Integration<a class="anchor" aria-label="anchor" href="#sec_low_cc"></a>
</h4>
<p>The built-in simulated dataset for NCC designs,
<code>ExampleData_cc</code>, contains a training set (1000 samples) and
a test set (2500 samples). The data include a <code>stratum</code>
variable, where observations with the same stratum ID belong to the same
matched set. The training data contain 200 matched sets and the test
data contain 500 matched sets, each constructed under a 1:4 matching
scheme. The dataset further includes six predictors
(<code>Z1</code>‚Äì<code>Z6</code>). Externally derived coefficients are
provided in <code>beta_external</code>:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ExampleData_cc</span><span class="op">)</span></span>
<span></span>
<span><span class="va">train.cc</span>  <span class="op">&lt;-</span> <span class="va">ExampleData_cc</span><span class="op">$</span><span class="va">train</span></span>
<span><span class="va">test.cc</span>   <span class="op">&lt;-</span> <span class="va">ExampleData_cc</span><span class="op">$</span><span class="va">test</span></span>
<span></span>
<span><span class="va">z.cc</span>      <span class="op">&lt;-</span> <span class="va">train.cc</span><span class="op">$</span><span class="va">z</span></span>
<span><span class="va">y.cc</span>      <span class="op">&lt;-</span> <span class="va">train.cc</span><span class="op">$</span><span class="va">y</span></span>
<span><span class="va">set.cc</span>    <span class="op">&lt;-</span> <span class="va">train.cc</span><span class="op">$</span><span class="va">stratum</span></span>
<span></span>
<span><span class="va">beta_ext.cc</span> <span class="op">&lt;-</span> <span class="va">ExampleData_cc</span><span class="op">$</span><span class="va">beta_external</span></span></code></pre></div>
<p>The main fitting function for this setting is <code>clogitkl</code>.
Users must specify the tie-handling method via the <code>method</code>
argument. For 1:M matched case‚Äìcontrol studies, <code>"breslow"</code>
and <code>"exact"</code> yield identical results, although
<code>"exact"</code> is theoretically preferable. For n:m matched
designs with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n &gt; 1</annotation></semantics></math>,
the two methods can differ.</p>
<p>To use the KL divergence‚Äìbased integrated model, the user must at
least provide the estimated external regression coefficients
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>ùõÉ</mi><mo accent="true">ÃÉ</mo></mover><annotation encoding="application/x-tex">\widetilde{\boldsymbol{\beta}}</annotation></semantics></math>
via the argument <code>beta</code> in the function
<code><a href="../reference/clogitkl.html">clogitkl()</a></code>. The integration weights
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
can be generated using the function <code><a href="../reference/generate_eta.html">generate_eta()</a></code>. The
user should rely on prior knowledge or problem-specific considerations
to determine an appropriate range of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
values.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eta_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_eta.html">generate_eta</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"exponential"</span>, n <span class="op">=</span> <span class="fl">50</span>, max_eta <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">clogitkl.fit_breslow</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clogitkl.html">clogitkl</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y.cc</span>, z <span class="op">=</span> <span class="va">z.cc</span>, stratum <span class="op">=</span> <span class="va">set.cc</span>, </span>
<span>                                 eta <span class="op">=</span> <span class="va">eta_list</span>, beta <span class="op">=</span> <span class="va">beta_ext.cc</span>,</span>
<span>                                 method <span class="op">=</span> <span class="st">"breslow"</span><span class="op">)</span></span></code></pre></div>
<p>Users may directly call the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method to visualize
the model‚Äôs fitted performance on the training data without providing
additional test data. If a test set is supplied, performance metrics are
computed using the test set instead:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">clogitkl.fit_breslow</span>,</span>
<span>  test_z       <span class="op">=</span> <span class="va">test.cc</span><span class="op">$</span><span class="va">z</span>,</span>
<span>  test_delta   <span class="op">=</span> <span class="va">test.cc</span><span class="op">$</span><span class="va">y</span>,</span>
<span>  test_stratum <span class="op">=</span> <span class="va">test.cc</span><span class="op">$</span><span class="va">stratum</span>,</span>
<span>  criteria     <span class="op">=</span> <span class="st">"loss"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="SurvBregDiv_files/figure-html/unnamed-chunk-38-1.png" class="r-plt" alt="Plot generated in survkl vignette" width="700"></p>
<p>Cross-validation for tuning
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
can be performed via <code><a href="../reference/cv.clogitkl.html">cv.clogitkl()</a></code>, which performs K-fold
cross-validation to tune the integration parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>.</p>
<p>The supported criteria include predicted deviance
(<code>loss</code>), <code>AUC</code> <span class="citation">(Hanley and
McNeil 1982)</span>, and Brier Score (<code>Brier</code>)<span class="citation">(Glenn et al. 1950)</span>. For details, please refer
to Page: <em>Appendix: CV Criteria</em>.</p>
<p>Below we demonstrate tuning
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
using 5-fold cross-validation and the <code>V&amp;VH</code> criterion
for the LASSO-penalized integrated model (<code>alpha = 1</code>). The
range of integration weights
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
can be generated by using the function <code><a href="../reference/generate_eta.html">generate_eta()</a></code>. The
user should rely on prior knowledge or problem-specific considerations
to determine an appropriate range. (For ridge, use
<code><a href="../reference/cv.coxkl_ridge.html">cv.coxkl_ridge()</a></code> analogously.)</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cv.clogitkl.fit_breslow</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv.clogitkl.html">cv.clogitkl</a></span><span class="op">(</span></span>
<span>  y        <span class="op">=</span> <span class="va">y.cc</span>,</span>
<span>  z        <span class="op">=</span> <span class="va">z.cc</span>,</span>
<span>  stratum  <span class="op">=</span> <span class="va">set.cc</span>,</span>
<span>  beta     <span class="op">=</span> <span class="va">beta_ext.cc</span>,</span>
<span>  etas     <span class="op">=</span> <span class="va">eta_list</span>,</span>
<span>  method   <span class="op">=</span> <span class="st">"exact"</span>,</span>
<span>  nfolds   <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  criteria <span class="op">=</span> <span class="st">"loss"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The cross-validated performance curve can be visualized using
<code><a href="../reference/cv.plot.html">cv.plot()</a></code>:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cv.plot.html">cv.plot</a></span><span class="op">(</span><span class="va">cv.clogitkl.fit_breslow</span><span class="op">)</span></span></code></pre></div>
<p><img src="SurvBregDiv_files/figure-html/unnamed-chunk-40-1.png" class="r-plt" alt="Plot generated in survkl vignette" width="700"></p>
<p>The plot displays a purple curve tracing the cross-validated
performance across the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
grid, a green dotted horizontal line representing the internal baseline
at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi>t</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">eta</annotation></semantics></math>
= 0 (with a green point marking its value), and a vertical dashed orange
line indicating the optimal
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
at which the cross-validated loss is minimized.</p>
</div>
<div class="section level4">
<h4 id="sec_high_cc">2.3.2 High-Dimensional Integration<a class="anchor" aria-label="anchor" href="#sec_high_cc"></a>
</h4>
<p>The built-in simulated dataset for NCC designs,
<code>ExampleData_cc_highdim</code>, contains a training set with 50
matched sets and a test set with 500 matched sets, each constructed
under a 1:5 matching scheme. The dataset includes 10 predictors
(<code>Z1</code>‚Äì<code>Z20</code>). Externally derived coefficients are
provided in <code>beta_external</code>:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ExampleData_cc_highdim</span><span class="op">)</span></span>
<span></span>
<span><span class="va">train.cc_hd</span>  <span class="op">&lt;-</span> <span class="va">ExampleData_cc_highdim</span><span class="op">$</span><span class="va">train</span></span>
<span><span class="va">test.cc_hd</span>   <span class="op">&lt;-</span> <span class="va">ExampleData_cc_highdim</span><span class="op">$</span><span class="va">test</span></span>
<span></span>
<span><span class="va">z.cc_hd</span>      <span class="op">&lt;-</span> <span class="va">train.cc_hd</span><span class="op">$</span><span class="va">z</span></span>
<span><span class="va">y.cc_hd</span>      <span class="op">&lt;-</span> <span class="va">train.cc_hd</span><span class="op">$</span><span class="va">y</span></span>
<span><span class="va">set.cc_hd</span>    <span class="op">&lt;-</span> <span class="va">train.cc_hd</span><span class="op">$</span><span class="va">stratum</span></span>
<span></span>
<span><span class="va">beta_ext.cc_hd</span> <span class="op">&lt;-</span> <span class="va">ExampleData_cc_highdim</span><span class="op">$</span><span class="va">beta_external</span></span></code></pre></div>
<p>For high-dimensional NCC data, we demonstrate usage with
<code><a href="../reference/clogitkl_enet.html">clogitkl_enet()</a></code>, which fits KL-integrated conditional
logistic regression models with elastic-net penalties.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clogitkl_enet_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clogitkl_enet.html">clogitkl_enet</a></span><span class="op">(</span></span>
<span>  y       <span class="op">=</span> <span class="va">y.cc_hd</span>,</span>
<span>  z       <span class="op">=</span> <span class="va">z.cc_hd</span>,</span>
<span>  stratum <span class="op">=</span> <span class="va">set.cc_hd</span>,</span>
<span>  beta    <span class="op">=</span> <span class="va">beta_ext.cc_hd</span>,</span>
<span>  eta     <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The fitted object can be visualized using the S3 <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>
method:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">clogitkl_enet_fit</span>,</span>
<span>  test_z       <span class="op">=</span> <span class="va">test.cc_hd</span><span class="op">$</span><span class="va">z</span>,</span>
<span>  test_delta   <span class="op">=</span> <span class="va">test.cc_hd</span><span class="op">$</span><span class="va">y</span>,</span>
<span>  test_stratum <span class="op">=</span> <span class="va">test.cc_hd</span><span class="op">$</span><span class="va">stratum</span>,</span>
<span>  criteria     <span class="op">=</span> <span class="st">"loss"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="SurvBregDiv_files/figure-html/unnamed-chunk-43-1.png" class="r-plt" alt="Plot generated in survkl vignette" width="700"></p>
<p>Cross-validation for tuning
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
can be performed via <code><a href="../reference/cv.clogitkl_enet.html">cv.clogitkl_enet()</a></code>:</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eta_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_eta.html">generate_eta</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"exponential"</span>, n <span class="op">=</span> <span class="fl">50</span>, max_eta <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">cv.clogitkl_enet_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv.clogitkl_enet.html">cv.clogitkl_enet</a></span><span class="op">(</span></span>
<span>  y        <span class="op">=</span> <span class="va">y.cc_hd</span>,</span>
<span>  z        <span class="op">=</span> <span class="va">z.cc_hd</span>,</span>
<span>  stratum  <span class="op">=</span> <span class="va">set.cc_hd</span>,</span>
<span>  beta     <span class="op">=</span> <span class="va">beta_ext.cc_hd</span>,</span>
<span>  etas     <span class="op">=</span> <span class="va">eta_list</span>,</span>
<span>  alpha    <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  nfolds   <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  criteria <span class="op">=</span> <span class="st">"loss"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The cross-validated performance curve can be visualized using
<code><a href="../reference/cv.plot.html">cv.plot()</a></code>:</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cv.plot.html">cv.plot</a></span><span class="op">(</span><span class="va">cv.clogitkl_enet_fit</span><span class="op">)</span></span></code></pre></div>
<p><img src="SurvBregDiv_files/figure-html/unnamed-chunk-45-1.png" class="r-plt" alt="Plot generated in survkl vignette" width="700"></p>
<p>The plot displays a purple curve tracing the cross-validated
performance across the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
grid, a green dotted horizontal line representing the internal baseline
at <code>eta = 0</code> (with a green point marking its value), and a
vertical dashed orange line indicating the optimal
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
at which the cross-validated loss is minimized.</p>
</div>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-breslow1974covariance" class="csl-entry">
Breslow, Norman. 1974. <span>‚ÄúCovariance Analysis of Censored Survival
Data.‚Äù</span> <em>Biometrics</em>, 89‚Äì99.
</div>
<div id="ref-cox1972regression" class="csl-entry">
Cox, David R. 1972. <span>‚ÄúRegression Models and Life-Tables.‚Äù</span>
<em>Journal of the Royal Statistical Society: Series B
(Methodological)</em> 34 (2): 187‚Äì202.
</div>
<div id="ref-gao2017_pseulikli" class="csl-entry">
Gao, Xin, and Raymond J. Carroll. 2017. <span>‚ÄúData Integration with
High Dimensionality.‚Äù</span> <em>Biometrika</em> 104 (2): 251‚Äì72. <a href="https://doi.org/10.1093/biomet/asx023" class="external-link">https://doi.org/10.1093/biomet/asx023</a>.
</div>
<div id="ref-glenn1950verification" class="csl-entry">
Glenn, W Brier et al. 1950. <span>‚ÄúVerification of Forecasts Expressed
in Terms of Probability.‚Äù</span> <em>Monthly Weather Review</em> 78 (1):
1‚Äì3.
</div>
<div id="ref-hanley1982meaning" class="csl-entry">
Hanley, James A, and Barbara J McNeil. 1982. <span>‚ÄúThe Meaning and Use
of the Area Under a Receiver Operating Characteristic (ROC)
Curve.‚Äù</span> <em>Radiology</em> 143 (1): 29‚Äì36.
</div>
<div id="ref-harrell1982evaluating" class="csl-entry">
Harrell, Frank E, Robert M Califf, David B Pryor, Kerry L Lee, and
Robert A Rosati. 1982. <span>‚ÄúEvaluating the Yield of Medical
Tests.‚Äù</span> <em>JAMA</em> 247 (18): 2543‚Äì46.
</div>
<div id="ref-wang2005_pseulikli" class="csl-entry">
Wang, Xiaogang, and James V. Zidek. 2005. <span>‚ÄúSelecting Likelihood
Weights by Cross-Validation.‚Äù</span> <em>The Annals of Statistics</em>
33 (2): 463‚Äì500. <a href="https://doi.org/10.1214/009053604000001309" class="external-link">https://doi.org/10.1214/009053604000001309</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Yubo Shao.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
