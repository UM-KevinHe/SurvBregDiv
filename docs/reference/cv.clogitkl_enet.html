<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Cross-Validated CLR-KL with Elastic Net Penalty — cv.clogitkl_enet • SurvBregDiv</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Cross-Validated CLR-KL with Elastic Net Penalty — cv.clogitkl_enet"><meta name="description" content="Performs K-fold cross-validation (CV) to jointly select the integration
parameter eta and the Elastic Net penalty parameter lambda
for Conditional Logistic Regression with Kullback–Leibler (KL)
divergence and Elastic Net penalty, implemented via clogitkl_enet.
This function is designed for 1:m matched case–control settings where each
stratum (matched set) contains exactly one case and \(m\) controls."><meta property="og:description" content="Performs K-fold cross-validation (CV) to jointly select the integration
parameter eta and the Elastic Net penalty parameter lambda
for Conditional Logistic Regression with Kullback–Leibler (KL)
divergence and Elastic Net penalty, implemented via clogitkl_enet.
This function is designed for 1:m matched case–control settings where each
stratum (matched set) contains exactly one case and \(m\) controls."><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-54921687-5"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-54921687-5');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="inverse" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SurvBregDiv</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/SurvBregDiv.html">Get started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-appendix" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Appendix</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-appendix"><li><a class="dropdown-item" href="../articles/CV_Criteria.html">CV Criteria</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/UM-KevinHe/SurvBregDiv" aria-label="GitHub repository"><span class="fa fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Cross-Validated CLR-KL with Elastic Net Penalty</h1>

      <div class="d-none name"><code>cv.clogitkl_enet.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Performs K-fold cross-validation (CV) to jointly select the integration
parameter <code>eta</code> and the Elastic Net penalty parameter <code>lambda</code>
for Conditional Logistic Regression with Kullback–Leibler (KL)
divergence and Elastic Net penalty, implemented via <code><a href="clogitkl_enet.html">clogitkl_enet</a></code>.</p>
<p>This function is designed for 1:m matched case–control settings where each
stratum (matched set) contains exactly one case and \(m\) controls.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cv.clogitkl_enet</span><span class="op">(</span></span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">z</span>,</span>
<span>  <span class="va">stratum</span>,</span>
<span>  RS <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  beta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  etas <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  lambda <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nlambda <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  lambda.min.ratio <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nfolds <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  criteria <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"loss"</span>, <span class="st">"AUC"</span>, <span class="st">"CIndex"</span>, <span class="st">"Brier"</span><span class="op">)</span>,</span>
<span>  message <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>Numeric vector of binary outcomes (0 = control, 1 = case).
In the 1:m matched case–control setting, each stratum must contain exactly
one case.</p></dd>


<dt id="arg-z">z<a class="anchor" aria-label="anchor" href="#arg-z"></a></dt>
<dd><p>Numeric matrix of covariates (rows = observations, columns = variables).</p></dd>


<dt id="arg-stratum">stratum<a class="anchor" aria-label="anchor" href="#arg-stratum"></a></dt>
<dd><p>Numeric or factor vector defining the matched sets (strata).
Each unique value identifies one matched set.</p></dd>


<dt id="arg-rs">RS<a class="anchor" aria-label="anchor" href="#arg-rs"></a></dt>
<dd><p>Optional numeric vector or matrix of external risk scores.
If not provided, <code>beta</code> must be supplied.</p></dd>


<dt id="arg-beta">beta<a class="anchor" aria-label="anchor" href="#arg-beta"></a></dt>
<dd><p>Optional numeric vector of external coefficients. If provided,
length must equal the number of columns in <code>z</code>. Either <code>RS</code> or
<code>beta</code> must be non-<code>NULL</code>.</p></dd>


<dt id="arg-etas">etas<a class="anchor" aria-label="anchor" href="#arg-etas"></a></dt>
<dd><p>Numeric vector of candidate tuning values for the integration
parameter \(\eta\). The values will be sorted in ascending order.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Elastic Net mixing parameter in \((0,1]\). Default is
<code>1</code> (lasso penalty).</p></dd>


<dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>Optional numeric vector of lambda values. If <code>NULL</code>, a
lambda path is generated automatically for each <code>eta</code>.</p></dd>


<dt id="arg-nlambda">nlambda<a class="anchor" aria-label="anchor" href="#arg-nlambda"></a></dt>
<dd><p>Integer. Number of lambda values to generate when
<code>lambda</code> is <code>NULL</code>. Default <code>100</code>.</p></dd>


<dt id="arg-lambda-min-ratio">lambda.min.ratio<a class="anchor" aria-label="anchor" href="#arg-lambda-min-ratio"></a></dt>
<dd><p>Numeric in \((0,1)\). Ratio of minimum to maximum
lambda when <code>lambda</code> is <code>NULL</code>. If <code>NULL</code>, it is set
internally to <code>0.05</code> when <code>n &lt; p</code>, and <code>1e-3</code> otherwise.</p></dd>


<dt id="arg-nfolds">nfolds<a class="anchor" aria-label="anchor" href="#arg-nfolds"></a></dt>
<dd><p>Number of cross-validation folds. Default <code>5</code>.</p></dd>


<dt id="arg-criteria">criteria<a class="anchor" aria-label="anchor" href="#arg-criteria"></a></dt>
<dd><p>Character string specifying the CV performance criterion.
Choices are:</p><ul><li><p><code>"loss"</code>: Average negative conditional log-likelihood
(lower is better).</p></li>
<li><p><code>"AUC"</code>: Matched-set AUC based on within-stratum comparisons
(higher is better).</p></li>
<li><p><code>"CIndex"</code>: Concordance index in the matched-set setting,
implemented via the same matched-set AUC calculation as <code>"AUC"</code>
(higher is better).</p></li>
<li><p><code>"Brier"</code>: Conditional Brier score using within-stratum
softmax probabilities (lower is better).</p></li>
</ul><p>Default is <code>"loss"</code>.</p></dd>


<dt id="arg-message">message<a class="anchor" aria-label="anchor" href="#arg-message"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, prints progress messages. Default
<code>FALSE</code>.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>Optional integer seed for reproducible fold assignment. Default
<code>NULL</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to <code><a href="clogitkl_enet.html">clogitkl_enet</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>list</code> of class <code>"cv.clogitkl_enet"</code> containing:</p><dl><dt><code>best</code></dt>
<dd><p>A list with the global best \((\eta, \lambda)\):</p><ul><li><p><code>best_eta</code>: Selected <code>eta</code>.</p></li>
<li><p><code>best_lambda</code>: Selected <code>lambda</code>.</p></li>
<li><p><code>best_beta</code>: Coefficient vector from the full-data fit at
<code>(best_eta, best_lambda)</code>.</p></li>
<li><p><code>criteria</code>: The criterion used.</p></li>
</ul></dd>

<dt><code>integrated_stat.full_results</code></dt>
<dd><p>A <code>data.frame</code> with one row
per <code>(eta, lambda)</code> combination and the corresponding CV score.</p></dd>

<dt><code>integrated_stat.best_per_eta</code></dt>
<dd><p>A <code>data.frame</code> with one row
per <code>eta</code>, containing the best <code>lambda</code> and its score.</p></dd>

<dt><code>integrated_stat.betahat_best</code></dt>
<dd><p>A matrix of coefficients where
each column is the full-data coefficient vector corresponding to the
best <code>lambda</code> for a given <code>eta</code>.</p></dd>

<dt><code>criteria</code></dt>
<dd><p>The CV criterion used.</p></dd>

<dt><code>alpha</code></dt>
<dd><p>The Elastic Net mixing parameter.</p></dd>

<dt><code>nfolds</code></dt>
<dd><p>The number of folds used.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The matched case–control problem is handled via <code><a href="clogitkl_enet.html">clogitkl_enet</a></code>,
which maps Conditional Logistic Regression to a Cox model with fixed event
time and uses <code><a href="coxkl_enet.html">coxkl_enet</a></code> as the core engine.</p>
<p>Cross-validation is performed at the stratum level: each matched set is
treated as an indivisible unit and assigned to a single fold using
<code>get_fold_cc</code>. This ensures that the conditional likelihood is
well-defined within each training and test split.</p>
<p>For each candidate <code>eta</code>, a full <code>lambda</code> path is fit on the
complete data (via <code><a href="clogitkl_enet.html">clogitkl_enet</a></code>), and then K-fold CV is used
to evaluate each <code>lambda</code> along this path according to the chosen
<code>criteria</code>. The function therefore performs a 2D search over
\((\eta, \lambda)\).</p>
<p>The <code>criteria</code> argument controls the CV performance metric:</p><ul><li><p><code>"loss"</code>: Average negative conditional log-likelihood on held-out
strata (lower is better).</p></li>
<li><p><code>"AUC"</code>: Matched-set AUC based on within-stratum comparisons
(higher is better).</p></li>
<li><p><code>"CIndex"</code>: Alias for <code>"AUC"</code> in the 1:m matched setting
(higher is better).</p></li>
<li><p><code>"Brier"</code>: Conditional Brier score based on within-stratum
softmax probabilities (lower is better).</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ExampleData_cc_highdim</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">train_cc</span> <span class="op">&lt;-</span> <span class="va">ExampleData_cc_highdim</span><span class="op">$</span><span class="va">train</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">y</span>        <span class="op">&lt;-</span> <span class="va">train_cc</span><span class="op">$</span><span class="va">y</span></span></span>
<span class="r-in"><span><span class="va">z</span>        <span class="op">&lt;-</span> <span class="va">train_cc</span><span class="op">$</span><span class="va">z</span></span></span>
<span class="r-in"><span><span class="va">sets</span>     <span class="op">&lt;-</span> <span class="va">train_cc</span><span class="op">$</span><span class="va">stratum</span></span></span>
<span class="r-in"><span><span class="va">beta_ext</span> <span class="op">&lt;-</span> <span class="va">ExampleData_cc_highdim</span><span class="op">$</span><span class="va">beta_external</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">eta_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="generate_eta.html">generate_eta</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"exponential"</span>, n <span class="op">=</span> <span class="fl">30</span>, max_eta <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cv_fit</span> <span class="op">&lt;-</span> <span class="fu">cv.clogitkl_enet</span><span class="op">(</span></span></span>
<span class="r-in"><span>  y        <span class="op">=</span> <span class="va">y</span>,</span></span>
<span class="r-in"><span>  z        <span class="op">=</span> <span class="va">z</span>,</span></span>
<span class="r-in"><span>  stratum  <span class="op">=</span> <span class="va">sets</span>,</span></span>
<span class="r-in"><span>  beta     <span class="op">=</span> <span class="va">beta_ext</span>,</span></span>
<span class="r-in"><span>  etas     <span class="op">=</span> <span class="va">eta_list</span>,</span></span>
<span class="r-in"><span>  alpha    <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  nfolds   <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>  criteria <span class="op">=</span> <span class="st">"loss"</span>,</span></span>
<span class="r-in"><span>  seed     <span class="op">=</span> <span class="fl">42</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cv_fit</span><span class="op">$</span><span class="va">best</span><span class="op">$</span><span class="va">best_eta</span></span></span>
<span class="r-in"><span><span class="va">cv_fit</span><span class="op">$</span><span class="va">best</span><span class="op">$</span><span class="va">best_lambda</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Yubo Shao.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

