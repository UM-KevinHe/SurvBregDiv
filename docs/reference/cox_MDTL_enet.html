<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fit Cox Model with Multi-Domain Transfer Learning and Elastic Net Penalty — cox_MDTL_enet • SurvBregDiv</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Fit Cox Model with Multi-Domain Transfer Learning and Elastic Net Penalty — cox_MDTL_enet"><meta name="description" content="Fits a Cox Proportional Hazards model that integrates external information (Transfer Learning)
using an Elastic Net regularization path. The method incorporates prior knowledge from
external coefficients (beta) and an optional weight matrix (vcov), controlled
by the transfer learning parameter eta.
The objective function minimizes the negative partial likelihood plus a transfer learning
penalty term \(\eta (\beta - \beta_{ext})^T Q (\beta - \beta_{ext})\) and the
Elastic Net penalty."><meta property="og:description" content="Fits a Cox Proportional Hazards model that integrates external information (Transfer Learning)
using an Elastic Net regularization path. The method incorporates prior knowledge from
external coefficients (beta) and an optional weight matrix (vcov), controlled
by the transfer learning parameter eta.
The objective function minimizes the negative partial likelihood plus a transfer learning
penalty term \(\eta (\beta - \beta_{ext})^T Q (\beta - \beta_{ext})\) and the
Elastic Net penalty."><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-54921687-5"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-54921687-5');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="inverse" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SurvBregDiv</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/SurvBregDiv.html">Get started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-appendix" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Appendix</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-appendix"><li><a class="dropdown-item" href="../articles/CV_Criteria.html">CV Criteria</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/UM-KevinHe/SurvBregDiv" aria-label="GitHub repository"><span class="fa fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Fit Cox Model with Multi-Domain Transfer Learning and Elastic Net Penalty</h1>

      <div class="d-none name"><code>cox_MDTL_enet.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fits a Cox Proportional Hazards model that integrates external information (Transfer Learning)
using an Elastic Net regularization path. The method incorporates prior knowledge from
external coefficients (<code>beta</code>) and an optional weight matrix (<code>vcov</code>), controlled
by the transfer learning parameter <code>eta</code>.</p>
<p>The objective function minimizes the negative partial likelihood plus a transfer learning
penalty term \(\eta (\beta - \beta_{ext})^T Q (\beta - \beta_{ext})\) and the
Elastic Net penalty.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cox_MDTL_enet</span><span class="op">(</span></span>
<span>  <span class="va">z</span>,</span>
<span>  <span class="va">delta</span>,</span>
<span>  <span class="va">time</span>,</span>
<span>  stratum <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">beta</span>,</span>
<span>  vcov <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  eta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  alpha <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lambda <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nlambda <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  lambda.min.ratio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">n</span> <span class="op">&lt;</span> <span class="va">p</span>, <span class="fl">0.05</span>, <span class="fl">0.001</span><span class="op">)</span>,</span>
<span>  lambda.early.stop <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  Mstop <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  max.total.iter <span class="op">=</span> <span class="op">(</span><span class="va">Mstop</span> <span class="op">*</span> <span class="va">nlambda</span><span class="op">)</span>,</span>
<span>  group <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span>,</span>
<span>  group.multiplier <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  standardize <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  nvar.max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span>,</span>
<span>  group.max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  stop.loss.ratio <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  actSet <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  actIter <span class="op">=</span> <span class="va">Mstop</span>,</span>
<span>  actGroupNum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>  actSetRemove <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  returnX <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  trace.lambda <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  message <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  data_sorted <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-z">z<a class="anchor" aria-label="anchor" href="#arg-z"></a></dt>
<dd><p>Matrix of predictors (n x p).</p></dd>


<dt id="arg-delta">delta<a class="anchor" aria-label="anchor" href="#arg-delta"></a></dt>
<dd><p>Vector of event indicators (1 for event, 0 for censored).</p></dd>


<dt id="arg-time">time<a class="anchor" aria-label="anchor" href="#arg-time"></a></dt>
<dd><p>Vector of observed survival times.</p></dd>


<dt id="arg-stratum">stratum<a class="anchor" aria-label="anchor" href="#arg-stratum"></a></dt>
<dd><p>Vector indicating the stratum membership. If NULL, all observations are assumed to be in the same stratum.</p></dd>


<dt id="arg-beta">beta<a class="anchor" aria-label="anchor" href="#arg-beta"></a></dt>
<dd><p>Vector of external coefficients (length p). This represents the prior knowledge or "source" model coefficients.</p></dd>


<dt id="arg-vcov">vcov<a class="anchor" aria-label="anchor" href="#arg-vcov"></a></dt>
<dd><p>Optional weighting matrix (p x p) for the external information. Typically the inverse covariance matrix (precision matrix) of the external estimator. If NULL, defaults to the identity matrix.</p></dd>


<dt id="arg-eta">eta<a class="anchor" aria-label="anchor" href="#arg-eta"></a></dt>
<dd><p>Scalar. The transfer learning parameter (&gt;= 0). Controls the strength of the external information. <code>eta = 0</code> ignores external info.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>The Elastic Net mixing parameter, with \(0 \le \alpha \le 1\). <code>alpha=1</code> is the lasso penalty, and <code>alpha=0</code> the ridge penalty.</p></dd>


<dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>Optional user-supplied lambda sequence. If NULL, the algorithm generates its own sequence.</p></dd>


<dt id="arg-nlambda">nlambda<a class="anchor" aria-label="anchor" href="#arg-nlambda"></a></dt>
<dd><p>The number of lambda values. Default is 100.</p></dd>


<dt id="arg-lambda-min-ratio">lambda.min.ratio<a class="anchor" aria-label="anchor" href="#arg-lambda-min-ratio"></a></dt>
<dd><p>Smallest value for lambda, as a fraction of lambda.max. Default depends on sample size relative to features.</p></dd>


<dt id="arg-lambda-early-stop">lambda.early.stop<a class="anchor" aria-label="anchor" href="#arg-lambda-early-stop"></a></dt>
<dd><p>Logical. Whether to stop early if the deviance changes minimally.</p></dd>


<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>Convergence threshold for coordinate descent.</p></dd>


<dt id="arg-mstop">Mstop<a class="anchor" aria-label="anchor" href="#arg-mstop"></a></dt>
<dd><p>Maximum number of iterations per lambda step.</p></dd>


<dt id="arg-max-total-iter">max.total.iter<a class="anchor" aria-label="anchor" href="#arg-max-total-iter"></a></dt>
<dd><p>Maximum total iterations across all lambda values.</p></dd>


<dt id="arg-group">group<a class="anchor" aria-label="anchor" href="#arg-group"></a></dt>
<dd><p>Vector describing the grouping of the coefficients. Default is <code>1:ncol(z)</code> (no grouping).</p></dd>


<dt id="arg-group-multiplier">group.multiplier<a class="anchor" aria-label="anchor" href="#arg-group-multiplier"></a></dt>
<dd><p>Vector of multipliers for each group size.</p></dd>


<dt id="arg-standardize">standardize<a class="anchor" aria-label="anchor" href="#arg-standardize"></a></dt>
<dd><p>Logical. Should the predictors be standardized before fitting? Default is TRUE.</p></dd>


<dt id="arg-nvar-max">nvar.max<a class="anchor" aria-label="anchor" href="#arg-nvar-max"></a></dt>
<dd><p>Maximum number of variables allowed in the model.</p></dd>


<dt id="arg-group-max">group.max<a class="anchor" aria-label="anchor" href="#arg-group-max"></a></dt>
<dd><p>Maximum number of groups allowed in the model.</p></dd>


<dt id="arg-stop-loss-ratio">stop.loss.ratio<a class="anchor" aria-label="anchor" href="#arg-stop-loss-ratio"></a></dt>
<dd><p>Ratio of loss change to stop the path early.</p></dd>


<dt id="arg-actset">actSet<a class="anchor" aria-label="anchor" href="#arg-actset"></a></dt>
<dd><p>Logical. Whether to use active set convergence strategy.</p></dd>


<dt id="arg-actiter">actIter<a class="anchor" aria-label="anchor" href="#arg-actiter"></a></dt>
<dd><p>Number of iterations for active set.</p></dd>


<dt id="arg-actgroupnum">actGroupNum<a class="anchor" aria-label="anchor" href="#arg-actgroupnum"></a></dt>
<dd><p>Number of active groups.</p></dd>


<dt id="arg-actsetremove">actSetRemove<a class="anchor" aria-label="anchor" href="#arg-actsetremove"></a></dt>
<dd><p>Logical. Whether to remove inactive groups from the active set.</p></dd>


<dt id="arg-returnx">returnX<a class="anchor" aria-label="anchor" href="#arg-returnx"></a></dt>
<dd><p>Logical. If TRUE, returns the standardized design matrix and other data details.</p></dd>


<dt id="arg-trace-lambda">trace.lambda<a class="anchor" aria-label="anchor" href="#arg-trace-lambda"></a></dt>
<dd><p>Logical. If TRUE, prints the current lambda during fitting.</p></dd>


<dt id="arg-message">message<a class="anchor" aria-label="anchor" href="#arg-message"></a></dt>
<dd><p>Logical. If TRUE, prints warnings and progress messages.</p></dd>


<dt id="arg-data-sorted">data_sorted<a class="anchor" aria-label="anchor" href="#arg-data-sorted"></a></dt>
<dd><p>Logical. Internal flag indicating if data is already sorted by time/stratum.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>"cox_MDTL_enet"</code> containing:</p><ul><li><p><code>beta</code>: Matrix of estimated coefficients (p x nlambda).</p></li>
<li><p><code>lambda</code>: The sequence of lambda values used.</p></li>
<li><p><code>likelihood</code>: Vector of negative partial log-likelihood values.</p></li>
<li><p><code>df</code>: Degrees of freedom for each lambda.</p></li>
<li><p><code>W</code>: Matrix of exponential linear predictors.</p></li>
<li><p><code>iter</code>: Number of iterations for each lambda.</p></li>
<li><p><code>data</code>: List of input data.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ExampleData_highdim</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">train_dat_highdim</span> <span class="op">&lt;-</span> <span class="va">ExampleData_highdim</span><span class="op">$</span><span class="va">train</span></span></span>
<span class="r-in"><span><span class="va">beta_external_highdim</span> <span class="op">&lt;-</span> <span class="va">ExampleData_highdim</span><span class="op">$</span><span class="va">beta_external</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cox_MDTL_enet_est</span> <span class="op">&lt;-</span> <span class="fu">cox_MDTL_enet</span><span class="op">(</span></span></span>
<span class="r-in"><span>  z <span class="op">=</span> <span class="va">train_dat_highdim</span><span class="op">$</span><span class="va">z</span>,</span></span>
<span class="r-in"><span>  delta <span class="op">=</span> <span class="va">train_dat_highdim</span><span class="op">$</span><span class="va">status</span>,</span></span>
<span class="r-in"><span>  time <span class="op">=</span> <span class="va">train_dat_highdim</span><span class="op">$</span><span class="va">time</span>,</span></span>
<span class="r-in"><span>  stratum <span class="op">=</span> <span class="va">train_dat_highdim</span><span class="op">$</span><span class="va">stratum</span>,</span></span>
<span class="r-in"><span>  beta <span class="op">=</span> <span class="va">beta_external_highdim</span>,</span></span>
<span class="r-in"><span>  vcov <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>  eta <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>  alpha <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Yubo Shao.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

