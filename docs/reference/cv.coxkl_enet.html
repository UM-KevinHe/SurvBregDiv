<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Cross-Validation for CoxKL Model with Elastic Net &amp; Lasso Penalty — cv.coxkl_enet • SurvBregDiv</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Cross-Validation for CoxKL Model with Elastic Net &amp; Lasso Penalty — cv.coxkl_enet"><meta name="description" content="Performs k-fold cross-validation to tune the hyperparameters for the high-dimensional
Cox proportional hazards model with Kullback–Leibler (KL) divergence penalty.
This function primarily tunes the external information weight eta.
For each candidate eta, it internally validates the optimal regularization
parameter lambda."><meta property="og:description" content="Performs k-fold cross-validation to tune the hyperparameters for the high-dimensional
Cox proportional hazards model with Kullback–Leibler (KL) divergence penalty.
This function primarily tunes the external information weight eta.
For each candidate eta, it internally validates the optimal regularization
parameter lambda."><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-54921687-5"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-54921687-5');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="inverse" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SurvBregDiv</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/SurvBregDiv.html">Get started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-appendix" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Appendix</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-appendix"><li><a class="dropdown-item" href="../articles/CV_Criteria.html">CV Criteria</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/UM-KevinHe/SurvBregDiv" aria-label="GitHub repository"><span class="fa fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Cross-Validation for CoxKL Model with Elastic Net &amp; Lasso Penalty</h1>

      <div class="d-none name"><code>cv.coxkl_enet.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Performs k-fold cross-validation to tune the hyperparameters for the high-dimensional
Cox proportional hazards model with Kullback–Leibler (KL) divergence penalty.</p>
<p>This function primarily tunes the external information weight <code>eta</code>.
For each candidate <code>eta</code>, it internally validates the optimal regularization
parameter <code>lambda</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cv.coxkl_enet</span><span class="op">(</span></span>
<span>  <span class="va">z</span>,</span>
<span>  <span class="va">delta</span>,</span>
<span>  <span class="va">time</span>,</span>
<span>  stratum <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  RS <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  beta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">etas</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  lambda <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nlambda <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  lambda.min.ratio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">n</span> <span class="op">&lt;</span> <span class="va">p</span>, <span class="fl">0.05</span>, <span class="fl">0.001</span><span class="op">)</span>,</span>
<span>  nfolds <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  cv.criteria <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"V&amp;VH"</span>, <span class="st">"LinPred"</span>, <span class="st">"CIndex_pooled"</span>, <span class="st">"CIndex_foldaverage"</span><span class="op">)</span>,</span>
<span>  c_index_stratum <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  message <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-z">z<a class="anchor" aria-label="anchor" href="#arg-z"></a></dt>
<dd><p>Numeric matrix of covariates. Rows represent individuals and columns represent predictors.</p></dd>


<dt id="arg-delta">delta<a class="anchor" aria-label="anchor" href="#arg-delta"></a></dt>
<dd><p>Numeric vector of event indicators (1 = event, 0 = censored).</p></dd>


<dt id="arg-time">time<a class="anchor" aria-label="anchor" href="#arg-time"></a></dt>
<dd><p>Numeric vector of observed times (event or censoring).</p></dd>


<dt id="arg-stratum">stratum<a class="anchor" aria-label="anchor" href="#arg-stratum"></a></dt>
<dd><p>Optional numeric or factor vector indicating strata. If <code>NULL</code>,
all subjects are assumed to be in the same stratum.</p></dd>


<dt id="arg-rs">RS<a class="anchor" aria-label="anchor" href="#arg-rs"></a></dt>
<dd><p>Optional numeric vector or matrix of external risk scores. If not provided,
<code>beta</code> must be supplied.</p></dd>


<dt id="arg-beta">beta<a class="anchor" aria-label="anchor" href="#arg-beta"></a></dt>
<dd><p>Optional numeric vector of external coefficients (length equal to <code>ncol(z)</code>).
If provided, it is used to compute external risk scores. If not provided, <code>RS</code> must be supplied.</p></dd>


<dt id="arg-etas">etas<a class="anchor" aria-label="anchor" href="#arg-etas"></a></dt>
<dd><p>Numeric vector of candidate <code>eta</code> values to be evaluated.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Elastic-net mixing parameter in \((0,1]\). Default is <code>1</code> (lasso penalty).</p></dd>


<dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>Optional numeric vector of lambda values. If <code>NULL</code>, a path is generated automatically.</p></dd>


<dt id="arg-nlambda">nlambda<a class="anchor" aria-label="anchor" href="#arg-nlambda"></a></dt>
<dd><p>Integer. Number of lambda values to generate if <code>lambda</code> is NULL. Default is 100.</p></dd>


<dt id="arg-lambda-min-ratio">lambda.min.ratio<a class="anchor" aria-label="anchor" href="#arg-lambda-min-ratio"></a></dt>
<dd><p>Numeric. Ratio of min/max lambda.
Default depends on sample size vs dimension (0.05 if n &lt; p, else 1e-03).</p></dd>


<dt id="arg-nfolds">nfolds<a class="anchor" aria-label="anchor" href="#arg-nfolds"></a></dt>
<dd><p>Integer. Number of cross-validation folds. Default is <code>5</code>.</p></dd>


<dt id="arg-cv-criteria">cv.criteria<a class="anchor" aria-label="anchor" href="#arg-cv-criteria"></a></dt>
<dd><p>Character string specifying the cross-validation criterion for selecting
both <code>eta</code> and <code>lambda</code>. Choices are:</p><ul><li><p><code>"V&amp;VH"</code> (default): V&amp;VH loss.</p></li>
<li><p><code>"LinPred"</code>: Loss based on cross-validated linear predictors.</p></li>
<li><p><code>"CIndex_pooled"</code>: Pooled C-Index.</p></li>
<li><p><code>"CIndex_foldaverage"</code>: Average C-Index across folds.</p></li>
</ul></dd>


<dt id="arg-c-index-stratum">c_index_stratum<a class="anchor" aria-label="anchor" href="#arg-c-index-stratum"></a></dt>
<dd><p>Optional stratum vector. Required only when <code>cv.criteria</code> is set
to <code>"CIndex_pooled"</code> or <code>"CIndex_foldaverage"</code>, and a stratified C-index needs
to be computed while the fitted model is non-stratified. Default is <code>NULL</code>.</p></dd>


<dt id="arg-message">message<a class="anchor" aria-label="anchor" href="#arg-message"></a></dt>
<dd><p>Logical. Whether to print progress messages. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>Optional integer. Random seed for reproducible fold assignment.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to the underlying fitting function <code><a href="coxkl_enet.html">coxkl_enet</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>"cv.coxkl_enet"</code>. A list containing:</p><dl><dt><code>best</code></dt>
<dd><p>A list with the optimal parameters:</p><ul><li><p><code>best_eta</code>: The selected eta value.</p></li>
<li><p><code>best_lambda</code>: The selected lambda value.</p></li>
<li><p><code>best_beta</code>: The coefficient vector corresponding to the best eta and lambda.</p></li>
<li><p><code>criteria</code>: The criterion used for selection.</p></li>
</ul></dd>

<dt><code>integrated_stat.full_results</code></dt>
<dd><p>A <code>data.frame</code> containing the performance metric
for every combination of <code>eta</code> and <code>lambda</code>.</p></dd>

<dt><code>integrated_stat.best_per_eta</code></dt>
<dd><p>A <code>data.frame</code> containing the best lambda and
corresponding score for each candidate <code>eta</code>.</p></dd>

<dt><code>integrated_stat.betahat_best</code></dt>
<dd><p>A matrix of coefficients where each column corresponds
to the optimal model for a specific <code>eta</code>.</p></dd>

<dt><code>criteria</code></dt>
<dd><p>The selection criterion used.</p></dd>

<dt><code>alpha</code></dt>
<dd><p>The elastic net mixing parameter used.</p></dd>

<dt><code>nfolds</code></dt>
<dd><p>The number of folds used.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function iterates through the provided <code>etas</code>. For each <code>eta</code>,
it performs cross-validation (based on <code>nfolds</code>) to select the optimal <code>lambda</code>
and computes the corresponding cross-validation score.</p>
<p>The available criteria for selection are:</p><ul><li><p><code>"V&amp;VH"</code>: The Verweij &amp; Van Houwelingen partial likelihood loss (default).</p></li>
<li><p><code>"LinPred"</code>: Loss based on the prognostic performance of the linear predictor.</p></li>
<li><p><code>"CIndex_pooled"</code>: Harrell's C-index computed by pooling linear predictors across folds.</p></li>
<li><p><code>"CIndex_foldaverage"</code>: Harrell's C-index computed within each fold and averaged.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ExampleData_highdim</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">train_dat_highdim</span> <span class="op">&lt;-</span> <span class="va">ExampleData_highdim</span><span class="op">$</span><span class="va">train</span></span></span>
<span class="r-in"><span><span class="va">beta_external_highdim</span> <span class="op">&lt;-</span> <span class="va">ExampleData_highdim</span><span class="op">$</span><span class="va">beta_external</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">eta_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="generate_eta.html">generate_eta</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"exponential"</span>, n <span class="op">=</span> <span class="fl">50</span>, max_eta <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cv.coxkl_enet_est</span> <span class="op">&lt;-</span> <span class="fu">cv.coxkl_enet</span><span class="op">(</span></span></span>
<span class="r-in"><span>   z <span class="op">=</span> <span class="va">train_dat_highdim</span><span class="op">$</span><span class="va">z</span>,</span></span>
<span class="r-in"><span>   delta <span class="op">=</span> <span class="va">train_dat_highdim</span><span class="op">$</span><span class="va">status</span>,</span></span>
<span class="r-in"><span>   time <span class="op">=</span> <span class="va">train_dat_highdim</span><span class="op">$</span><span class="va">time</span>,</span></span>
<span class="r-in"><span>   stratum <span class="op">=</span> <span class="va">train_dat_highdim</span><span class="op">$</span><span class="va">stratum</span>,</span></span>
<span class="r-in"><span>   beta <span class="op">=</span> <span class="va">beta_external_highdim</span>,</span></span>
<span class="r-in"><span>   etas <span class="op">=</span> <span class="va">eta_list</span>,</span></span>
<span class="r-in"><span>   alpha <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>   cv.criteria <span class="op">=</span> <span class="st">"CIndex_pooled"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Yubo Shao.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

