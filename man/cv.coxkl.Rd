% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cv.coxkl.R
\name{cv.coxkl}
\alias{cv.coxkl}
\title{Cross-Validated Cox–KL to Tune the Integration Parameter (eta)}
\usage{
cv.coxkl(
  z,
  delta,
  time,
  stratum = NULL,
  RS = NULL,
  beta = NULL,
  etas = NULL,
  tol = 1e-04,
  Mstop = 100,
  backtrack = FALSE,
  nfolds = 5,
  criteria = c("V&VH", "LinPred", "CIndex_pooled", "CIndex_foldaverage"),
  c_index_stratum = NULL,
  message = FALSE,
  seed = NULL,
  ...
)
}
\arguments{
\item{z}{Numeric matrix of covariates (rows = observations, columns = variables).}

\item{delta}{Numeric vector of event indicators (1 = event, 0 = censored).}

\item{time}{Numeric vector of observed event or censoring times.}

\item{stratum}{Optional numeric or factor vector defining strata.}

\item{RS}{Optional numeric vector or matrix of external risk scores. If omitted,
\code{beta} must be supplied.}

\item{beta}{Optional numeric vector of external coefficients. If omitted, \code{RS}
must be supplied.}

\item{etas}{Numeric vector of candidate tuning values to be cross-validated.
Default is \code{NULL}, which sets \code{etas = 0}.}

\item{tol}{Convergence tolerance for the optimizer used inside \code{coxkl}. Default \code{1e-4}.}

\item{Mstop}{Maximum number of Newton iterations used inside \code{coxkl}. Default \code{100}.}

\item{backtrack}{Logical; if \code{TRUE}, backtracking line search is applied during
optimization. Default is \code{FALSE}.}

\item{nfolds}{Number of cross-validation folds. Default \code{5}.}

\item{criteria}{Character string specifying the performance criterion.
Choices are \code{"V&VH"}, \code{"LinPred"}, \code{"CIndex_pooled"}, or \code{"CIndex_foldaverage"}.
Default \code{"V&VH"}.}

\item{c_index_stratum}{Optional stratum vector. Only required when
\code{criteria} is set to \code{"CIndex_pooled"} or \code{"CIndex_foldaverage"},
and a stratified C-index is desired while the fitted model is non-stratified.
Default \code{NULL}.}

\item{message}{Logical; if \code{TRUE}, prints progress messages. Default \code{FALSE}.}

\item{seed}{Optional integer seed for reproducible fold assignment. Default \code{NULL}.}

\item{...}{Additional arguments passed to \code{\link{coxkl}}.}
}
\value{
A \code{data.frame} with one row per candidate \code{eta} and columns:
\describe{
\item{\code{eta}}{The candidate \code{eta} values.}
\item{\code{VVH_Loss}}{If \code{criteria = "V&VH"}, the cross-validated V&VH loss.}
\item{\code{LinPred_Loss}}{If \code{criteria = "LinPred"}, the loss based on linear predictors.}
\item{\code{CIndex_pooled}}{If \code{criteria = "CIndex_pooled"}, the pooled cross-validated C-index.}
\item{\code{CIndex_foldaverage}}{If \code{criteria = "CIndex_foldaverage"}, the average fold-wise C-index.}
}
}
\description{
Performs K-fold cross-validation to select the integration parameter \code{eta}
for the Cox–KL model. Each fold fits the model on a training split and
evaluates on the held-out split using the specified performance criterion.
}
\examples{
\dontrun{
data(ExampleData_lowdim)
train_dat_lowdim <- ExampleData_lowdim$train
beta_external_lowdim <- ExampleData_lowdim$beta_external_fair
etas <- generate_eta(method = "exponential", n = 50, max_eta = 10)
cv.result <- cv.coxkl(
  z = train_dat_lowdim$z,
  delta = train_dat_lowdim$status,
  time = train_dat_lowdim$time,
  stratum = train_dat_lowdim$stratum,
  beta = beta_external_lowdim,
  etas = etas,
  nfolds = 5,
  criteria = "CIndex_pooled")
}
}
