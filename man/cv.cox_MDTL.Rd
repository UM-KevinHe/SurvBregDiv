% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cv.cox_MDTL.R
\name{cv.cox_MDTL}
\alias{cv.cox_MDTL}
\title{Cross-Validation for Cox MDTL Model}
\usage{
cv.cox_MDTL(
  z,
  delta,
  time,
  stratum = NULL,
  beta,
  vcov = NULL,
  etas = NULL,
  tol = 1e-04,
  Mstop = 100,
  nfolds = 5,
  criteria = c("V&VH", "LinPred", "CIndex_pooled", "CIndex_foldaverage"),
  c_index_stratum = NULL,
  message = FALSE,
  seed = NULL,
  ...
)
}
\arguments{
\item{z}{A numeric matrix or data frame of covariates (n x p).}

\item{delta}{A numeric vector of event indicators (1 = event, 0 = censored).}

\item{time}{A numeric vector of observed times.}

\item{stratum}{Optional numeric or factor vector indicating strata. If \code{NULL},
all subjects are assumed to be in the same stratum.}

\item{beta}{A numeric vector of external coefficients (length p).}

\item{vcov}{Optional numeric matrix (p x p) representing the weighting matrix \eqn{Q}
for the Mahalanobis penalty. Typically the inverse covariance matrix. If \code{NULL},
defaults to the identity matrix.}

\item{etas}{A numeric vector of candidate \code{eta} values to be evaluated.}

\item{tol}{Convergence tolerance for the optimization algorithm. Default is 1e-4.}

\item{Mstop}{Maximum number of iterations for the optimization. Default is 100.}

\item{nfolds}{Integer. Number of cross-validation folds. Default is 5.}

\item{criteria}{Character string specifying the cross-validation criterion. Choices are:
\itemize{
\item \code{"V&VH"} (default): Verweij & Van Houwelingen partial likelihood loss.
\item \code{"LinPred"}: Loss based on the prognostic performance of the linear predictor.
\item \code{"CIndex_pooled"}: Harrell's C-index computed by pooling predictions across folds.
\item \code{"CIndex_foldaverage"}: Harrell's C-index computed within each fold and averaged.
}}

\item{c_index_stratum}{Optional stratum vector. Required only when \code{criteria} involves
stratified C-index calculation but the model itself is unstratified.}

\item{message}{Logical. If \code{TRUE}, progress messages are printed.}

\item{seed}{Optional integer. Random seed for reproducible fold assignment.}

\item{...}{Additional arguments passed to the underlying fitting function \code{\link{cox_MDTL}}.}
}
\value{
An object of class \code{"cv.Cox_MDTL"} containing:
\describe{
\item{\code{internal_stat}}{A \code{data.frame} summarizing the performance metric (loss or C-index)
for each candidate \code{eta}.}
\item{\code{best}}{A list containing the optimal results:
\itemize{
\item \code{best_eta}: The selected eta value.
\item \code{best_beta}: The coefficient vector corresponding to the optimal eta (refitted on full data).
\item \code{criteria}: The criterion used for selection.
}
}
\item{\code{criteria}}{The selection criterion used.}
\item{\code{nfolds}}{The number of folds used.}
}
}
\description{
Performs k-fold cross-validation to tune the hyperparameter \code{eta} for the
Cox Proportional Hazards Model with Mahalanobis Distance Transfer Learning.

The function evaluates the model performance across a range of \code{eta} values
using specified criteria (e.g., Verweij & Van Houwelingen loss, C-index) to select
the optimal weight for the external information.
}
\examples{
\dontrun{
data(ExampleData_lowdim)
train_dat_lowdim <- ExampleData_lowdim$train
beta_external_lowdim <- ExampleData_lowdim$beta_external_fair

eta_list <- generate_eta(method = "exponential", n = 50, max_eta = 10)

cv.cox_MDTL_est <- cv.cox_MDTL(
  z = train_dat_lowdim$z,
  delta = train_dat_lowdim$status,
  time = train_dat_lowdim$time,
  beta = beta_external_lowdim,
  vcov = NULL,
  etas = eta_list,
  criteria = "V&VH"
)
}

}
