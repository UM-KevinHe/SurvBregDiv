% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cox_indi.R
\name{cox_indi}
\alias{cox_indi}
\title{Cox Proportional Hazards Model Integrated with External Individual-level Information}
\usage{
cox_indi(
  z_int,
  delta_int,
  time_int,
  stratum_int = NULL,
  z_ext,
  delta_ext,
  time_ext,
  stratum_ext = NULL,
  etas,
  max_iter = 100,
  tol = 1e-07,
  message = FALSE
)
}
\arguments{
\item{z_int}{Matrix of covariates for the internal dataset (n_int x p).}

\item{delta_int}{Event indicators for the internal dataset (0/1).}

\item{time_int}{Survival times for the internal dataset.}

\item{stratum_int}{Optional stratum identifiers for the internal dataset (default \code{NULL} -> single stratum).}

\item{z_ext}{Matrix of covariates for the external dataset (n_ext x p).}

\item{delta_ext}{Event indicators for the external dataset (0/1).}

\item{time_ext}{Survival times for the external dataset.}

\item{stratum_ext}{Optional stratum identifiers for the external dataset (default \code{NULL} -> single stratum).}

\item{etas}{Numeric vector of nonnegative external weights. \code{eta = 0} gives internal-only fit.}

\item{max_iter}{Maximum Newton-Raphson iterations (default 100).}

\item{tol}{Convergence tolerance (default 1e-7).}

\item{message}{Logical; if \code{TRUE}, show a progress bar. Default \code{FALSE}.}
}
\value{
An object of class \code{"cox_indi"} containing:
\describe{
\item{\code{eta}}{Sorted sequence of \eqn{\eta} values used.}
\item{\code{beta}}{Matrix of estimated coefficients (\eqn{p \times n_{etas}}). Columns correspond to \code{etas}.}
\item{\code{linear.predictors_int}}{Matrix of internal linear predictors for each \code{eta} (\eqn{n_{int} \times n_{etas}}).}
\item{\code{linear.predictors_ext}}{Matrix of external linear predictors for each \code{eta} (\eqn{n_{ext} \times n_{etas}}).}
\item{\code{data}}{List of inputs used.}
}
}
\description{
Fits a series of composite-likelihood (weighted) stratified Cox models that integrate
an external individual-level dataset via an external likelihood weight \code{eta}.
}
\details{
The fitted objective is
\deqn{\ell_\eta(\beta) = \ell_{\text{int}}(\beta) + \eta \, \ell_{\text{ext}}(\beta),}
which is equivalent to fitting a stratified Cox model on the stacked data with
observation weights 1 (internal) and \code{eta} (external), while keeping internal
and external strata separated (no mixing of risk sets across cohorts).

The function fits one model per \code{eta} value. It uses a warm-start strategy:
the solution at the current \code{eta} is used as the initial value for the next \code{eta}
in the sorted sequence.
}
\examples{
\dontrun{
## Load example individual-level data
data(ExampleData_indi)

z_int       <- ExampleData_indi$internal$z
delta_int   <- ExampleData_indi$internal$status
time_int    <- ExampleData_indi$internal$time
stratum_int <- ExampleData_indi$internal$stratum

z_ext       <- ExampleData_indi$external$z
delta_ext   <- ExampleData_indi$external$status
time_ext    <- ExampleData_indi$external$time
stratum_ext <- ExampleData_indi$external$stratum

## Generate a sequence of eta values
eta_list <- generate_eta(method = "exponential", n = 50, max_eta = 100)

## Fit the composite-likelihood Cox model path
fit_path <- cox_indi(
  z_int = z_int,
  delta_int = delta_int,
  time_int = time_int,
  stratum_int = stratum_int,
  z_ext = z_ext,
  delta_ext = delta_ext,
  time_ext = time_ext,
  stratum_ext = stratum_ext,
  etas = eta_list
)

## Estimated coefficients along the eta path
fit_path$beta
}

}
