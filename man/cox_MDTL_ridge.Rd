% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cox_MDTL_ridge.R
\name{cox_MDTL_ridge}
\alias{cox_MDTL_ridge}
\title{Cox MDTL with Ridge Regularization}
\usage{
cox_MDTL_ridge(
  z,
  delta,
  time,
  stratum = NULL,
  beta = NULL,
  vcov = NULL,
  eta = NULL,
  lambda = NULL,
  nlambda = 100,
  penalty.factor = 0.999,
  tol = 1e-04,
  Mstop = 50,
  backtrack = FALSE,
  message = FALSE,
  data_sorted = FALSE,
  beta_initial = NULL,
  ...
)
}
\arguments{
\item{z}{A numeric matrix or data frame of covariates (n x p).}

\item{delta}{A numeric vector of event indicators (1 = event, 0 = censored).}

\item{time}{A numeric vector of observed times.}

\item{stratum}{Optional numeric or factor vector indicating strata. If \code{NULL},
all subjects are assumed to be in the same stratum.}

\item{beta}{A numeric vector of external coefficients (length p).}

\item{vcov}{Optional numeric matrix (p x p) representing the weighting matrix \eqn{Q}
for the Mahalanobis penalty. Typically the inverse covariance matrix. If \code{NULL},
defaults to the identity matrix.}

\item{eta}{A single non-negative numeric value controlling the weight of the
external information (Mahalanobis distance penalty). If \code{NULL}, defaults to 0 (no transfer learning).}

\item{lambda}{Optional numeric vector of regularization parameters. If \code{NULL},
a sequence is generated automatically.}

\item{nlambda}{Integer. The number of lambda values to generate if \code{lambda} is \code{NULL}.
Default is 100.}

\item{penalty.factor}{Numeric value used to determine the elastic net mixing parameter \code{alpha}.
The function sets \code{alpha = 1 - penalty.factor}.
A value close to 1 (default 0.999) results in \code{alpha} close to 0, enforcing a Ridge-like penalty.}

\item{tol}{Convergence tolerance for the optimization algorithm. Default is 1e-4.}

\item{Mstop}{Maximum number of iterations. Default is 50.}

\item{backtrack}{Logical. If \code{TRUE}, uses backtracking line search. Default is \code{FALSE}.}

\item{message}{Logical. If \code{TRUE}, progress messages are printed.}

\item{data_sorted}{Logical. If \code{TRUE}, assumes input data is already sorted by stratum and time.}

\item{beta_initial}{Optional initial coefficient vector for warm start.}

\item{...}{Additional arguments passed to internal functions.}
}
\value{
An object of class \code{"cox_MDTL_ridge"} containing:
\describe{
\item{\code{lambda}}{The sequence of lambda values used.}
\item{\code{beta}}{A matrix of estimated coefficients (p x nlambda).}
\item{\code{linear.predictors}}{A matrix of linear predictors (n x nlambda).}
\item{\code{likelihood}}{A vector of log-partial likelihoods for each lambda.}
\item{\code{data}}{A list containing the input data (z, time, delta, stratum).}
}
}
\description{
Fits a Cox Proportional Hazards model that simultaneously incorporates:
\enumerate{
\item \strong{Transfer Learning}: A Mahalanobis distance penalty that shrinks coefficients towards
external reference coefficients (\code{beta}), controlled by the parameter \code{eta}.
\item \strong{Ridge Regularization}: An L2-norm penalty on the coefficients to handle high-dimensional
data or multicollinearity, controlled by the sequence of \code{lambda} values.
}

The function computes the solution path over a sequence of \code{lambda} values for a fixed \code{eta}.
}
\examples{
\dontrun{
data(ExampleData_highdim)
train_dat_highdim <- ExampleData_highdim$train
beta_external_highdim <- ExampleData_highdim$beta_external

cox_MDTL_ridge_est <- cox_MDTL_ridge(
  z = train_dat_highdim$z,
  delta = train_dat_highdim$status,
  time = train_dat_highdim$time,
  stratum = train_dat_highdim$stratum,
  beta = beta_external_highdim,
  vcov = NULL,
  eta = 0.5
)
}

}
