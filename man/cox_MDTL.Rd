% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cox_MDTL.R
\name{cox_MDTL}
\alias{cox_MDTL}
\title{Cox Proportional Hazards Model with Mahalanobis Distance Transfer Learning}
\usage{
cox_MDTL(
  z,
  delta,
  time,
  stratum = NULL,
  beta,
  vcov = NULL,
  etas,
  tol = 1e-04,
  Mstop = 50,
  backtrack = FALSE,
  message = FALSE,
  data_sorted = FALSE,
  beta_initial = NULL
)
}
\arguments{
\item{z}{A numeric matrix or data frame of covariates (n x p).}

\item{delta}{A numeric vector of event indicators (1 = event, 0 = censored).}

\item{time}{A numeric vector of observed times.}

\item{stratum}{Optional numeric or factor vector indicating strata. If \code{NULL},
all subjects are assumed to be in the same stratum.}

\item{beta}{A numeric vector of external coefficients (length p).}

\item{vcov}{Optional numeric matrix (p x p) acting as the weighting matrix \eqn{Q}
in the Mahalanobis penalty.
\strong{Note:} In standard Mahalanobis distance formulations, this should be the
\emph{inverse} of the covariance matrix (precision matrix). If not provided,
an identity matrix is used.}

\item{etas}{A numeric vector of tuning parameters (scalars) to evaluate.}

\item{tol}{Convergence tolerance for the Newton-Raphson algorithm. Default is 1e-4.}

\item{Mstop}{Maximum number of iterations for Newton-Raphson. Default is 50.}

\item{backtrack}{Logical. If \code{TRUE}, uses backtracking line search. Default is \code{FALSE}.}

\item{message}{Logical. If \code{TRUE}, progress messages are printed.}

\item{data_sorted}{Logical. If \code{TRUE}, assumes input data is already sorted by stratum and time.}

\item{beta_initial}{Optional initial coefficient vector for warm start.}
}
\value{
An object of class \code{"Cox_MDTL"} containing:
\describe{
\item{\code{eta}}{The vector of eta values evaluated.}
\item{\code{beta}}{A matrix of estimated coefficients (p x n_eta).}
\item{\code{linear.predictors}}{A matrix of linear predictors (n x n_eta).}
\item{\code{likelihood}}{A vector of log-partial likelihoods for each eta.}
\item{\code{data}}{A list containing the input data used.}
}
}
\description{
Fits a Cox proportional hazards model incorporating external information via a
Mahalanobis distance penalty. This approach penalizes the deviation of the
estimated coefficients from external reference coefficients (\code{beta}),
weighted by a specified matrix (typically the inverse covariance matrix).
}
\details{
The objective function minimizes the negative log-partial likelihood plus a penalty term:
\deqn{P(\beta) = \frac{\eta}{2} (\beta - \beta_{ext})^T Q (\beta - \beta_{ext})}
where:
\itemize{
\item \eqn{\beta_{ext}} is the vector of external coefficients.
\item \eqn{Q} is the weighting matrix (derived from \code{vcov}).
\item \eqn{\eta} is the tuning parameter controlling the strength of the external information.
}
If \code{vcov} is \code{NULL}, \eqn{Q} defaults to the identity matrix, reducing the
penalty to a standard Euclidean distance (Ridge-type shrinkage towards \code{beta}).
}
\examples{
\dontrun{
data(ExampleData_lowdim)
train_dat_lowdim <- ExampleData_lowdim$train
beta_external_lowdim <- ExampleData_lowdim$beta_external_fair

eta_list <- generate_eta(method = "exponential", n = 50, max_eta = 5)

cox_MDTL_est <- cox_MDTL(
  z = train_dat_lowdim$z,
  delta = train_dat_lowdim$status,
  time = train_dat_lowdim$time,
  beta = beta_external_lowdim,
  vcov = NULL,
  etas = eta_list
)
}

}
