% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/coxkl_ridge.R
\name{coxkl_ridge}
\alias{coxkl_ridge}
\title{Cox Proportional Hazards Model with Ridge Penalty and External Information}
\usage{
coxkl_ridge(
  z,
  delta,
  time,
  stratum = NULL,
  RS = NULL,
  beta = NULL,
  eta = NULL,
  lambda = NULL,
  nlambda = 100,
  penalty.factor = 0.999,
  tol = 1e-04,
  Mstop = 50,
  backtrack = FALSE,
  message = FALSE,
  data_sorted = FALSE,
  beta_initial = NULL,
  ...
)
}
\arguments{
\item{z}{Numeric matrix of covariates. Rows represent individuals and columns represent predictors.}

\item{delta}{Numeric vector of event indicators (1 = event, 0 = censored).}

\item{time}{Numeric vector of observed times (event or censoring).}

\item{stratum}{Optional numeric or factor vector specifying strata. If \code{NULL}, all observations are in the same stratum.}

\item{RS}{Optional numeric vector or matrix of external risk scores. If not provided, \code{beta} must be supplied.}

\item{beta}{Optional numeric vector of externally derived coefficients (length equal to \code{ncol(z)}).
If provided, used to calculate risk scores. If not provided, \code{RS} must be supplied.}

\item{eta}{Non-negative scalar controlling the strength of external information integration.
\code{eta = 0} implies a standard Ridge Cox model.}

\item{lambda}{Optional numeric scalar or vector of penalty parameters. If \code{NULL}, a sequence is generated automatically.}

\item{nlambda}{Integer. Number of lambda values to generate if \code{lambda} is \code{NULL}. Default is 100.}

\item{penalty.factor}{Numeric scalar in \code{[0, 1)}. Controls the internal mixing parameter used to generate
the lambda sequence when \code{lambda = NULL}. A value close to 1 generates a sequence suitable for Ridge-like behavior.}

\item{tol}{Convergence tolerance for the iterative estimation algorithm. Default is 1e-4.}

\item{Mstop}{Integer. Maximum number of iterations for estimation. Default is 50.}

\item{backtrack}{Logical. If \code{TRUE}, uses backtracking line search during optimization.}

\item{message}{Logical. If \code{TRUE}, progress messages are printed during model fitting.}

\item{data_sorted}{Logical. Internal optimization. If \code{TRUE}, assumes input data is already sorted by strata and time.}

\item{beta_initial}{Optional numeric vector. Initial values for the coefficients. Default is 0.}

\item{...}{Additional arguments.}
}
\value{
An object of class \code{"coxkl_ridge"} containing:
\describe{
\item{\code{lambda}}{The sequence of lambda values used for estimation.}
\item{\code{beta}}{A matrix of estimated coefficients (p x nlambda).}
\item{\code{linear.predictors}}{A matrix of linear predictors (n x nlambda), restored to the original data order.}
\item{\code{likelihood}}{A vector of negative log-partial likelihoods for each lambda.}
\item{\code{data}}{A list containing the input data used (\code{z}, \code{time}, \code{delta}, \code{stratum}).}
}
}
\description{
Fits a Cox proportional hazards model using a Ridge (L2) penalty on all covariates,
while integrating external information via Kullbackâ€“Leibler (KL) divergence.

This function is useful for high-dimensional data or situations with collinearity,
allowing the incorporation of prior knowledge (external coefficients or risk scores)
to improve estimation.
}
\details{
The objective function optimizes the partial likelihood penalized by two terms:
\enumerate{
\item The KL divergence between the current model's predictions and the external information (weighted by \code{eta}).
\item The Ridge (L2) norm of the coefficients (weighted by \code{lambda}).
}
Unlike Lasso, Ridge regression does not perform variable selection (coefficients are shrunk towards zero but not set to exactly zero),
making it suitable for retaining all features while controlling overfitting.
}
\examples{
\dontrun{
data(ExampleData_highdim)
train_dat_highdim <- ExampleData_highdim$train
beta_external_highdim <- ExampleData_highdim$beta_external

coxkl_ridge_est <- coxkl_ridge(
  z = train_dat_highdim$z,
  delta = train_dat_highdim$status,
  time = train_dat_highdim$time,
  stratum = train_dat_highdim$stratum,
  beta = beta_external_highdim,
  eta = 0
)
}

}
